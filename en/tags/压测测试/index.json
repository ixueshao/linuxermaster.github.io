[{"content":"èƒŒæ™¯ç ”ç©¶ åˆ†äº«ä¸€ä¸ªé€šè¿‡ nginx æ­å»ºä¸€ä¸ªé™æ€èµ„æºçš„ web æœåŠ¡å™¨ï¼Œå®è·µä¸­å°†ä¼šæ¶‰åŠåˆ°ä¸‰ä¸ªéƒ¨åˆ†çš„å†…å®¹ï¼š\n é™æ€æ–‡ä»¶æœåŠ¡å™¨çš„é…ç½® Nginxæ¨¡å—ä¹‹gzip è‡ªå®šä¹‰è®¿é—®æ—¥å¿—çš„æ ¼å¼: Embedded Variables  é™æ€æ–‡ä»¶æœåŠ¡å™¨ ç®€å•çš„å°±é€šè¿‡ä¸€ä¸ªè‡ªå®šä¹‰çš„index.htmlæ–‡ä»¶å½“åšä¸€ä¸ªé™æ€é¡µé¢Demoï¼Œä¸‹é¢å‡†å¤‡ä¸€ä¸‹é™æ€æ–‡ä»¶èµ„æºå­˜å‚¨çš„ä½ç½®ã€‚\n1 2  mkdir /webserver/nginx18/ops/ echo \u0026#34;äº‘åŸç”Ÿç”Ÿæ€åœˆ\u0026#34; \u0026gt; /webserver/nginx18/ops/index.html   å¢åŠ nginxé…ç½®æ–‡ä»¶ï¼Œåœ¨/webserver/nginx18/conf/nginx.confé‡Œå¢åŠ ä¸€ä¸ª server é…ç½®æ®µï¼Œç„¶åé€šè¿‡ alias æ˜ å°„åˆ°è™šæ‹Ÿç›®å½•ã€‚æ³¨æ„è®¿é—®æ—¶ location ä¸­çš„/å¯¹åº”çš„æ˜¯ ops åé¢çš„/\nserver { listen 80; server_name web.devopsman.cn; location / { alias ops/; } } æµ‹è¯•è®¿é—®:\nâ˜¸ï¸ k8sdevğŸ”¥ default ~ î‚° ğŸ³ ğŸ‘‰ curl web.devopsman.cn é™æ€ç½‘ç«™demo â˜¸ï¸ k8sdevğŸ”¥ default ~ î‚° ğŸ³ ğŸ‘‰ curl -I web.devopsman.cn HTTP/1.1 200 OK Server: nginx/1.18.0 Date: Sat, 11 Jul 2020 14:11:46 GMT Content-Type: text/html Content-Length: 17 Last-Modified: Sat, 11 Jul 2020 14:11:13 GMT Connection: keep-alive ETag: \u0026quot;5f09c881-11\u0026quot; Accept-Ranges: bytes å¼€å¯é™æ€ç½‘ç«™å‹ç¼© nginxå¯ä»¥é€šè¿‡ä¸€ç§æµè§ˆå™¨æ”¯æŒä¸”å‹ç¼©ä¸å—æ•°æ®æŸå¤±çš„gzipæ¨¡å—å°†æ ·å¼æ–‡ä»¶ã€æ–‡æœ¬æ–‡ä»¶ã€å›¾ç‰‡ç­‰å‹ç¼©ä¹‹ååœ¨ç”¨æˆ·çš„è¯·æ±‚ä¹‹é—´ä¼ è¾“ï¼Œä½†æ˜¯å¯¹äºjpgã€jpegã€pngè¿™ç±»æœ¬èº«å­˜åœ¨å‹ç¼©æ€§è´¨ä¸Šçš„å›¾ç‰‡æ¥è¯´ï¼Œå‹ç¼©æ•ˆæœä¸æ˜¯å¾ˆæ˜æ˜¾ï¼Œä¸»è¦ä½“ç°åœ¨æ–‡æœ¬æ–‡ä»¶çš„å‹ç¼©ä¸Šï¼Œå› æ­¤å¯¹äºæœåŠ¡çš„æä¾›è€…æ¥è¯´ï¼Œå‡å°‘äº†ä¸å°çš„æµé‡å¸¦å®½çš„ä½¿ç”¨ï¼ŒåŒæ—¶ä¹Ÿæé«˜è®¿é—®é€Ÿåº¦ã€‚\n1 2 3 4  gzip on; gzip_min_length 1; # è¡¨ç¤ºå°äº1kä¸å‹ç¼© gzip_comp_level 2; # è®¾ç½®å‹ç¼©çš„çº§åˆ« gzip_types text_plain application/x-javascript text/css application/xml text/javascript application/x-httpd-php image/jpeg image/gif image/png; # å¯ç”¨å‹ç¼©ç±»å‹çš„æ–‡ä»¶   gzip_comp_levelçš„å‹ç¼©æ¯”è®¾ç½®åŒºé—´ä¸º0-9,è®¾ç½®çš„å‹ç¼©æ¯”è¶Šé«˜ï¼Œæ–‡ä»¶è¶Šå°ï¼Œä½†æ˜¯å¯¹æœåŠ¡å™¨CPUçš„æ¶ˆè€—ä¹Ÿå°±è¶Šå¤šï¼Œä¸€èˆ¬å‡ºäºè¿™ç§é€‰æ‹©å‹ç¼©æ¯”ä¸º6ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  root@master:/webserver/nginx18/conf# curl -I http://web.devopsman.cn/test.html HTTP/1.1 200 OK Server: nginx/1.18.0 Date: Sun, 12 Jul 2020 13:45:22 GMT Content-Type: text/html Content-Length: 20480 Last-Modified: Sun, 12 Jul 2020 13:34:14 GMT Connection: keep-alive ETag: \u0026#34;5f0b1156-5000\u0026#34; Accept-Ranges: bytes root@master:/webserver/nginx18/conf# curl -H \u0026#34;Accept-Encoding: gzip\u0026#34; -I http://web.devopsman.cn/test.html HTTP/1.1 200 OK Server: nginx/1.18.0 Date: Sun, 12 Jul 2020 13:45:26 GMT Content-Type: text/html Last-Modified: Sun, 12 Jul 2020 13:34:14 GMT Connection: keep-alive ETag: W/\u0026#34;5f0b1156-5000\u0026#34; Content-Encoding: gzip   é€šè¿‡ä»¥ä¸Šæµ‹è¯•çš„æ–¹å¼ï¼Œæ—¢å¯ä»¥è®¿é—®gzip_typesä¸­è®¾å®šçš„ç±»å‹çš„èµ„æºçš„æ—¶å€™ï¼Œé™¤äº†å›¾ç‰‡ä¹‹å¤–ï¼Œåº”è¯¥èƒ½æˆåŠŸçš„æ‰¾åˆ°Content-Encoding: gzipã€‚\né…ç½®è®¿é—®æ—¥å¿—æ ¼å¼ nginx çš„æ—¥å¿—æ ¼å¼ï¼Œæ˜¯é€šè¿‡ nginx æ”¯æŒçš„ç¯å¢ƒå˜é‡å°†æ‰€éœ€è¦çš„æ—¥å¿—ä¿¡æ¯ç»™ç»„è£…åœ¨ä¸€èµ·ï¼Œåœ¨ nginx é‡Œï¼Œé™¤äº†å†…ç½®çš„ç¯å¢ƒå˜é‡ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬ç¬¬ä¸‰æ–¹æ¨¡å—çš„ç¯å¢ƒå˜é‡ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼Œnginx æ ¸å¿ƒæ¨¡å—çš„æ”¯æŒçš„ç¯å¢ƒå˜é‡å¯ä»¥åœ¨Embedded Variablesæ‰¾åˆ°ï¼Œç¬¬ä¸‰æ–¹æ”¯æŒå“ªäº›ç¯å¢ƒå˜é‡å¯ä»¥åœ¨å¯¹åº”çš„æ¨¡å—æ–‡æ¡£ä¸­æ‰¾åˆ°ï¼Œæ¯”å¦‚realipæ¨¡å—æ”¯æŒçš„ç¯å¢ƒå˜é‡Embedded Variablesï¼Œä¸‹é¢æ˜¯æ˜¯ä¸€ä¸ªå®šä¹‰çš„æ¡ˆä¾‹ï¼Œå®šä¹‰ä¸€ä¸ªmainç±»å‹çš„æ—¥å¿—æ ¼å¼ã€‚\nlog_format main '{' '\u0026quot;@timestamp\u0026quot;:\u0026quot;$time_iso8601\u0026quot;,' '\u0026quot;connection\u0026quot;:\u0026quot;$connection\u0026quot;,' '\u0026quot;connection_requests\u0026quot;:\u0026quot;$connection_requests\u0026quot;,' '\u0026quot;request\u0026quot;:\u0026quot;$request\u0026quot;,' '\u0026quot;request_time\u0026quot;:\u0026quot;$request_time\u0026quot;,' '\u0026quot;request_length\u0026quot;:\u0026quot;$request_length\u0026quot;,' '\u0026quot;request_uri\u0026quot;:\u0026quot;$request_uri\u0026quot;,' '\u0026quot;request_method\u0026quot;:\u0026quot;$request_method\u0026quot;,' '\u0026quot;server_name\u0026quot;:\u0026quot;$server_name\u0026quot;,' '\u0026quot;status\u0026quot;:\u0026quot;$status\u0026quot;,' '\u0026quot;remote_user\u0026quot;:\u0026quot;$remote_user\u0026quot;,' '\u0026quot;remote_addr\u0026quot;:\u0026quot;$remote_addr\u0026quot;,' '\u0026quot;time_local\u0026quot;:\u0026quot;$time_local\u0026quot;,' '\u0026quot;body_bytes_sent\u0026quot;:\u0026quot;$body_bytes_sent\u0026quot;,' '\u0026quot;bytes_sent\u0026quot;:\u0026quot;$bytes_sent\u0026quot;,' '\u0026quot;msec\u0026quot;:\u0026quot;$msec\u0026quot;,' '\u0026quot;upstream_status\u0026quot;:\u0026quot;$upstream_status\u0026quot;,' '\u0026quot;upstream_addr\u0026quot;:\u0026quot;$upstream_addr\u0026quot;,' '\u0026quot;upstream_response_time\u0026quot;:\u0026quot;$upstream_response_time\u0026quot;,' '\u0026quot;http_sessionKey\u0026quot;:\u0026quot;$http_sessionKey\u0026quot;,' '\u0026quot;cookie_sk\u0026quot;:\u0026quot;$cookie_sk\u0026quot;,' '\u0026quot;http_referer\u0026quot;:\u0026quot;$http_referer\u0026quot;,' '\u0026quot;http_user_agent\u0026quot;:\u0026quot;$http_user_agent\u0026quot;,' '\u0026quot;http_x_forwarded_for\u0026quot;:\u0026quot;$http_x_forwarded_for\u0026quot;' '}'; åœ¨å®šä¹‰å¥½æ—¥å¿—æ ¼å¼ä¹‹åï¼Œé€šè¿‡access_logæŒ‡ä»¤é…ç½®æ—¥å¿—çš„å­˜å‚¨è·¯å¾„ï¼Œåœ¨é…ç½®å®Œæ—¥å¿—ä¹‹åï¼Œreloadä¸€ä¸‹å°±å¯è‡ªåŠ¨åˆ›å»ºæ—¥å¿—æ–‡ä»¶ï¼Œä»¥ä¸Šçš„ç¯å¢ƒå˜é‡å«ä¹‰éƒ½å¯ä»¥åœ¨å®˜ç½‘ä¸Šæ‰¾åˆ°å‡†ç¡®çš„é‡Šä¹‰:\n1  access_log logs/web.devopsman.cn.access.log main;   æ­¤æ—¶ï¼Œå‘é€ä¸€ä¸ª http çš„è¯·æ±‚ï¼Œå°±ä¼šæŒ‰ç…§æ—¥å¿—çš„æ ¼å¼è®°å½•æ—¥å¿—å†™å…¥åˆ°æ—¥å¿—æ–‡ä»¶ä¸­:\n1 2  root@master:/webserver/nginx18/logs# tail -f web.devopsman.cn.access.log {\u0026#34;@timestamp\u0026#34;:\u0026#34;2020-07-11T10:26:55-04:00\u0026#34;,\u0026#34;connection\u0026#34;:\u0026#34;17\u0026#34;,\u0026#34;connection_requests\u0026#34;:\u0026#34;1\u0026#34;,\u0026#34;request\u0026#34;:\u0026#34;HEAD / HTTP/1.1\u0026#34;,\u0026#34;request_time\u0026#34;:\u0026#34;0.000\u0026#34;,\u0026#34;request_length\u0026#34;:\u0026#34;81\u0026#34;,\u0026#34;request_uri\u0026#34;:\u0026#34;/\u0026#34;,\u0026#34;request_method\u0026#34;:\u0026#34;HEAD\u0026#34;,\u0026#34;server_name\u0026#34;:\u0026#34;web.devopsman.cn\u0026#34;,\u0026#34;status\u0026#34;:\u0026#34;200\u0026#34;,\u0026#34;remote_user\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;remote_addr\u0026#34;:\u0026#34;192.168.99.1\u0026#34;,\u0026#34;time_local\u0026#34;:\u0026#34;11/Jul/2020:10:26:55 -0400\u0026#34;,\u0026#34;body_bytes_sent\u0026#34;:\u0026#34;0\u0026#34;,\u0026#34;bytes_sent\u0026#34;:\u0026#34;236\u0026#34;,\u0026#34;msec\u0026#34;:\u0026#34;1594477615.080\u0026#34;,\u0026#34;upstream_status\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;upstream_addr\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;upstream_response_time\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;http_sessionKey\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;cookie_sk\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;http_referer\u0026#34;:\u0026#34;-\u0026#34;,\u0026#34;http_user_agent\u0026#34;:\u0026#34;curl/7.64.1\u0026#34;,\u0026#34;http_x_forwarded_for\u0026#34;:\u0026#34;-\u0026#34;}   ","description":"é€šè¿‡è§„èŒƒä½¿ç”¨Gzipå‹ç¼©ã€æ—¥å¿—æ ¼å¼æ¥é…ç½®Nginxé™æ€æœåŠ¡å™¨","id":2,"section":"posts","tags":["Nginx","gzip","æ—¥å¿—è§„èŒƒ"],"title":"Nginxä¸“è¾‘-02 Nginxé™æ€æœåŠ¡å™¨è§„èŒƒåŒ–é…ç½®","uri":"https://linuxermaster.github.io/en/posts/20200712-nginx%E4%B8%93%E8%BE%91-02-nginx%E9%9D%99%E6%80%81%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A7%84%E8%8C%83%E5%8C%96%E9%85%8D%E7%BD%AE/"},{"content":"Nginx ç¼–è¯‘å®‰è£…çš„å‰æœŸå‡†å¤‡ Nginx çš„ç¼–è¯‘å®‰è£…ä¸€èˆ¬ç”¨äºéœ€è¦åŠ å…¥ä¸€äº›æ‰©å±•çš„ç¬¬ä¸‰æ–¹æ¨¡å—æˆ–è€…è‡ªç ”å‘çš„æ‰©å±•åŠŸèƒ½åŒ…ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘ä¹‹å‰éœ€è¦æå‰ä¸‹è½½å‡†å¤‡å¥½è¿™äº›æ‰©å±•çš„åŒ…æ–‡ä»¶ï¼Œæ¯”å¦‚æˆ‘ä»¬ç¼–è¯‘çš„æ—¶å€™å¢åŠ éœ€è¦ä½¿ç”¨jemallocä¼˜åŒ– nginx å†…å­˜ï¼Œä½¿ç”¨opensslå®ç° nginx çš„ https æ•°æ®åŠ å¯†ï¼Œä½¿ç”¨zlibåº“æ‰©å±• nginx å‹ç¼©çš„åŠŸèƒ½ç­‰ï¼Œä¸‹é¢æˆ‘ä»¬ä¸‹è½½ä¸€äº›æˆ‘ä»¬éœ€è¦çš„åŸºç¡€ä¾èµ–åº“çš„åŒ…æ–‡ä»¶:\n1 2 3 4 5 6 7 8 9 10 11 12 13  cd /usr/local/src wget http://nginx.org/download/nginx-1.14.2.tar.gz wget http://nginx.org/download/nginx-1.10.3.tar.gz wget https://www.zlib.net/fossils/zlib-1.2.8.tar.gz wget https://openssl.org/source/openssl-1.0.2d.tar.gz wget https://github.com/simplresty/ngx_devel_kit/archive/v0.3.0.tar.gz -O ngx_devel_kit.tar.gz wget https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2 wget https://github.com/yaoweibin/nginx_upstream_check_module/archive/v0.3.0.tar.gz -O nginx_upstream_check_module.tar.gz wget https://github.com/openresty/lua-nginx-module/archive/v0.10.10.tar.gz -O lua-nginx-module.tar.gz tar xf jemalloc-4.5.0.tar.bz2 cd jemalloc-4.5.0 \u0026amp;\u0026amp; ./configure \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install apt-get install -y lua5.1-0-dev sudo apt-get install libpcre3 libpcre3-dev # support pcre   jemallocçš„å®‰è£…ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨aptå®‰è£…\n1  apt-get install -y libjemalloc-dev   å¦‚æœåœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­å‡ºç°ä¸€äº›ä¸‹é¢ç±»ä¼¼çš„é”™è¯¯ï¼Œå¯ä»¥é€šè¿‡å®‰è£…å¼€å‘è€…å·¥å…·åŒ…è§£å†³è¿™ä¸ªé—®é¢˜:\n1 2 3 4 5 6 7  checking for xsltproc... false checking for gcc... no checking for cc... no checking for cl.exe... no # ubuntuä¸Šå®‰è£…å¼€å‘è€…å·¥å…·åŒ… sudo apt install build-essential -y   ç¼–è¯‘å®‰è£… Nginx1.18.0 é¦–å…ˆæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ª nginx çš„è¿è¡Œç”¨æˆ·www\n1 2 3  groupadd www \u0026amp;\u0026amp; useradd www -g www # å¼€å§‹ç¼–è¯‘nginx ./configure --prefix=/webserver/nginx18 --user=www --group=www --with-pcre --with-zlib=/root/workspace/packages/nginx/zlib-1.2.8 --with-openssl=/root/workspace/packages/nginx/openssl-1.0.2d --with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --add-module=/root/workspace/packages/nginx/ngx_devel_kit-0.3.0 --with-ld-opt=-ljemalloc --with-stream --with-http_ssl_module --add-module=/root/workspace/packages/nginx/nginx_upstream_check_module-0.3.0 \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install   ç¼–è¯‘å®Œæˆåï¼Œåœ¨å¯åŠ¨ nginx\n1 2 3 4 5 6 7 8 9 10  /webserver/nginx18/sbin/nginx # ç„¶åæˆ‘ä»¬å°†nginxçš„workè¿›ç¨‹è®¾ç½®ä¸º2ä¸ªï¼Œä¿®æ”¹ç”¨æˆ·ä¸ºwww root@master:/webserver/nginx18/sbin# ps -fe |grep nginx root 50131 1 0 08:43 ? 00:00:00 nginx: master process ./nginx www 58005 50131 0 08:54 ? 00:00:00 nginx: worker process www 58006 50131 0 08:54 ? 00:00:00 nginx: worker process root@master:/webserver/nginx18/sbin# cp nginx /usr/local/bin/nginx root@master:/webserver/nginx18/sbin# nginx -t root@master:/webserver/nginx18/sbin# nginx -s reload   ç„¶åæˆ‘ä»¬é…ç½®ä¸€ä¸ªweb.devopsman.cnçš„åŸŸååˆ°192.168.99.128ä¸Šï¼Œçœ‹ä¸€ä¸‹æœåŠ¡è¿è¡Œå’Œ DNS è§£æåçš„æ•ˆæœ:\n1 2 3 4 5 6 7 8 9 10  root@master:~/workspace/packages/nginx/nginx-1.18.0/contrib# curl -I web.devopsman.cn HTTP/1.1 200 OK Server: nginx/1.18.0 Date: Sat, 11 Jul 2020 13:03:29 GMT Content-Type: text/html Content-Length: 612 Last-Modified: Sat, 11 Jul 2020 12:38:29 GMT Connection: keep-alive ETag: \u0026#34;5f09b2c5-264\u0026#34; Accept-Ranges: bytes   é«˜äº® Nginx çš„é…ç½® nginx çš„æºç åŒ…é‡Œé¢æœ‰é…ç½® vim ç¼–è¾‘çš„ nginx é…ç½®æ–‡ä»¶æ—¶å†…å®¹æ ¼å¼é«˜äº®æ˜¾ç¤ºçš„é…ç½®æ–‡ä»¶ï¼Œç›´æ¥å°†å…¶æ‹·è´åˆ°.vimç›®å½•ä¸‹å³å¯\n1 2 3 4 5 6 7 8 9 10  root@master:~# cd /root/workspace/packages/nginx/nginx-1.18.0/contrib/ root@master:~/workspace/packages/nginx/nginx-1.18.0/contrib# ls -al total 24 drwxr-xr-x 4 www www 4096 Jul 11 08:02 . drwxr-xr-x 9 www www 4096 Jul 11 08:21 .. -rw-r--r-- 1 www www 1272 Apr 21 10:09 geo2nginx.pl -rw-r--r-- 1 www www 543 Apr 21 10:09 README drwxr-xr-x 2 www www 4096 Jul 11 08:02 unicode2nginx drwxr-xr-x 6 www www 4096 Apr 21 10:09 vim root@master:~/workspace/packages/nginx/nginx-1.18.0/contrib# cp -r vim/* ~/.vim/   æ‹·è´è¿›å»ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ç¼–è¾‘ nginx çš„é…ç½®æ–‡ä»¶å˜å¾—é«˜äº®äº†\n","description":"Nginxä¸“è¾‘01 Nginx1.18æºç è‡ªå®šä¹‰å®‰è£…","id":3,"section":"posts","tags":["Nginx","ç¼–è¯‘","web server"],"title":"Nginxä¸“è¾‘- 01 Nginx1.18ç¼–è¯‘å®‰è£…","uri":"https://linuxermaster.github.io/en/posts/20200711-nginx%E4%B8%93%E8%BE%91-01-nginx1.18%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/"},{"content":"Replication Adapters harbor æä¾›äº† harbor ä¸é harbor æœåŠ¡ä¹‹é—´çš„é•œåƒå¤åˆ¶åŠŸèƒ½ï¼Œé€šè¿‡å¤åˆ¶é•œåƒåŠŸèƒ½å¯ä»¥å°† DockerHub ä¸Šçš„ç§æœ‰é•œåƒç»™æ‰¹é‡çš„åŒæ­¥åˆ°æœ¬åœ°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡åœ¨å¤š Harbor å®ä¾‹ä¹‹é—´è¿›è¡ŒåŒæ­¥ï¼Œè¾¾åˆ°é•œåƒå¤šå‰¯æœ¬ï¼Œæ•°æ®é«˜å¯ç”¨çš„ä½œç”¨ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒHarbor æ”¯æŒä¸ harborã€query.ioã€Docker-hub ç­‰çŸ¥åçš„é•œåƒä»“åº“ä¹‹é—´åŒæ­¥ï¼Œè¿˜æ”¯æŒ helm-hub ç­‰ helm å›¾è¡¨ä¹‹é—´çš„åŒæ­¥ï¼š\nä¸‹é¢æˆ‘ä»¬é€šè¿‡ harbor ä¸ harbor å®ä¾‹ä¹‹é—´åŒæ­¥ï¼Œçœ‹ä¸€ä¸‹ Harbor çš„é•œåƒå¤åˆ¶åŠŸèƒ½\nHarbor To Harbor åŸºäºä¸ŠèŠ‚Harbor å¼€æºé•œåƒä»“åº“ä¼ä¸šçº§å®è·µï¼Œå®‰è£…äº†åŸŸåä¸ºharbor.devopsman.cnçš„ harbor å®ä¾‹ï¼Œæ ¹æ®åŒæ ·çš„æ–¹å¼å®‰è£…ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œå¹¶ä¸”é…ç½®å®ƒçš„åŸŸåä¸ºharbor.kubemaster.topï¼Œæˆ‘ä»¬æŠŠä¸Šä¸€èŠ‚ä¸­æ¨é€åˆ° harbor.devopsman.cn çš„é•œåƒ devopsman/kube-proxy:v1.18.0 é•œåƒåŒæ­¥åˆ° harbor.kubemaster.topï¼Œåœ¨å‡†å¤‡å¥½è¿™äº›ç¯å¢ƒä¹‹åï¼Œæˆ‘ä»¬å¼€å§‹é…ç½®é•œåƒä¹‹é—´çš„åŒæ­¥ã€‚\né¦–å…ˆåœ¨ harbor.kubemaster.top ä¸­æ–°å¢ä¸€ä¸ªä»“åº“ç›®æ ‡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œé…ç½®å¥½ç›®å‰é•œåƒä»“åº“çš„åœ°å€ã€ç”¨æˆ·åå’Œå¯†ç ä¹‹åï¼Œç‚¹å‡»æµ‹è¯•ä¿å­˜\nç„¶å ï¼Œåœ¨ç³»ç»Ÿç®¡ç†ä¸‹é¢çš„å¤åˆ¶ç®¡ç†å¤„ï¼Œæ–°å¢åŠ ä¸€ä¸ªå¤åˆ¶ç­–ç•¥ï¼Œå¦‚ä¸‹å›¾:\nåœ¨æºé•œåƒä»“åº“å¤„é€‰æ‹©æˆ‘ä»¬ä¹‹å‰åœ¨ä»“åº“ç®¡ç†å¤„é…ç½®å¥½çš„ harbor å®ä¾‹ï¼Œç„¶åé…ç½®æºèµ„æºè¿‡æ»¤ä¿¡æ¯ï¼Œå…¶ä¸­çš„åŒ¹é…ä¿¡æ¯å¦‚ä¸‹ï¼Œå…¶ä¸­(Y)è¡¨ç¤ºåˆæ³•ï¼Œ(N)è¡¨ç¤ºä¸åˆæ³•\n   Pattern String(Match or not)     library/* library/hello-world(Y) library/my/hello-world(N)   library/** library/hello-world(Y) library/my/hello-world(Y)   {library,goharbor}/** library/hello-world(Y) goharbor/harbor-core(Y) google/hello-world(N)   1.? 1.0(Y) 1.01(N)    ç„¶åå¡«å†™è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨è§„åˆ™ä¹‹åï¼Œä¿å­˜ã€‚ç„¶ååœ¨å¤åˆ¶ç®¡ç†åŠŸèƒ½å¤„ï¼Œæ‰¾åˆ°å¹¶é€‰æ‹©åˆšæ‰æ–°å»ºçš„å¤åˆ¶è§„åˆ™ï¼Œç‚¹å‡»å¤åˆ¶ï¼š\nè¿™æ ·å°±æ‰‹åŠ¨çš„è§¦å‘äº†å¤åˆ¶ï¼Œå…¶çŠ¶æ€ä¸ºInProgressï¼Œæˆ‘ä»¬ç‚¹å‡»å¯¹åº”çš„ä»»åŠ¡ IDï¼Œå°±èƒ½çœ‹åˆ°æ›´å¤šçš„å¤åˆ¶ä¿¡æ¯ï¼Œæ¯”å¦‚æˆåŠŸçŠ¶æ€ä¿¡æ¯ï¼ŒåŒæ­¥çš„æ—¥å¿—ä¿¡æ¯ç­‰\nè¿™æ ·ç›®æ ‡ç§æœ‰é•œåƒä»“åº“ä¸­çš„é•œåƒå°±è¢«åŒæ­¥äº†è¿‡æ¥ï¼ŒåŒæ—¶ harbor ä¹Ÿæ”¯æŒå®šæ—¶ä»»åŠ¡åŒæ­¥ï¼Œå…¶æ ¹æ® cron çš„è¯­æ³•è§„åˆ™å®ç°ç§æœ‰é•œåƒä»“åº“ä¹‹é—´çš„é•œåƒçš„è‡ªåŠ¨åŒæ­¥ã€‚\nHarbor é«˜å¯ç”¨ å¦‚æœæƒ³è¦ä¿è¯ harbor å®ä¾‹æ•°æ®çš„é«˜å¯ç”¨ï¼Œå¯ä»¥é€šè¿‡å¤åˆ¶ç®¡ç†çš„åŠŸèƒ½åœ¨å¤šä¸ª harbor ä¹‹é—´äº’ç›¸é…ç½®åŒæ­¥ç­–ç•¥ï¼Œå¯ä»¥åŸºäºpush modeå®ç°ä»»æ„ä¸€ä¸ªå®ä¾‹ä¸Šé¢æ¨é€äº†é•œåƒï¼Œéƒ½ä¼šè¢«è‡ªåŠ¨çš„åŒæ­¥åˆ°å…¶ä»–çš„å®ä¾‹ä¸Šå»ï¼Œç»“åˆ cron çš„å®šæ—¶ä»»åŠ¡åŸºæœ¬ä¸Šå°±è‡ªå®ç°äº† harbor çš„æ•°æ®é«˜å¯ç”¨ï¼Œé¿å…å› å•å®ä¾‹é€ æˆæ•°æ®æ— æ³•æŒ½å›ã€‚\nç²¾å½©æ–‡ç« å›é¡¾  Harbor å¼€æºé•œåƒä»“åº“ä¼ä¸šçº§å®ç° é˜¿é‡Œäº‘å‡ºå“Â·Kubernetes æ·±å…¥æµ…å‡ºå®è·µ v1.0 å¾®è½¯å‡ºå“Â·Kubernetes æœ€æ–°å­¦ä¹ æŒ‡å— v3.0 ç«ç„°å›¾ï¼šå…¨å±€è§†é‡çš„ Linux æ€§èƒ½å‰–æ 1k+åœ¨è¯» æœ€æµè¡Œçš„äº”æ¬¾ Kubernetes äº¤äº’å¼å¯è§†åŒ–å·¥å…· 900+åœ¨è¯» è½»æ¾çˆ¬å–æ‹‰å‹¾ç½‘å²—ä½æ‹›è˜ä¿¡æ¯ 600+åœ¨è¯» Yearning - æœ€ Popular çš„ MYSQL å®¡è®¡å¹³å° 700+åœ¨è¯» Prometheus ç›‘æ§ç³»åˆ—-éƒ¨ç½²ç¯‡ 500+åœ¨è¯»  ","description":"Harborçš„å¤šå®ä¾‹é—´æ•°æ®åŒæ­¥é«˜å¯ç”¨å®è·µ","id":4,"section":"posts","tags":["Harbor","é•œåƒä»“åº“","replication","é«˜å¯ç”¨"],"title":"Harbor2.0 Replication Manager","uri":"https://linuxermaster.github.io/en/posts/20200708-harbor2.0-%E5%A4%9A%E5%AE%9E%E4%BE%8B%E4%B9%8B%E9%97%B4%E9%95%9C%E5%83%8F%E5%A4%8D%E5%88%B6/"},{"content":"Harboræ˜¯ä¸€ä¸ªå¼€æºçš„ç®¡ç† Docker é•œåƒä»¥åŠ helm å›¾è¡¨çš„é¡¹ç›®ï¼Œè¯¥é¡¹ç›®åŒ…æ‹¬äº†æƒé™ç®¡ç†ã€LDAP è®¤è¯é›†æˆã€æ—¥å¿—äº‹ä»¶å®¡è®¡ã€ç®¡ç†ç•Œé¢ portalã€å¤š Harbor å®ä¾‹ä¹‹é—´æ•°æ®åŒæ­¥çš„å…¬å¸ƒåŠŸèƒ½ï¼ŒåŒæ—¶ä»Šå¹´ Harbor ä¹Ÿä» CNCF ä¸­æ¯•ä¸šäº†ï¼Œæä¾›äº†æ›´åˆè§„ã€æ€§èƒ½æ›´å¥½ã€æ“ä½œä½“éªŒæ›´ä½³çš„ 2.0 ç‰ˆæœ¬ï¼Œå¸®åŠ©æ‚¨åœ¨è·¨ kubernetes å’Œ Docker ç­‰äº‘åŸç”Ÿè®¡ç®—å¹³å°æŒç»­é«˜æ•ˆçš„ç®¡ç†åˆ¶å“ã€‚\nHarbor ç¯å¢ƒéœ€æ±‚    Software Version Description     Docker engine 17.06.0-ce åŠä»¥ä¸Š å®‰è£…å‚è€ƒ: Docker Docs   Docker Compose 1.18.0 ç‰ˆæœ¬åŠä»¥ä¸Šå³å¯ å®‰è£…å‚è€ƒ: Docker-Compose Docs   Openssl ä¸ºé¿å…å®‰å…¨æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ°æœ€æ–° å¯ä»¥é€‰æ‹©è‡ªç­¾è¯ä¹¦: Config HTTPSä¹Ÿå¯ä»¥ç”³è¯·ä¸ªäººå…è´¹ç‰ˆè¯ä¹¦    Harbor ç¦»çº¿å®‰è£… è€ƒè™‘åˆ°ç½‘ç»œå’Œæµ‹è¯•çš„éœ€æ±‚ï¼Œæˆ‘ä»¬é€šè¿‡è¿…é›·åœ¨ GITHUB ä¸Šä¸‹è½½ç¦»çº¿å®‰è£…çš„ harbor å®‰è£…åŒ…ï¼Œå…¶ä¸­åŒ…å«äº† Harbor æ‰€éœ€è¦çš„åŸºç¡€é•œåƒï¼Œç¦»çº¿å®‰è£…æ—¶é€šè¿‡ç¦»çº¿å®‰è£…åŒ…å†…çš„è„šæœ¬å°†å¯¼å‡ºçš„é•œåƒæ–‡ä»¶é€šè¿‡docker load -iå¯¼å…¥åˆ°æœåŠ¡å™¨å†…ï¼Œç„¶åé€šè¿‡ç¼–æ’è½¯ä»¶docker-composeè¿è¡Œï¼Œç›¸å½“æ–¹ä¾¿ã€‚ä½¿ç”¨åˆ°çš„åŸºç¡€é•œåƒå¦‚ä¸‹:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  goharbor/chartmuseum-photon v2.0.0 4db8d6aa63e9 8 weeks ago 127MB goharbor/redis-photon v2.0.0 c89ea2e53cc0 8 weeks ago 72.2MB goharbor/trivy-adapter-photon v2.0.0 6122c52b7e48 8 weeks ago 103MB goharbor/clair-adapter-photon v2.0.0 dd2210cb7f53 8 weeks ago 62MB goharbor/clair-photon 2 v2.0.0 f7c7fcc52278 8 weeks ago 171MB goharbor/notary-server-photon v2.0.0 983ac10ed8be 8 weeks ago 143MB goharbor/notary-signer-photon v2.0.0 bee1b6d75e0d 8 weeks ago 140MB goharbor/harbor-registryctl v2.0.0 c53c32d58d04 8 weeks ago 102MB goharbor/registry-photon v2.0.0 afdc1b7ada36 8 weeks ago 84.5MB goharbor/nginx-photon v2.0.0 17892f03e56c 8 weeks ago 43.6MB goharbor/harbor-log v2.0.0 5f8ff08e795c 8 weeks ago 82MB goharbor/harbor-jobservice v2.0.0 c68a2495bf55 8 weeks ago 116MB goharbor/harbor-core v2.0.0 3aa3af64baf8 8 weeks ago 138MB goharbor/harbor-portal v2.0.0 e0b1d3c894c4 8 weeks ago 52.4MB goharbor/harbor-db v2.0.0 5c76f0296cec 8 weeks ago 154MB goharbor/prepare v2.0.0 7266d49995ed 8 weeks ago 158MB   åœ¨å®‰è£…ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ä¸€ä¸‹ Harbor çš„é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ä¿®æ”¹ harbor ä½¿ç”¨çš„åŸŸåã€HTTPS è¯ä¹¦çš„ä½ç½®ç­‰,ä¸‹é¢æˆ‘ä»¬ç®€å•çš„è¯´æ˜:\n1 2 3 4  â˜¸ï¸ k8sdevğŸ”¥ default ~/Downloads î‚° ğŸ³ ğŸ‘‰ scp harbor-offline-installer-v2.0.0.tgz root@192.168.99.128:/root/ # åœ¨192.168.99.128ä¸Šè¿›è¡ŒHarborçš„å®‰è£…é…ç½® root@master:~# tar xf harbor-offline-installer-v2.0.0.tgz root@master:~/harbor# mv harbor.yml.tmpl harbor.yml   æˆ‘ä»¬é‡æ–°å‘½åé…ç½®æ–‡ä»¶ harbor.yml åï¼Œç¼–è¾‘è¯¥æ–‡ä»¶\n1  hostname: harbor.devopsman.cn # é…ç½®è‡ªå·±çš„harborè®¿é—®åŸŸå   å¦‚æœä½ éœ€è¦é…ç½® HTTPS æ¥è®¿é—® harbor,é‚£ä¹ˆéœ€è¦ç”³è¯·è¯ä¹¦æˆ–è€…è‡ªå·±ç”Ÿæˆçš„è‡ªç­¾è¯ä¹¦ï¼Œè¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨ DNSPOD ä¸Šç”³è¯·ä¸€ä¸ªå…è´¹çš„ä¸€å¹´å¯ç”¨çš„è¯ä¹¦\nå®é™…ä¸Š https çš„è¯ä¹¦æ˜¯é…ç½®ç»™ harbor çš„åå‘ä»£ç† nginx çš„ï¼Œæˆ‘ä»¬ä¸€èˆ¬è®¿é—® harbor å…¶å®æ˜¯è®¿é—® nginx ç„¶åå°†è¯·æ±‚è½¬å‘ç»™ harborï¼Œåœ¨æˆ‘ä»¬å®‰è£…å®Œæˆ harbor ä¹‹åï¼Œå¯ä»¥è¿è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹åˆ° Nginx ç›¸å…³çš„åå‘ä»£ç†çš„é…ç½®:\n1  root@master:~/harbor# docker exec -it nginx cat /etc/nginx/nginx.conf   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦é…ç½®ä¸€ä¸‹ HTTPS å¯ä¿¡è¯ä¹¦ï¼Œé¦–å…ˆåœ¨ DNSPOD ä¸Šä¸‹è½½ç”³è¯·å®¡æ‰¹æˆåŠŸåçš„è¯ä¹¦\nç„¶åè§£å‹ï¼Œå°†è§£å‹åçš„ Nginx ç›®å½•ä¸‹çš„ä¸¤ä¸ªæ–‡ä»¶é‡å‘½åæ”¾åœ¨/data/cert/ç›®å½•ä¸‹\n1 2 3 4 5 6 7 8 9 10  root@master:~/harbor/Nginx# ls -alh total 32K drwxr-xr-x 2 root root 4.0K Jul 7 2020 . drwxr-xr-x 100 root root 20K Jul 7 01:37 .. -rw-r--r-- 1 root root 3.7K Jul 7 2020 1_harbor.devopsman.cn_bundle.crt -rw-r--r-- 1 root root 1.7K Jul 7 2020 2_harbor.devopsman.cn.key # é‡å‘½åä¹‹åæ”¾åœ¨/data/certç›®å½•ä¸‹ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªç›®å½•ï¼Œéœ€è¦æå‰åˆ›å»º mkdir -pv /data/cert root@master:~/harbor/Nginx# cp 1_harbor.devopsman.cn_bundle.crt /data/cert/harbor.devopsman.cn.crt root@master:~/harbor/Nginx# cp 2_harbor.devopsman.cn.key /data/cert/harbor.devopsman.cn.key   ç„¶ååœ¨ harbor.yml ä¸‹é…ç½®è¯ä¹¦çš„ä½ç½®å³å¯:\n1 2 3 4 5 6 7  # https related config https: # https port for harbor, default is 443 port: 443 # The path of cert and key files for nginx certificate: /data/cert/harbor.devopsman.cn.crt private_key: /data/cert/harbor.devopsman.cn.key   é…ç½®å®Œè¯ä¹¦ï¼Œä½¿ç”¨ prepare è¿›è¡Œé…ç½® nginx çš„ https è¯ä¹¦\n1 2 3 4 5 6  cd /root/harbor # harborç¦»çº¿ç‰ˆè§£å‹åçš„æ–‡ä»¶ç›®å½• root@master:~/harbor# ./prepare prepare base dir is set to /root/harbor ... Generated configuration file: /compose_location/docker-compose.yml Clean up the input dir   æ— æœæ²¡æœ‰æŠ¥é”™ï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ docker-compose è¿è¡Œ harbor çš„å®¹å™¨äº†\n1 2 3 4 5 6 7 8 9 10 11  root@master:~/harbor# docker-compose up -d Creating network \u0026#34;harbor_harbor\u0026#34; with the default driver Creating harbor-log ... done Creating harbor-portal ... done Creating registry ... done Creating registryctl ... done Creating harbor-db ... done Creating redis ... done Creating harbor-core ... done Creating nginx ... done Creating harbor-jobservice ... done   å®‰è£…æ£€æµ‹ ç„¶åæˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ docker login æµ‹è¯•ä¸€ä¸‹\n1 2 3 4 5 6 7 8  root@master:~/harbor# docker login harbor.devopsman.cn Username: admin Password: # é»˜è®¤çš„å¯†ç åœ¨harbor.ymlæ–‡ä»¶ä¸­ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹ WARNING! Your password will be stored unencrypted in /root/.docker/config.json. Configure a credential helper to remove this warning. See https://docs.docker.com/engine/reference/commandline/login/#credentials-store Login Succeeded   é€šè¿‡æµè§ˆå™¨æŸ¥çœ‹æ˜¯å¦èƒ½ç™»å½•ä»¥åŠè¯ä¹¦çš„æœ‰æ•ˆæœŸ\næ­¤æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡æ¨é€ä¸€ä¸ªæµ‹è¯•çš„é•œåƒï¼Œæ£€æŸ¥æ˜¯å¤Ÿæ­£å¸¸ï¼Œæˆ‘ä»¬å…ˆåœ¨æµè§ˆå™¨ä¸­è®¿é—® harbor.devopsman.cnï¼Œç„¶åæ‰¾åˆ°æ¨é€å‘½ä»¤ï¼ŒæŸ¥çœ‹æ¨é€çš„æ ¼å¼ï¼Œä¸‹é¢æˆ‘ä»¬æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹ç»“æœï¼š\næˆ‘ä»¬é€‰æ‹©ä¸€ä¸ª k8s é›†ç¾¤æœåŠ¡åŸºç¡€ç»„ä»¶kube-proxyçš„é•œåƒï¼Œé‡æ–°æ‰“ä¸ªé•œåƒçš„ tagï¼Œç„¶åæ¨é€åˆ°æˆ‘ä»¬çš„devopsmanä»“åº“å†…:\n1 2 3 4 5 6 7 8 9 10 11  root@master:~/harbor# docker tag k8s.gcr.io/kube-proxy:v1.18.0 harbor.devopsman.cn/devopsman/kube-proxy:v1.18.0 root@master:~/harbor# docker push harbor.devopsman.cn/devopsman/kube-proxy:v1.18.0 The push refers to repository [harbor.devopsman.cn/devopsman/kube-proxy] 46b37415a80a: Pushed 0d8d54147a3a: Pushed 597151d24476: Pushed ad9fb2411669: Pushed 2dc2f2423ad1: Pushed 682fbb19de80: Pushed fc4976bd934b: Pushed v1.18.0: digest: sha256:b832454a96a848ad5c51ad8a499ef2173b627ded2c225e3a6be5aad9446cb211 size: 1786   é€šè¿‡æŸ¥çœ‹ï¼Œç¡®å®æˆåŠŸçš„å®Œæˆäº†é•œåƒçš„ä¸Šä¼ :\nè¿™æ ·å°±å®Œæˆäº† harbor ç¯å¢ƒçš„åŸºç¡€æ­å»ºï¼Œæ¥ä¸‹æ¥å°±å¥½å¥½çš„ä½“éªŒ Harbor å¸¦æ¥çš„æ–°åŠŸèƒ½å§ï¼Œé€šè¿‡å›¾ä¸Šçœ‹åˆ° harbor2.0 ç›®å‰æ”¯æŒDarkä¸»é¢˜ï¼Œhelm æ¨é€ç­‰ï¼Œå¼€å§‹åŠ¨æ‰‹å§ï¼Œä½“éªŒ Harbor çš„æ–°åŠŸèƒ½å’Œç‰¹æ€§ï¼Œæœ¬ç« èŠ‚å°±å®Œæˆäº† harbor çš„åŸºç¡€æ¢ç´¢ã€‚\n","description":"Harboræ˜¯ä¸€ä¸ªå¼€æºçš„ç®¡ç† Docker é•œåƒä»¥åŠ Helm å›¾è¡¨çš„é¡¹ç›®","id":5,"section":"posts","tags":["Harbor","é•œåƒä»“åº“","HTTPS","é«˜å¯ç”¨"],"title":"Harbor2.0 å®‰è£…éƒ¨ç½²å®è·µ(HTTPS)","uri":"https://linuxermaster.github.io/en/posts/20200707-harbor2.0%E5%B8%A6https%E7%9A%84%E5%AE%89%E8%A3%85%E9%83%A8%E7%BD%B2%E5%AE%9E%E8%B7%B5/"},{"content":"Lazydockerçš„ä½¿ç”¨èƒŒæ™¯ å¹³æ—¶çš„å·¥ä½œç®¡ç†ä¸­ä¼šä½¿ç”¨åˆ°å„ç§å„æ ·çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œæœ‰äº›äººæ˜¯æ¯”è¾ƒåŒçƒ¦çš„å»å­¦ä¹ å„ç§å‘½ä»¤ä»¥åŠé€‰é¡¹ï¼Œæ¯”å¦‚Dockerçš„å„ç§å‘½ä»¤å’Œé€‰é¡¹å…¶å®éƒ½è®©äººå¾ˆå¤´å¤§ï¼Œäºæ˜¯å°±æœ‰äººåšå‡ºæ¥ä¸€æ¬¾åä¸ºLazydockerçš„ä¸“ä¸ºæ‡’äººè®¾è®¡çš„Dockerå’Œdocker-composeç»ˆç«¯ç®¡ç†å·¥å…·ï¼Œè¯¥å·¥å…·ä½¿ç”¨Goè¯­è¨€å¼€å‘åŸºäºgocuiå®ç°ã€‚\nå¦‚æœä½ å‘ç°è‡ªå·±çš„é¡¹ç›®å‡ºäº†é—®é¢˜ï¼Œæˆ–è€…æ˜¯æœåŠ¡downæ‰äº†ï¼Œé‚£ä¹ˆLazydockerå°±å¯ä»¥ç«‹åˆ»ç»™ä½ æä¾›å¸®åŠ©ã€‚Lazydockerå¯ä»¥å¸®åŠ©æˆ‘ä»¬DEBUGè‡ªå·±çš„é¡¹ç›®æˆ–è€…æœåŠ¡ï¼Œå¹¶ä¸”åœ¨å‡ºç°é—®é¢˜æ—¶ç«‹åˆ»é‡å¯æ‰€æœ‰ç»„ä»¶ï¼Œç„¶åç»™æˆ‘ä»¬æä¾›è¯¦ç»†çš„æ—¥å¿—æµã€‚å…¶ä¸­ï¼Œæ—¥å¿—æµè¿˜ä¼šè¿›è¡Œç»†é¡¹åˆ†ç±»ï¼Œå¹¶å…è®¸æˆ‘ä»¬äº†è§£ç‰¹å®šæœåŠ¡ä¸­å‘ç”Ÿçš„æ‰€æœ‰äº‹æƒ…ã€‚æ˜¯githubä¸Šä¸€ä¸ªæ¯”è¾ƒğŸ”¥çš„å¼€æºå·¥å…·ã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œæƒ³è¦è®°ä½æ‰€æœ‰çš„Dockerå‘½ä»¤å…¶å®æ˜¯å¾ˆéº»çƒ¦çš„ï¼Œè€Œä¸”è·¨å¤šä¸ªç»ˆç«¯çª—å£è·Ÿè¸ªå®¹å™¨ä¹Ÿå‡ ä¹æ˜¯æ— æ³•åšåˆ°çš„ã€‚ä½†æ˜¯åœ¨Lazydockerçš„å¸®åŠ©ä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨ä¸€ä¸ªç»ˆç«¯çª—å£ä¸­æŸ¥çœ‹åˆ°æ‰€æœ‰ä½ æ‰€éœ€è¦çš„ä¿¡æ¯ï¼Œè€Œä¸”å¸¸ç”¨çš„å‘½ä»¤ä»…éœ€æŒ‰ä¸‹ä¸€ä¸ªé”®å³å¯å®ç°ã€‚æ¯«æ— ç–‘é—®ï¼ŒLazydockerç»å¯¹æ˜¯æ‡’äººä»¬çš„ç¦éŸ³!æˆ‘ä»¬å…ˆæ¥çœ‹ä¸€ä¸‹æ•ˆæœå›¾ï¼š\nLazydockerçš„åŠŸèƒ½ ç°åœ¨è®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹Lazydockerçš„åŠŸèƒ½\n  æ¸…æ™°çš„æŸ¥çœ‹æ‰€æœ‰çš„Dockerå’ŒDocker-composeå®¹å™¨ç¯å¢ƒçš„çŠ¶æ€\n  å®æ—¶æŸ¥çœ‹å®¹å™¨/æœåŠ¡æ—¥å¿—ï¼›\n  æŸ¥çœ‹å®¹å™¨æŒ‡æ ‡çš„asciiå›¾ï¼Œè¿™æ ·æ‚¨ä¸ä»…å¯ä»¥æ„Ÿè§‰åˆ°è€Œä¸”çœ‹èµ·æ¥åƒå¼€å‘äººå‘˜\n  è‡ªå®šä¹‰è¿™äº›å›¾å½¢ä»¥æµ‹é‡æ‚¨æƒ³è¦çš„å‡ ä¹ä»»ä½•æŒ‡æ ‡\n  è¿›å…¥å®¹å™¨/æœåŠ¡ï¼›\n  é‡å¯/ç§»é™¤/é‡å»ºå®¹å™¨æˆ–æœåŠ¡ï¼›\n  æŸ¥çœ‹ç»™å®šé•œåƒçš„å†å²å±‚ä¿¡æ¯\n  ä¿®æ”¹å ç”¨ç£ç›˜ç©ºé—´çš„å®¹å™¨ã€é•œåƒæˆ–å·ï¼›\n  Lazydockerå®‰è£…é…ç½® ä½ å¯ä»¥ç›´æ¥åœ¨Githubä¸Šä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®¹å™¨è¿è¡Œè¯¥å‘½ä»¤ï¼Œæ­¤å¤„æˆ‘ç›´æ¥ä½¿ç”¨äºŒè¿›åˆ¶å‘½ä»¤\n1 2 3  wget https://github.com/jesseduffield/lazydocker/releases/download/v0.9/lazydocker_0.9_Darwin_x86_64.tar.gz tar xf lazydocker_0.9_Darwin_x86_64.tar.gz cp lazydocker /usr/local/bin/ \u0026amp;\u0026amp; chmod +x /usr/local/bin/lazydocker   å› ä¸ºè¯¥å‘½ä»¤å¤ªé•¿äº†ï¼Œæ‰€ä»¥å»ºè®®é…ç½®ä¸€ä¸ªå‘½ä»¤åˆ«åï¼Œæ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨:\n1 2  echo \u0026#34;alias lzd=\u0026#39;lazydocker\u0026#39;\u0026#34; \u0026gt;\u0026gt; ~/.zshrc source ~/.zshrc   æ­¤æ—¶ï¼Œç›´æ¥æ‰§è¡Œlzdå³å¯åœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºå®¹å™¨çš„å„ç§æŒ‡æ ‡çŠ¶æ€å›¾\nLazydockerçš„é…ç½® Lazydockeræ”¯æŒç”¨æˆ·è‡ªå®šä¹‰é…ç½®ï¼Œå¯¹äºä¸åŒçš„æ“ä½œç³»ç»Ÿå…¶é…ç½®æ–‡ä»¶å­˜åœ¨ä¸åŒçš„ä½ç½®ä¸Š\n OSX: ~/Library/Application Support/jesseduffield/lazydocker/config.yml Linux: ~/.config/jesseduffield/lazydocker/config.yml Windows: C:\\\\Users\\\\\u0026lt;User\u0026gt;\\\\AppData\\\\Roaming\\\\jesseduffield\\\\lazydocker\\\\config.yml  ä¸è¿‡ä½ å¯ä»¥åœ¨æ‰“å¼€Lazydockerä¹‹åï¼Œé¼ æ ‡ç§»åˆ°å·¦ä¸Šæ–¹ï¼Œä½¿ç”¨å¿«æ·é”®oå³å¯æ‰“å¼€é…ç½®æ–‡ä»¶è¿›å…¥ç¼–è¾‘çŠ¶æ€ï¼Œæ­¤æ—¶ç›´æ¥ç¼–è¾‘å³å¯ï¼Œæƒ³è¦çŸ¥é“æ¯ä¸ªé…ç½®æ–‡ä»¶é€‰é¡¹çš„å«ä¹‰ï¼Œå¯ä»¥å‚è€ƒå¼€å‘é…ç½®å‚æ•°æŸ¥çœ‹ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªé…ç½®çš„æ¡ˆä¾‹ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48  gui: scrollHeight: 2 theme: activeBorderColor: - green - bold inactiveBorderColor: - white optionsTextColor: - blue returnImmediately: false wrapMainPanel: false reporting: undetermined commandTemplates: dockerCompose: docker-compose restartService: \u0026#39;{{ .DockerCompose }} restart {{ .Service.Name }}\u0026#39; stopService: \u0026#39;{{ .DockerCompose }} stop {{ .Service.Name }}\u0026#39; serviceLogs: \u0026#39;{{ .DockerCompose }} logs --since=60m --follow {{ .Service.Name }}\u0026#39; viewServiceLogs: \u0026#39;{{ .DockerCompose }} logs --follow {{ .Service.Name }}\u0026#39; rebuildService: \u0026#39;{{ .DockerCompose }} up -d --build {{ .Service.Name }}\u0026#39; recreateService: \u0026#39;{{ .DockerCompose }} up -d --force-recreate {{ .Service.Name }}\u0026#39; viewContainerLogs: docker logs --timestamps --follow --since=60m {{ .Container.ID }} containerLogs: docker logs --timestamps --follow --since=60m {{ .Container.ID }} allLogs: \u0026#39;{{ .DockerCompose }} logs --tail=300 --follow\u0026#39; viewAlLogs: \u0026#39;{{ .DockerCompose }} logs\u0026#39; dockerComposeConfig: \u0026#39;{{ .DockerCompose }} config\u0026#39; checkDockerComposeConfig: \u0026#39;{{ .DockerCompose }} config --quiet\u0026#39; serviceTop: \u0026#39;{{ .DockerCompose }} top {{ .Service.Name }}\u0026#39; customCommands: containers: - name: bash attach: true command: docker exec -it {{ .Container.ID }} /bin/sh serviceNames: [] oS: openCommand: open {{filename}} openLinkCommand: open {{link}} update: dockerRefreshInterval: 100ms stats: graphs: - caption: CPU (%) statPath: DerivedStats.CPUPercentage color: blue - caption: Memory (%) statPath: DerivedStats.MemoryPercentage color: green   Lazydockerçš„å¿«æ·é”® åœ¨lazydockerçš„äº¤äº’å¼ç•Œé¢ä¸­ï¼Œè¿˜æä¾›äº†å¤šç§å¿«æ·é”®ï¼Œå¤§å®¶å¯ä»¥é€šè¿‡å¿«æ·é”®å¿«é€Ÿçš„åœ¨å¤šç§åŠŸèƒ½ä¹‹é—´åˆ‡æ¢ã€‚\nProject  e: edit lazydocker config o: open lazydocker config [: previous tab ]: next tab m: view logs enter: focus main panel  Containers  [: previous tab ]: next tab d: remove e: Hide/Show stopped containers s: stop r: restart a: attach m: view logs c: run predefined custom command b: view bulk commands enter: focus main panel  Services  d: remove containers s: stop r: restart a: attach m: view logs [: previous tab ]: next tab R: view restart options c: run predefined custom command b: view bulk commands enter: focus main panel  Images  [: previous tab ]: next tab c: run predefined custom command d: remove image b: view bulk commands enter: focus main panel  Volumes  [: previous tab ]: next tab c: run predefined custom command d: remove volume b: view bulk commands enter: focus main panel  Main  esc: return  æ›´å¤šç²¾å½©ä¸“è¾‘  è¿ç»´æ¶æ„ä¸“è¾‘: åŒ…å«ä¸€äº›è¿ç»´æŠ€æœ¯çš„ä½¿ç”¨ç»éªŒåˆ†äº«ã€æŠ€æœ¯æ¶æ„æ¡ˆä¾‹ã€å­¦ä¹ äº¤æµç­‰ kuberneteså®è·µæ¡ˆä¾‹:éƒ½æ˜¯kubernetesç›¸å…³çš„å®è·µæ¡ˆä¾‹ï¼Œæ¯«æ— å¥—è·¯ï¼Œå¤§å®¶éƒ½è¯´å¥½! DevOpså®è·µæ¡ˆä¾‹: ä¸“è¾‘å†…åŒ…æ‹¬Jenkinså’ŒGitlabå„è‡ªæŒç»­é›†æˆã€æŒç»­å‘å¸ƒçš„å®è·µæ¡ˆä¾‹ï¼Œä»¥åŠå„ç§æ¨¡æ¿åº“çš„æœ€ä½³å®è·µã€‚  ","description":"Lazydocker-ä¸“ä¸ºæ‡’äººè®¾è®¡çš„å®¹å™¨å‘½ä»¤è¡Œå¯è§†åŒ–äº¤äº’å¼å·¥å…·","id":6,"section":"posts","tags":["docker","å·¥å…·","å¯è§†åŒ–"],"title":"Dockerå®¹å™¨å‘½ä»¤è¡Œå¯è§†åŒ–å·¥å…·-Lazydocker","uri":"https://linuxermaster.github.io/en/posts/20200615-lazydocker-%E4%B8%93%E4%B8%BA%E6%87%92%E4%BA%BA%E8%AE%BE%E8%AE%A1%E7%9A%84%E5%AE%B9%E5%99%A8%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%8F%AF%E8%A7%86%E5%8C%96%E4%BA%A4%E4%BA%92%E5%BC%8F%E5%B7%A5%E5%85%B7/"},{"content":"å®‰è£… Apache HTTP æœåŠ¡ Apacheæ˜¯ä¸–ç•Œä½¿ç”¨æ’åç¬¬ä¸€çš„WebæœåŠ¡å™¨è½¯ä»¶ã€‚å®ƒå¯ä»¥è¿è¡Œåœ¨å‡ ä¹æ‰€æœ‰å¹¿æ³›ä½¿ç”¨çš„è®¡ç®—æœºå¹³å°ä¸Šï¼Œç”±äºå…¶è·¨å¹³å°å’Œå®‰å…¨æ€§è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ˜¯æœ€æµè¡Œçš„WebæœåŠ¡å™¨ç«¯è½¯ä»¶ä¹‹ä¸€ã€‚\n æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…ApacheæœåŠ¡åŠå…¶æ‰©å±•åŒ…ã€‚  yum -y install httpd httpd-manual mod_ssl mod_perl mod_auth_mysql è¿”å›ç±»ä¼¼å¦‚ä¸‹å›¾ç»“æœåˆ™è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚\næ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ApacheæœåŠ¡ã€‚  systemctl start httpd.service æµ‹è¯•ApacheæœåŠ¡æ˜¯å¦å®‰è£…å¹¶å¯åŠ¨æˆåŠŸã€‚  Apacheé»˜è®¤ç›‘å¬80ç«¯å£ï¼Œæ‰€ä»¥åªéœ€åœ¨æµè§ˆå™¨è®¿é—®ECSåˆ†é…çš„IPåœ°å€http://\u0026lt;ECSå…¬ç½‘åœ°å€\u0026gt;ï¼Œå¦‚ä¸‹å›¾ï¼š\nå®‰è£… MySQL æ•°æ®åº“ ç”±äºä½¿ç”¨wordpressæ­å»ºäº‘ä¸Šåšå®¢ï¼Œéœ€è¦ä½¿ç”¨MySQLæ•°æ®åº“å­˜å‚¨æ•°æ®ï¼Œæ‰€ä»¥è¿™ä¸€æ­¥æˆ‘ä»¬å®‰è£…ä¸€ä¸‹MySQLã€‚\n æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¸‹è½½å¹¶å®‰è£…MySQLå®˜æ–¹çš„Yum Repositoryã€‚  wget http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm yum -y install mysql57-community-release-el7-10.noarch.rpm yum -y install mysql-community-server æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå¯åŠ¨ MySQL æ•°æ®åº“ã€‚  systemctl start mysqld.service æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹MySQLè¿è¡ŒçŠ¶æ€ã€‚  systemctl status mysqld.service æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹MySQLåˆå§‹å¯†ç ã€‚  grep \u0026quot;password\u0026quot; /var/log/mysqld.log æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç™»å½•æ•°æ®åº“ã€‚  mysql -uroot -p æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¿®æ”¹MySQLé»˜è®¤å¯†ç ã€‚   è¯´æ˜ æ–°å¯†ç è®¾ç½®çš„æ—¶å€™å¦‚æœè®¾ç½®çš„è¿‡äºç®€å•ä¼šæŠ¥é”™ï¼Œå¿…é¡»åŒæ—¶åŒ…å«å¤§å°å†™è‹±æ–‡å­—æ¯ã€æ•°å­—å’Œç‰¹æ®Šç¬¦å·ä¸­çš„ä¸‰ç±»å­—ç¬¦ã€‚\n ALTER USER 'root'@'localhost' IDENTIFIED BY 'NewPassWord1.'; æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºwordpressåº“ã€‚  create database wordpress; æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œåˆ›å»ºwordpressåº“ã€‚ æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹æ˜¯å¦åˆ›å»ºæˆåŠŸã€‚  show databases; è¾“å…¥exité€€å‡ºæ•°æ®åº“ã€‚  å®‰è£… PHP è¯­è¨€ç¯å¢ƒ WordPressæ˜¯ä½¿ç”¨PHPè¯­è¨€å¼€å‘çš„åšå®¢å¹³å°ï¼Œç”¨æˆ·å¯ä»¥åœ¨æ”¯æŒPHPå’ŒMySQLæ•°æ®åº“çš„æœåŠ¡å™¨ä¸Šæ¶è®¾å±äºè‡ªå·±çš„ç½‘ç«™ã€‚ä¹Ÿå¯ä»¥æŠŠWordPresså½“ä½œä¸€ä¸ªå†…å®¹ç®¡ç†ç³»ç»Ÿï¼ˆCMSï¼‰æ¥ä½¿ç”¨ã€‚\n æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…PHPç¯å¢ƒã€‚  1  yum -y install php php-mysql gd php-gd gd-devel php-xml php-common php-mbstring php-ldap php-pear php-xmlrpc php-imap   æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤åˆ›å»ºPHPæµ‹è¯•é¡µé¢ã€‚  1  echo \u0026#34;\u0026lt;?php phpinfo(); ?\u0026gt;\u0026#34; \u0026gt; /var/www/html/phpinfo.php   æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œé‡å¯ApacheæœåŠ¡ã€‚  1  systemctl restart httpd   æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®http://\u0026lt;ECSå…¬ç½‘åœ°å€\u0026gt;/phpinfo.phpï¼Œæ˜¾ç¤ºå¦‚ä¸‹é¡µé¢è¡¨ç¤ºPHPè¯­è¨€ç¯å¢ƒå®‰è£…æˆåŠŸã€‚  Wordpresså®‰è£…å’Œé…ç½® æœ¬å°èŠ‚å°†åœ¨å·²æ­å»ºå¥½çš„LAMP ç¯å¢ƒä¸­ï¼Œå®‰è£…éƒ¨ç½² WordPress\n æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå®‰è£…wordpressã€‚  1  yum -y install wordpress   æ˜¾ç¤ºå¦‚ä¸‹ä¿¡æ¯è¡¨ç¤ºå®‰è£…æˆåŠŸã€‚\nä¿®æ”¹WordPressé…ç½®æ–‡ä»¶ã€‚  1ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¿®æ”¹wp-config.phpæŒ‡å‘è·¯å¾„ä¸ºç»å¯¹è·¯å¾„ã€‚\n1 2 3 4 5 6  # è¿›å…¥/usr/share/wordpressç›®å½•ã€‚ cd /usr/share/wordpress # ä¿®æ”¹è·¯å¾„ã€‚ ln -snf /etc/wordpress/wp-config.php wp-config.php # æŸ¥çœ‹ä¿®æ”¹åçš„ç›®å½•ç»“æ„ã€‚ ll   2ï¼‰æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œç§»åŠ¨wordpressåˆ°Apacheæ ¹ç›®å½•ã€‚\n1 2 3  # åœ¨Apacheçš„æ ¹ç›®å½•/var/www/htmlä¸‹ï¼Œåˆ›å»ºä¸€ä¸ªwp-blogæ–‡ä»¶å¤¹ã€‚ mkdir /var/www/html/wp-blog mv * /var/www/html/wp-blog/   3ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¿®æ”¹wp-config.phpé…ç½®æ–‡ä»¶ã€‚\nåœ¨æ‰§è¡Œå‘½ä»¤å‰ï¼Œè¯·å…ˆæ›¿æ¢ä»¥ä¸‹ä¸‰ä¸ªå‚æ•°å€¼ã€‚\n database_name_hereä¸ºä¹‹å‰æ­¥éª¤ä¸­åˆ›å»ºçš„æ•°æ®åº“åç§°ï¼Œæœ¬ç¤ºä¾‹ä¸ºwordpressã€‚ username_hereä¸ºæ•°æ®åº“çš„ç”¨æˆ·åï¼Œæœ¬ç¤ºä¾‹ä¸ºrootã€‚ password_hereä¸ºæ•°æ®åº“çš„ç™»å½•å¯†ç ï¼Œæœ¬ç¤ºä¾‹ä¸ºNewPassWord1.ã€‚  1 2 3  sed -i \u0026#39;s/database_name_here/wordpress/\u0026#39; /var/www/html/wp-blog/wp-config.php sed -i \u0026#39;s/username_here/root/\u0026#39; /var/www/html/wp-blog/wp-config.php sed -i \u0026#39;s/password_here/NewPassWord1./\u0026#39; /var/www/html/wp-blog/wp-config.php   4ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼ŒæŸ¥çœ‹é…ç½®æ–‡ä»¶ä¿¡æ¯æ˜¯å¦ä¿®æ”¹æˆåŠŸã€‚\n1  cat -n /var/www/html/wp-blog/wp-config.php   æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œé‡å¯ApacheæœåŠ¡ã€‚  1  systemctl restart httpd   ","description":"wordpressåšå®¢ç½‘ç«™æ­å»ºæŒ‡å—","id":7,"section":"posts","tags":["wordpress","åšå®¢"],"title":"ECSä¸Šæ‰‹æŠŠæ‰‹æ­å»ºä¸ªäººåšå®¢ç³»ç»Ÿwordpress","uri":"https://linuxermaster.github.io/en/posts/20200610-%E6%9E%B6%E6%9E%84%E5%AE%9E%E9%AA%8C%E5%AE%A4-%E4%BA%91%E4%B8%8A%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A2/"},{"content":"è¿™æ¬¡ç»ˆäºæŠŠè‡ªå·±ç»™\u0026quot;å‘\u0026quot;åäº†ï¼Œå› ä¸ºä¸€æ¬¡ä¸å¯æ§åˆ¶çš„\u0026quot;åœç”µ\u0026quot;è®©å…¬å¸çš„éƒ¨åˆ†è€å¹´æœºé¥±å—äº†ä¸€æ¬¡\u0026quot;ç¾éš¾æ€§\u0026quot;çš„æ´—ç¤¼ï¼Œå¹¸è¿çš„æ˜¯éƒ¨åˆ†å¹¸å­˜ä¸‹æ¥çš„ä¸»æœºä¸­åŒ…æ‹¬æˆ‘ä»¬è‡³å…³é‡è¦çš„æœåŠ¡ï¼Œè€Œå°±æ˜¯é‚£äº›çœ‹ä¼¼æ— çŠ¶æ€çš„æœåŠ¡æ·±æ·±çš„æ‰“äº†è‡ªå·±ä¸€å·´æŒã€‚é¦–å½“å…¶å†²çš„å°±æ˜¯é‚£ä¸ªä¸‡æ¶çš„OpenvpnæœåŠ¡ã€‚ä½¿ç”¨Openvpnä¸»è¦æ˜¯ä¸ºäº†è§£å†³ä¸€ä¸‹åœºæ™¯:\næˆ‘ä»¬çš„éƒ¨åˆ†éä¸šåŠ¡åŠå…¬æœåŠ¡ä¸»è¦æœåŠ¡äºå†…éƒ¨çš„åŠå…¬äººå‘˜ï¼Œç”±äºç–«æƒ…çš„èƒŒæ™¯ä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ»¡è¶³è¿œç¨‹åŠå…¬çš„æ¡ä»¶ä»¥åŠéæœ¬åœ°çš„åŒäº‹ä¹Ÿæ˜¯éœ€è¦è®¿é—®è¿™äº›èµ„æºçš„ï¼ŒåŒ…æ‹¬ä¸€äº›æš´éœ²åœ¨å…¬ç½‘é™åˆ¶è®¿é—®çš„æœåŠ¡ç­‰ï¼Œæ‰€ä»¥é€šè¿‡ç‚¹å¯¹ç‚¹ç™»å½•è®¿é—®çš„Openvpnå°±æ˜¯æˆ‘ä»¬ä¸€ç›´ä»¥æ¥çš„é€‰æ‹©ã€‚\nç¾éš¾åçš„æ¢å¤æ°¸è¿œæ˜¯è®©äººå‘ç‹‚ï¼Œè€Œè¿™è¾¹å¤§å®¶åˆåœ¨ä¸æ–­çš„\u0026quot;å¹æ›´\u0026rdquo;ï¼Œå®åœ¨éš¾ä»¥æ·¡å®šä¸‹æ¥ï¼Œä¸æ‡‚ç½‘ç»œçš„æˆ‘ä¹Ÿæ²¡æ³•ç›´æ¥åœ¨é‚£äº›è€å¤è‘£èº«ä¸ŠåŠ¨åˆ€å­ï¼Œåœ¨ä¸€æ®µç„¦è™‘å’Œæ— å¥ˆä¹‹åè¿˜æ˜¯å†·é™ä¸‹ä»”ç»†æ€è€ƒå¦‚ä½•å¿«é€Ÿçš„æ¢å¤\u0026quot;æˆ˜åœº\u0026rdquo;ï¼Œå› ä¸ºä¸€å°ç‰©ç†æœºè€å‰è¾ˆå› ä¸ºæ‰ç”µè®©ç£ç›˜æ­‡å·¥äº†ï¼ŒçŸ­æ—¶é—´å†…æƒ³è¦ä¿®å¤ç‰©ç†æœºææ€•å·²ç»ä¸å¯èƒ½äº†ï¼Œæ‰€ä»¥æˆ‘å¼€å§‹è¿™æ ·åšï¼š\nç¬¬ä¸€æ­¥ ç½‘ä¸Šå†²æµªï¼ŒæŸ¥çœ‹é˜²ç«å¢™ç«¯å£ç»‘å®šè§„åˆ™ åœ¨ç½‘ä¸Šç–¯ç‹‚çš„æœç´¢ç€å…³äºCISCO ASA5515-Xçš„ç½‘ç»œé…ç½®ï¼ŒæŸ¥çœ‹é˜²ç«å¢™ä¸­å…³äºå…¬ç½‘IP:x.x.x.xä¸ä¸»æœºä¹‹é—´ç«¯å£å°„æ˜ å…³ç³»ï¼Œå› ä¸ºä¸æ–­çš„å˜æ›´äº¤æ¥äººï¼Œè®°å½•çš„ç½‘ç»œé…ç½®ä¿¡æ¯å’Œæ–‡æ¡£æ—©å·²éšç€æ—¶é—´é£é€äº†ï¼Œè¿™æ—¶å€™ä¸å…æƒ³æ¥å¥ä½ å¦¹çš„\u0026hellip;\n1 2 3 4  ciscoasa# show nat ... ciscoasa# show run object ...   é€šè¿‡æŸ¥çœ‹ä¸€æ³¢natã€objectå’Œserviceä¹‹åï¼Œå‘ç°äº†é˜²ç«å¢™ä¸Šé…ç½®çš„Public IPä¸å†…éƒ¨æœåŠ¡OpenVPNä¸»æœºä¹‹é—´ç«¯å£çš„æ˜ å°„å…³ç³»ï¼Œäºæ˜¯èµ¶ç´§æ‰¾å‡ ä¸ªè¿˜æœ‰æ°”çš„ä¸»æœºè¿›è¡Œä¸šåŠ¡æ¢å¤\nç¬¬äºŒæ­¥ ç…§ç€è‘«èŠ¦ç”»ä¸ªç“¢ è¿™æ˜¯ä¸€å°Centos7ä¸»æœº\n1 2  [root@vpn ~]# cat /etc/redhat-release CentOS Linux release 7.7.1908 (Core)   é¦–å…ˆå°±æ˜¯å°†å…¶IPåœ°å€ä¿®æ”¹ä¸ºé˜²ç«å¢™å†…è§„åˆ™åˆ¶å®šçš„ä¸»æœºIP\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  [root@vpn ~]# cat /etc/sysconfig/network-scripts/ifcfg-ens160 TYPE=\u0026#34;Ethernet\u0026#34; PROXY_METHOD=\u0026#34;none\u0026#34; BROWSER_ONLY=\u0026#34;no\u0026#34; BOOTPROTO=\u0026#34;none\u0026#34; DEFROUTE=\u0026#34;yes\u0026#34; IPV4_FAILURE_FATAL=\u0026#34;no\u0026#34; IPV6INIT=\u0026#34;yes\u0026#34; IPV6_AUTOCONF=\u0026#34;yes\u0026#34; IPV6_DEFROUTE=\u0026#34;yes\u0026#34; IPV6_FAILURE_FATAL=\u0026#34;no\u0026#34; IPV6_ADDR_GEN_MODE=\u0026#34;stable-privacy\u0026#34; NAME=\u0026#34;ens160\u0026#34; UUID=\u0026#34;aa08d0dd-5ba5-412c-84ab-716b885c4d89\u0026#34; DEVICE=\u0026#34;ens160\u0026#34; ONBOOT=\u0026#34;yes\u0026#34; IPADDR=\u0026#34;172.16.99.129\u0026#34; PREFIX=\u0026#34;24\u0026#34; GATEWAY=\u0026#34;192.168.99.254\u0026#34; # ä¿®æ”¹æˆéœ€è¦çš„IPåœ°å€ IPV6_PRIVACY=\u0026#34;no\u0026#34; PEERDNS=\u0026#34;yes\u0026#34; DNS1=\u0026#34;114.114.114.114\u0026#34;   ç¬¬ä¸‰æ­¥ é…ç½®OpenVPNç¯å¢ƒ åœ¨æ‰¾å¯¹IPè®¿é—®çš„æ˜ å°„å…³ç³»ä¹‹å,å°±æ˜¯æŠ“ç´§æ¢å¤æœåŠ¡ï¼Œäºæ˜¯æœ‰äº†ä¸‹é¢çš„å®‰è£…é…ç½®æ®µ:\n ä½¿ç”¨easy-rsaåˆ¶ä½œOpenVPNæ‰€éœ€çš„è¯ä¹¦ä»¥åŠå®¢æˆ·ç«¯è¯ä¹¦  1 2 3 4 5 6 7 8 9 10 11  yum install openvpn mkdir /data/tools -p wget -P /data/tools https://github.com/OpenVPN/easy-rsa/releases/download/3.0.1/EasyRSA-3.0.1.tgz tar zxf EasyRSA-3.0.1.tgz cp -rf EasyRSA-3.0.1 /etc/openvpn/easy-rsa cd /etc/openvpn/easy-rsa ./easyrsa init-pki # åˆå§‹åŒ–è¯ä¹¦ç›®å½•pki ./easyrsa build-ca nopass # åˆ›å»ºæ ¹è¯ä¹¦ï¼Œæç¤ºè¾“å…¥Common Nameï¼Œåç§°éšæ„ï¼Œä½†æ˜¯ä¸èƒ½å’ŒæœåŠ¡ç«¯è¯ä¹¦æˆ–å®¢æˆ·ç«¯è¯ä¹¦åç§°ç›¸åŒ ./easyrsa gen-dh # ç”ŸæˆDiffle Humanå‚æ•°ï¼Œå®ƒèƒ½ä¿è¯å¯†é’¥åœ¨ç½‘ç»œä¸­å®‰å…¨ä¼ è¾“   åˆ¶ä½œCAè¯ä¹¦  1  ./easyrsa init-pki # åˆå§‹åŒ–è¯ä¹¦ç›®å½•pki   åˆ¶ä½œæœåŠ¡ç«¯OpenVPN Serverè¯ä¹¦  1  ./easyrsa build-server-full server nopass # serveræ˜¯æœåŠ¡ç«¯è¯ä¹¦åç§°ï¼Œå¯ä»¥ç”¨å…¶å®ƒåç§°   åˆ¶ä½œå®¢æˆ·ç«¯è¯ä¹¦  1  ./easyrsa build-client-full barry nopass # barryæ˜¯å®¢æˆ·ç«¯è¯ä¹¦åç§°ï¼Œå¯ä»¥ç”¨å…¶å®ƒåç§°   é…ç½®LDAPè®¤è¯  1 2 3  yum install openvpn-auth-ldap -y [root@vpn openvpn]# ls -al /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so -rwxr-xr-x 1 root root 133320 Sep 6 2019 /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so   å‡†å¤‡LDAPè®¤è¯é…ç½®æ–‡ä»¶  \u0026lt;LDAP\u0026gt; # LDAP server URL URL\tldap://192.168.99.130 # Bind DN (If your LDAP server doesn't support anonymous binds) BindDN\tcn=openvpn,dc=openldap,dc=kubemaster,dc=top Password\topenvpn_Passsword # Network timeout (in seconds) Timeout\t15 # Enable Start TLS #TLSEnable\tno # Follow LDAP Referrals (anonymously) #FollowReferrals no # TLS CA Certificate File #TLSCACertFile\t/usr/local/etc/ssl/ca.pem # TLS CA Certificate Directory #TLSCACertDir\t/etc/ssl/certs # Client Certificate and key # If TLS client authentication is required #TLSCertFile\t/usr/local/etc/ssl/client-cert.pem #TLSKeyFile\t/usr/local/etc/ssl/client-key.pem # Cipher Suite # The defaults are usually fine here # TLSCipherSuite\tALL:!ADH:@STRENGTH \u0026lt;/LDAP\u0026gt; \u0026lt;Authorization\u0026gt; # Base DN BaseDN\t\u0026quot;ou=People,dc=openldap,dc=kubemaster,dc=top\u0026quot; # User Search Filter SearchFilter\t\u0026quot;(\u0026amp;(uid=%u))\u0026quot; # Require Group Membership RequireGroup\tfalse # Add non-group members to a PF table (disabled) #PFTable\tips_vpn_users \u0026lt;Group\u0026gt; BaseDN\t\u0026quot;ou=Groups,dc=example,dc=com\u0026quot; SearchFilter\t\u0026quot;(|(cn=developers)(cn=artists))\u0026quot; MemberAttribute\tuniqueMember # Add group members to a PF table (disabled) #PFTable\tips_vpn_eng \u0026lt;/Group\u0026gt; \u0026lt;/Authorization\u0026gt; é…ç½®æœåŠ¡ç«¯é…ç½®æ–‡ä»¶  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  [root@vpn openvpn]# cat server.conf |egrep -v \u0026#39;^$|^#|^\\;\u0026#39; port 11194 proto tcp dev tun ca /etc/openvpn/easy-rsa/pki/ca.crt cert /etc/openvpn/easy-rsa/pki/issued/server.crt key /etc/openvpn/easy-rsa/pki/private/server.key # This file should be kept secret dh /etc/openvpn/easy-rsa/pki/dh.pem server 10.8.0.0 255.255.255.0 # è¿™é‡Œæ˜¯openvpn serverçš„IPåœ°å€æ±  ifconfig-pool-persist ipp.txt push \u0026#34;dhcp-option DNS 114.114.114.114\u0026#34; # ä¸‹å‘ç»™å®¢æˆ·ç«¯çš„DNS push \u0026#34;dhcp-option DNS 8.8.8.8\u0026#34; client-to-client duplicate-cn keepalive 10 120 comp-lzo max-clients 50 user root group root persist-key persist-tun status openvpn-status.log log openvpn.log log-append openvpn.log verb 3 mute 10 client-cert-not-required plugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so \u0026#34;/etc/openvpn/auth/ldap.conf\u0026#34; username-as-common-name push \u0026#34;route 192.168.0.0 255.255.0.0\u0026#34; push \u0026#34;route 192.168.99.0 255.255.255.0\u0026#34; # ä¸‹å‘ç»™å®¢æˆ·ç«¯çš„éœ€è¦èµ°VPNçš„ç½‘ç»œæµé‡ï¼Œå…¶å®ƒç½‘æ®µä¸èµ°VPNï¼Œå¯æ­£å¸¸ä¸Šç½‘ã€‚   å¼€å¯è·¯ç”±è½¬å‘  1 2  echo \u0026#34;net.ipv4.ip_forward = 1\u0026#34; \u0026gt;\u0026gt; /etc/sysctl.conf sysctl -p   OpenVPNé˜²ç«å¢™çš„é…ç½®ï¼Œè¿™é‡Œæ˜¯æœ€é‡è¦çš„ä¸€ç¯ï¼Œæ³¨æ„ä¸è¦æŠŠä½ çš„ç½‘ç»œè®¾å¤‡åç§°å†™é”™äº†ã€‚  1  iptables -t nat -A POSTROUTING -s 10.8.0.0/16 -o ens160 -j MASQUERADE # ç½‘ç»œè®¾å¤‡ä¸ºens160   é…ç½®OpenVPNçš„å¯åœè„šæœ¬  1 2 3 4 5  #!/bin/bash echo \u0026#34;OpenVPN ..........[STOP]\u0026#34; ps -ef |grep openvpn | grep -v grep | awk \u0026#39;{print $2}\u0026#39; | xargs kill echo \u0026#34;OpenVPN ..........[START]\u0026#34; /usr/local/openvpn/sbin/openvpn --config /etc/openvpn/server.conf \u0026amp;   å¼€æœºæœåŠ¡è‡ªå¯,å°†ä¸‹é¢å†…å®¹å†™åˆ°/etc/rc.local  1 2  /usr/local/openvpn/sbin/openvpn --daemon --config /etc/openvpn/server.conf \u0026gt; /dev/null 2\u0026gt;\u0026amp;1 \u0026amp; exit 0   å®¢æˆ·ç«¯çš„é…ç½®  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20  # æŠŠæœåŠ¡å™¨ä¸Šè¿™ä¸‰ä¸ªæ–‡ä»¶æ‹·è´ä¸‹æ¥å’Œå®¢æˆ·ç«¯çš„é…ç½®æ–‡ä»¶æ”¾åœ¨ä¸€èµ· /etc/openvpn/easy-rsa/pki/private/barry.key /etc/openvpn/easy-rsa/pki/issued/barry.crt /etc/openvpn/easy-rsa/pki/ca.crt # å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶å†…å®¹ client dev tun proto tcp resolv-retry infinite nobind remote PUBLIC_ADDRESS 11194 # å°±æ˜¯ä¸192.168.99.129ä¸Šçš„11194ç»‘å®šçš„é‚£ä¸ªå…¬ç½‘IPåœ°å€ persist-key persist-tun ca ca.crt ns-cert-type server cert barry.crt key barry.key verb 3 # æ—¥å¿—ç­‰çº§ comp-lzo auth-user-pass   è¿™æ ·åŸºæœ¬ä¸Šå°±å®Œæˆäº†OpenVPNçš„æ­å»ºéƒ¨ç½²ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘æœ€åä¸€æ¬¡æ•´è¿™ç©æ„å„¿ã€‚ä¸‹é¢æ˜¯é…ç½®OpenVPNæ—¶å€™é‡åˆ°çš„é—®é¢˜\n æ˜æ˜åœ¨openvpnæœåŠ¡ç«¯é…ç½®äº†æœåŠ¡ç«¯åŒä¸€ç½‘æ®µçš„ä¸‹å‘è·¯ç”±ï¼Œä½†å°±æ˜¯pingä¸é€šæœåŠ¡ç«¯åŒä¸€ç½‘æ®µçš„å…¶ä»–ä¸»æœºï¼Œé‚£ä½ éœ€è¦è®¤çœŸæ£€æŸ¥ä¸‹é¢çš„é…ç½®ï¼ŒåŒ…æ‹¬ç½‘å¡è®¾å¤‡å  1 2  iptables -t nat -A POSTROUTING -s 10.8.0.0/16 -o ens160 -j MASQUERADE # ç½‘ç»œè®¾å¤‡ä¸ºens160 sudo iptables -nL -t nat # æŸ¥çœ‹   ä¸ºä»€ä¹ˆè¿ä¸Šäº†OpenVPNæˆ‘æ‰€æœ‰çš„æµé‡éƒ½ç»è¿‡OpenVPNäº†,é‚£æ˜¯ä½ å¯ç”¨äº†ä¸‹é¢çš„é…ç½®ï¼Œè¿™ä¸ªé…ç½®ä½ ä¹Ÿå¯ä»¥ç”¨äºç§‘å­¦***/ä¸Šç½‘  1  push \u0026#34;redirect-gateway def1 bypass-dhcp\u0026#34;   ç»™å®¢æˆ·ç«¯æŒ‡å®šå›ºå®šçš„VPNåœ°å€  1 2  client-config-dir ccd # è¡¨ç¤ºæŒ‡å®šå›ºå®šIPåœ°å€çš„å®¢æˆ·ç«¯é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨openvpnæœåŠ¡ç«¯é…ç½®æ–‡ä»¶ç»Ÿè®¡ç›®å½•ä¸‹çš„ccdç›®å½•é‡Œé¢ route 192.168.40.128 255.255.255.248 # æŒ‡å®šå®¢æˆ·ç«¯IPçš„åœ°å€   ä¸ºä»€ä¹ˆåœ¨linux/MacOSä¸Šé…ç½®éƒ½æ²¡æœ‰é—®é¢˜ï¼Œè€Œåœ¨windowä¸Šæœ‰é—®é¢˜ï¼Œæ­¤æ—¶ä½ éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨windowä¸Šå®‰è£…å’Œå¯åŠ¨OpenVPNéƒ½æ˜¯éœ€è¦ç®¡ç†å‘˜æƒé™çš„ï¼Œå› ä¸ºå®ƒä¼šæ¶‰åŠåˆ°ä¸€äº›æ·»åŠ è·¯ç”±çš„æ“ä½œï¼Œè¿™äº›éœ€è¦ç®¡ç†å‘˜æƒé™ã€‚  ","description":"Centos7ä¸Šå®‰è£…éƒ¨ç½²openvpnå¹¶é€šè¿‡openldapè®¤è¯","id":8,"section":"posts","tags":["openvpn","openldap","ç½‘ç»œ"],"title":"Openvpn-æœ€éš¾å¿˜çš„ä¸€æ¬¡Oenvpnã€ç¾åé‡å»ºã€","uri":"https://linuxermaster.github.io/en/posts/20200619-%E6%9C%80%E9%9A%BE%E5%BF%98%E7%9A%84%E4%B8%80%E6%AC%A1openvpn%E7%81%BE%E5%90%8E%E9%87%8D%E5%BB%BA/"},{"content":"OpenVPNé«˜çº§è¿›é˜¶ OpenVPNæœåŠ¡æ˜¯ä¸€ä¸ªæ¯”è¾ƒè€çš„æœåŠ¡äº†ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ ¸å¿ƒçš„åŸºç¡€æœåŠ¡æˆ‘è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦è®¤çœŸä»”ç»†çš„æŒæ¡å’Œç†è§£ï¼Œå¹¶ä¸”èƒ½æ ¹æ®å…¶è‡ªèº«çš„åŠŸèƒ½ä¼˜åŒ–å’Œé…ç½®å‡ºæˆ‘ä»¬éœ€è¦çš„åœºæ™¯ï¼Œåªè¦èƒ½è§£å†³å®é™…çš„é—®é¢˜åœºæ™¯ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´å°±æ˜¯æœ‰ä»·å€¼çš„ï¼Œä¸‹é¢é€šè¿‡å‡ ä¸ªåœºæ™¯èŠä¸€ä¸‹OpeVPNçš„é«˜é˜¶é…ç½®é€‰é¡¹:\nèƒŒæ™¯ï¼š\n å…¬å¸å†…éƒ¨ç½‘æ®µæ˜¯192.168.99.0/24ï¼› æ‰€æœ‰äººå…è®¸è®¿é—®åå‘ä»£ç†ä¸»æœºä¸º192.168.99.130ï¼Œä½†ä¸èƒ½è®¿é—®å…¶ä»–æœåŠ¡å™¨ï¼› ç‰¹å®šçš„ç”¨æˆ·å…è®¸è®¿é—®æ•°æ®åº“æœåŠ¡å™¨ä¸º192.168.99.131ï¼Œä¸èƒ½è®¿é—®å…¶ä»–æœåŠ¡å™¨ï¼› ç®¡ç†å‘˜èƒ½è®¿é—®æ‰€æœ‰å…¬å¸å†…ç½‘æœåŠ¡å™¨ã€‚  åœºæ™¯1 é™åˆ¶ä¸»æœºè®¿é—® æˆ‘ä»¬ä¸éœ€è¦VPNå®¢æˆ·ç«¯è®¿é—®VPNæœåŠ¡ç«¯æ‰€åœ¨é›†ç¾¤ä¸­çš„æ‰€æœ‰å…¶ä»–ä¸»æœº,å…è®¸æŸäº›ç‰¹å®šçš„VPNå®¢æˆ·ç«¯è®¿é—®æŒ‡å®šçš„å†…ç½‘ä¸»æœºèµ„æºçš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åœ¨å®¢æˆ·ç«¯æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹å¯¹VPNæœåŠ¡ç«¯åšä¸€äº›è®¾ç½®æ»¡è¶³ä»¥ä¸Šåœºæ™¯:\næ›´æ–°æœåŠ¡ç«¯çš„é…ç½®ï¼Œå°†VPNåœ°å€æ± çš„ç½‘æ®µåˆ’åˆ†ä¸ºç®¡ç†å‘˜ç½‘æ®µã€å®¢æˆ·ç»„ç½‘æ®µã€æ™®é€šç½‘ç»œ:\n1 2 3 4 5 6 7 8 9  # åœ¨OpenvpnæœåŠ¡ç«¯é…ç½®æ–‡ä»¶server.confå¢åŠ ï¼š #10.8.0.0æ˜¯ç»™æ‰€æœ‰VPNå®¢æˆ·ç«¯çš„IPæ®µï¼› server 10.8.0.0 255.255.255.0 #10.8.1.0æ˜¯ç»™ç®¡ç†å‘˜åˆ†é…çš„IPæ®µï¼› server 10.8.1.0 255.255.255.0 #10.8.2.0å°±æ˜¯ç»™ç‰¹å®šç”¨æˆ·ç»„åˆ†é…çš„IPæ®µï¼› server 10.8.2.0 255.255.255.0 #ä¸‹é¢æ˜¯å®šä¹‰æœåŠ¡å™¨è¯»å–ç‰¹æ®Šå®¢æˆ·ç«¯é…ç½®æ–‡ä»¶çš„ç›®å½•ä¸ºccd,ccdæ˜¯ä¸OpenvpnæœåŠ¡ç«¯é…ç½®æ–‡ä»¶åŒçº§ç›®å½•ä¸­çš„ccdç›®å½• client-config-dir ccd   ç„¶åç»™ç®¡ç†å‘˜é…ç½®è®¿é—®ç½‘ç»œ\n1 2  cat ccd/sysadmin1 ifconfig-push 10.8.1.1 10.8.1.2   å®¢æˆ·ç»„ç½‘ç»œ:\n1 2  cat ccd/kehugroup ifconfig-push 10.8.2.1 10.8.2.2   è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯, ccdç›®å½•ä¸‹çš„æ–‡ä»¶åå°±æ˜¯ç”¨æˆ·çš„Common Nameï¼ŒOpenVPNæ˜¯æ ¹æ®è¯¥åç§°æ¥è·å¾—æŒ‡å®šå®¢æˆ·ç«¯çš„ï¼Œå®¢æˆ·ç«¯çš„IPåœ°å€ä¸æ˜¯ä»»æ„æŒ‡å®šçš„ï¼Œç”±äºWindowsçš„TAPé©±åŠ¨å¿…é¡»é‡‡ç”¨/30ç½‘æ®µçš„IPï¼Œä¸ºå…¼å®¹è¯¥åè®®ï¼Œåº”ä»ç‰¹å®šçš„IPåœ°å€ä¸­é€‰æ‹©ï¼Œè€Œä¸”æ˜¯æˆç»„å‡ºç°çš„ã€‚\næœ€ååœ¨å®Œæˆç½‘ç»œçš„åˆ’åˆ†ä¹‹åï¼Œåœ¨OpenVPNç«¯è¿›è¡ŒIptablesé™åˆ¶:\n1 2 3  iptables -A FORWARD -i tun0 -s 10.8.0.0/24 -d 192.168.99.130 -j ACCEPT iptables -A FORWARD -i tun0 -s 10.8.1.0/24 -d 192.168.99.0/24 -j ACCEPT iptables -A FORWARD -i tun0 -s 10.8.2.0/24 -d 192.168.99.131 -j ACCEPT   åœºæ™¯2 æ‰“é€šOpenVPNå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯çš„å†…ç½‘ 1 2 3 4 5 6  #è®©æ‰€æœ‰å®¢æˆ·ç«¯éƒ½å¢åŠ åˆ°å†…ç½‘192.168.99.0/24çš„è·¯ç”± push \u0026#34;route 192.168.99.0 255.255.255.0\u0026#34; # è®©æ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½èƒ½è®¿é—®ä»…å…è®¸æœåŠ¡ç«¯è®¿é—®çš„ç½‘ç«™(çº¦æŸç™½åå•) push \u0026#34;route 39.156.69.79 255.255.255.255\u0026#34; # å‘å®¢æˆ·ç«¯æ¨é€å¢åŠ è®¿é—®æœåŠ¡ç«¯å­ç½‘çš„192.168.10.0/24çš„è·¯ç”±ï¼Œæ³¨æ„æœåŠ¡ç«¯çš„IPæ˜¯å¦æ˜¯å­ç½‘çš„ç½‘å…³ï¼Œå¦åˆ™éœ€è¦åœ¨å­ç½‘ç½‘å…³å¤„æ·»åŠ åˆ°è¾¾192.168.99.0çš„è·¯ç”±(å®¢æˆ·ç«¯ä¹Ÿæ˜¯å¦‚æ­¤) push \u0026#34;route 192.168.10.0 255.255.255.0\u0026#34;   åœ¨å­ç½‘ç½‘å…³å¤„æ·»åŠ è·¯ç”±\n1  route add -net 192.168.99.0 mask 255.255.255.0 gw 192.168.10.254 dev ens160   åœºæ™¯3 OpenVPNæä¾›DHCPä¸DNS OpenVPNå†…éƒ¨æä¾›äº†DHCPçš„æœåŠ¡ï¼Œè€Œä¸éœ€è¦ä¾èµ–å¤–éƒ¨çš„DHCPæœåŠ¡å™¨ã€‚åŒæ ·ï¼Œä¹Ÿæä¾›äº†DHCPæœåŠ¡çš„ä¸€äº›é…ç½®å‚æ•°\n1 2 3 4 5 6 7 8  # openvpnæœåŠ¡ç«¯çš„é…ç½® #å®šä¹‰å®¢æˆ·ç«¯çš„DNSæœåŠ¡å™¨åœ°å€ push \u0026#34;dhcp-option DNS 114.114.114.114\u0026#34; # è¿™æ˜¯é¦–é€‰DNS push \u0026#34;dhcp-option DNS 8.8.8.8\u0026#34; # è¿™æ˜¯å¤‡é€‰DNS #å®šä¹‰å®¢æˆ·ç«¯çš„WINSæœåŠ¡å™¨åœ°å€ push \u0026#34;dhcp-options WINS 192.168.228.1\u0026#34; # è¿™æ˜¯è®¾ç½®IPå’Œä¸»æœºåä¹‹é—´çš„æ˜ å°„ä¸IPå’ŒåŸŸåä¹‹é—´çš„æ˜ å°„ä¸åŒ,è¾ƒå°‘ä½¿ç”¨ #è®©å®¢æˆ·ç«¯å‘èµ·çš„æ‰€æœ‰IPè¯·æ±‚éƒ½é€šè¿‡OpenVPNæœåŠ¡å™¨,å¯ç”¨äºå…¨å±€ä»£ç†ä½¿ç”¨ï¼Œå¯ç”¨åä¼šå‡ºç°æµè§ˆå™¨å†…æ‰“ä¸å¼€ç½‘ç«™ç­‰æƒ…å†µ push \u0026#34;redirect-gateway def1 bypass-dhcp\u0026#34;   åœºæ™¯4 æ·»åŠ LDAPè®¤è¯ é€šå¸¸æƒ…å†µä¸‹ï¼ŒOpenVPNå®¢æˆ·ç«¯éƒ½éœ€è¦é€šè¿‡SSLè¿æ¥çš„ï¼Œå› æ­¤å®¢æˆ·ç«¯å¿…é¡»è¦æœ‰caè¯ä¹¦ï¼ŒæœåŠ¡ç«¯å¯ä»¥é€šè¿‡è®¾ç½®client-cert-not-requiredè®©å®¢æˆ·ç«¯ä¸é…ç½®è¯ä¹¦ã€‚ä½†æ˜¯ä¸€èˆ¬é€šè¿‡OpenLDAPè®¤è¯æ˜¯æœ€æ–¹ä¾¿çš„äº‹æƒ…:\n å®‰è£…LDAP`æ¨¡å—çš„é…ç½®  1 2 3  yum install openvpn-auth-ldap -y [root@vpn ~]# ls -al /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so -rwxr-xr-x 1 root root 133320 Sep 6 2020 /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so   å‡†å¤‡ldapè®¤è¯çš„é…ç½®æ–‡ä»¶/etc/openvpn/auth/ldap.conf  1 2  mkdir -p /etc/openvpn/auth cd $_ \u0026amp;\u0026amp; touch ldap.conf   ä¸‹é¢æ˜¯ldap.confçš„é…ç½®æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46  [root@vpn ~]# cat /etc/openvpn/auth/ldap.conf \u0026lt;LDAP\u0026gt; # LDAP server URL URL\tldap://192.168.99.130 # Bind DN (If your LDAP server doesn\u0026#39;t support anonymous binds) BindDN\tcn=openvpn,dc=openldap,dc=kubemaster,dc=top Password\topenvpnuserpasswd # Network timeout (in seconds) Timeout\t15 # Enable Start TLS #TLSEnable\tno # Follow LDAP Referrals (anonymously) #FollowReferrals no # TLS CA Certificate File #TLSCACertFile\t/usr/local/etc/ssl/ca.pem # TLS CA Certificate Directory #TLSCACertDir\t/etc/ssl/certs # Client Certificate and key # If TLS client authentication is required #TLSCertFile\t/usr/local/etc/ssl/client-cert.pem #TLSKeyFile\t/usr/local/etc/ssl/client-key.pem # Cipher Suite # The defaults are usually fine here # TLSCipherSuite\tALL:!ADH:@STRENGTH \u0026lt;/LDAP\u0026gt; \u0026lt;Authorization\u0026gt; # Base DN BaseDN\t\u0026#34;ou=People,dc=openldap,dc=kubemaster,dc=top\u0026#34; # User Search Filter SearchFilter\t\u0026#34;(\u0026amp;(uid=%u))\u0026#34; # uidæˆ–è€…cnä¸€èˆ¬éƒ½å¯ä»¥ï¼Œæ ¹æ®è‡ªå·±çš„æ¡ä»¶ # Require Group Membership RequireGroup\tfalse # æ˜¯å¦å¯ç”¨ç»„æˆå‘˜å…³ç³» # Add non-group members to a PF table (disabled) #PFTable\tips_vpn_users \u0026lt;Group\u0026gt; BaseDN\t\u0026#34;ou=Groups,dc=example,dc=com\u0026#34; SearchFilter\t\u0026#34;(|(cn=developers)(cn=artists))\u0026#34; MemberAttribute\tuniqueMember # Add group members to a PF table (disabled) #PFTable\tips_vpn_eng \u0026lt;/Group\u0026gt; \u0026lt;/Authorization\u0026gt;   åœ¨å®Œæˆldapçš„é…ç½®ä¹‹åï¼Œåªéœ€è¦åœ¨æœåŠ¡ç«¯å¢åŠ ä»¥ä¸‹é…ç½®å³å¯:\n1 2 3  client-cert-not-required plugin /usr/lib64/openvpn/plugin/lib/openvpn-auth-ldap.so \u0026#34;/etc/openvpn/auth/ldap.conf\u0026#34; username-as-common-name   è¿™æ ·å°±å®Œæˆäº†åŸºäºopenldapè®¤è¯çš„OpenVPNå®¢æˆ·ç«¯çš„ç”¨æˆ·é‰´æƒã€‚\nç–‘éš¾æ‚ç—‡  VPNæ¯éš”10så·¦å³ä¼šé‡æ–°è¿æ¥  åŸºäºå¯†ç è®¤è¯çš„VPNå‡ºç°æ¯éš”10sé‡æ–°è¿æ¥ï¼Œè¯´æ˜ä½ çš„è´¦å·åœ¨åˆ«çš„è®¾å¤‡ä¸Šè¿›è¡Œç™»å½•äº†ã€‚è¯·æ£€æŸ¥æ˜¯å¦å­˜åœ¨æ”¹æƒ…å†µå¹¶å»ºè®®åŠæ—¶çš„ä¿®æ”¹å¯†ç ã€‚\nMacä¸Šçš„Tunnelblickæ€»æ˜¯å¤„äºä¸æ–­è®¤è¯çš„çŠ¶æ€  å‡ºç°è¿™ç§æƒ…å†µè¯´æ˜ä½ çš„Tunnelblickçš„ç‰ˆæœ¬å¤ªä½ï¼Œéœ€è¦ä½ åŠæ—¶çš„æ›´æ–°è¯¥è½¯ä»¶çš„ç‰ˆæœ¬ï¼Œå°±å¯ä»¥è§£å†³ï¼ŒTunnelBlickä¸‹è½½åœ°å€\nWindowä¸Šä½¿ç”¨OpenVPNå®¢æˆ·ç«¯è¿æ¥æ—¶å‡ºç°SSL ERROR  å‡ºç°è¿™ç§é—®é¢˜è¯´æ˜ä½ çš„Windowä¸Šçš„OpenVPNå®¢æˆ·ç«¯ç‰ˆæœ¬å¤ªä½ï¼Œéœ€è¦é‡æ–°ä¸‹è½½å®¢æˆ·ç«¯å¹¶ä¸”ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½å®‰è£…å’Œå¯åŠ¨ã€‚\nWindowä¸Šä½¿ç”¨OpenVPNå®¢æˆ·ç«¯è¿æ¥æ—¶å‡ºç°windows route add command failed  å‡ºç°è¿™ç§é—®é¢˜ï¼Œå±äºæ‰“å¼€VPNå®¢æˆ·ç«¯çš„æ—¶å€™æ²¡æœ‰ä½¿ç”¨ç®¡ç†å‘˜èº«ä»½æ‰“å¼€ï¼Œæ²¡æœ‰æ·»åŠ è·¯ç”±çš„æƒé™ã€‚\nä½¿ç”¨OpenVPNè¿æ¥å‡ºç°èº«ä»½éªŒè¯å¤±è´¥  å‡ºç°è¿™ç§é—®é¢˜ï¼Œè¿™æ˜¯å±äºä½ çš„ç”¨æˆ·åæˆ–è€…å¯†ç å¡«å†™é”™è¯¯ï¼Œè®¤çœŸæ£€æŸ¥è´¦æˆ·ä¿¡æ¯æˆ–è€…æ‰¾ç›¸å…³æŠ€æœ¯è´Ÿè´£äººé‡æ–°ä¿®æ”¹å¯†ç ã€‚\n","description":"Openvpnä½¿ç”¨è¿‡ç¨‹ä¸­çš„ç–‘éš¾æ‚ç—‡æ€»ç»“","id":9,"section":"posts","tags":["openvpn","openldap","ç½‘ç»œ"],"title":"Openvpn-é«˜çº§è¿›é˜¶","uri":"https://linuxermaster.github.io/en/posts/20200620-openvpn%E9%AB%98%E7%BA%A7%E8%BF%9B%E9%98%B6/"},{"content":"ä»Šå¤©ç»™å¤§å®¶åˆ†äº«ç›®å‰æœ€popularçš„MySQL SQLå®¡è®¡å¹³å°Yearningï¼Œè¿™ä¸ªå¹³å°å¯ä»¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿçš„å®ŒæˆSQLè¯­å¥çš„è¯­æ³•çš„å®¡æ ¸ã€æ£€æµ‹ã€æ‰§è¡Œå’Œå›æ»šç­‰æ“ä½œã€‚åœ¨æ—©æœŸï¼Œæˆ‘ä»¬æ˜¯å…ˆæ•´ç†å‡ºæ¥ä¸€å¥—SQLä½¿ç”¨è§„èŒƒï¼Œç„¶åé€šè¿‡éƒ¨é—¨ä¼šè®®å®¡æ ¸è§„èŒƒçš„å†…å®¹ï¼Œæœ€åè¦æ±‚æŒ‰ç…§å†…å®¹åº”ç”¨åœ¨å®é™…çš„å·¥ä½œä¸­ï¼Œä½†æ˜¯è¿™äº›ä¸å…æœ‰äº›å¼€å‘è€…ä¾æ—§å°±ä¸ä½æˆ–è€…ä¸ä¸Šå¿ƒï¼Œä¸æŒ‰å¥—è·¯å‡ºç‰Œï¼Œé€ æˆæ•°æ®åº“ä½¿ç”¨ä¸ç»Ÿä¸€ã€‚\nYearningè‡ªèº«åŒ…å«äº†ä¸€å¥—é€šå¸¸é€‚ç”¨çš„å®¡æ ¸è§„èŒƒï¼ŒåŸºæœ¬ä¸Šèƒ½æ»¡è¶³æ—¥å¸¸éœ€è¦ï¼ŒåŒæ—¶è§„èŒƒäº†æ—¥å¸¸å¼€å‘éœ€æ±‚æ‰€æ¶‰åŠåˆ°çš„SQLå˜åŠ¨ï¼Œåœ¨Yearningå¹³å°çš„è¾…åŠ©ä¸‹ï¼Œæ—¥å¸¸çš„SQLå˜åŠ¨ä¹Ÿæ›´åŠ è´´è¿‘SQLä½¿ç”¨çš„è§„èŒƒåŒ–ã€æ ‡å‡†åŒ–çš„è¦æ±‚ï¼ŒåŒæ—¶100%åŸºäºGOè¯­è¨€ç ”å‘çš„Yearningä¹Ÿå¯ä»¥é€šè¿‡è‡ªå®šä¹‰äºŒæ¬¡å¼€å‘(éµå¾ªAGPLåè®®)å¢åŠ ä¸€äº›ç¬¦åˆè‡ªå·±å®¡æ ¸ç­–ç•¥ï¼Œä½†æ˜¯å®ƒçš„å®¡æ ¸å¼•æ“Junoä¸æ˜¯å¼€æºçš„ã€‚\nYearningçš„å‰ç«¯æ˜¯åŸºäºVue.jsæ„å»ºçš„ï¼Œè€Œè¿™å—å®¡æ ¸è§„åˆ™çš„ä»£ç ä¹Ÿæ˜¯å…¨éƒ¨åœ¨JSä¸­ä¼ é€’å’Œå¤„ç†çš„ï¼Œå¦å¤–å®ƒè¿˜æä¾›SQLè¯­æ³•é«˜äº®ã€è‡ªåŠ¨è¡¥å…¨å’Œæ™ºèƒ½æç¤ºã€å¯è§†åŒ–ç­‰ã€‚\nä½¿ç”¨æ„Ÿå—  æœ‰å·¥å•è®°å½•ï¼Œè®©å˜æ›´çš„SQLè®°å½•è½åº“ä¿å­˜ï¼Œæ˜“äºå®¡è®¡ã€‚ å¼€å‘è€…è‡ªå·±æäº¤ï¼Œç›‘æµ‹æœ€å¤§ç¨‹åº¦å‡å°ä»¥å¾€é€šè¿‡å¾®ä¿¡ä¼ é€ç­‰ç²˜è´´å‡ºé”™å‡ ç‡ï¼Œç»™DBA.è¿ç»´çœå¿ƒã€‚ å†ä¸€æ¬¡è¯æ˜è½å®è§„èŒƒæ€§çš„ä¸œè¥¿éœ€è¦æœ‰å·¥å…·åŒ–ã€æµç¨‹åŒ–ï¼Œé è‡ªè§‰ä¸‡ä¸‡æ˜¯åšä¸åˆ°çš„ã€‚ SQLå®¡æ‰¹è¦è®¾ç½®å¤šæˆå‘˜å¤šçº§å®¡æ ¸ï¼Œæœ€åè‡ªå·±æ‰§è¡Œè½åº“ã€‚  ä¸‹é¢åˆ—å‡ºæ”¯æŒçš„ä¸»è¦åŠŸèƒ½:\nYearning Feature  SQLæŸ¥è¯¢  æŸ¥è¯¢å·¥å• å¯¼å‡º è‡ªåŠ¨è¡¥å…¨ï¼Œæ™ºèƒ½æç¤º æŸ¥è¯¢è¯­å¥å®¡è®¡   SQLå®¡æ ¸  æµç¨‹åŒ–å·¥å• SQLè¯­å¥æ£€æµ‹ä¸æ‰§è¡Œ SQLå›æ»š å†å²å®¡æ ¸è®°å½•   æ¨é€  E-mailå·¥å•æ¨é€ é’‰é’‰webhookæœºå™¨äººå·¥å•æ¨é€   ç”¨æˆ·æƒé™åŠç®¡ç†  è§’è‰²åˆ’åˆ† åŸºäºç”¨æˆ·çš„ç»†ç²’åº¦æƒé™ æ³¨å†Œ   å…¶ä»–  todoList LDAPç™»å½• åŠ¨æ€å®¡æ ¸è§„åˆ™é…ç½®   AutoTaskè‡ªåŠ¨æ‰§è¡Œ  ä½“éªŒ Yearningçš„å®‰è£…ååˆ†ç®€å•ï¼Œå®ƒä¾èµ–ä¸€ä¸ªmysqlæ•°æ®åº“ç”¨äºå­˜å‚¨å·¥å•çš„æ•°æ®ã€å›æ»šçš„SQLè¯­å¥ï¼Œæ‰€ä»¥éœ€è¦å…ˆåˆå§‹åŒ–æ•°æ®åº“-mï¼Œç„¶ååœ¨å¯åŠ¨-sã€‚å¯¹äºå›æ»šçš„è¯­å¥ä¸å¾—ä¸è¯´ä¸€ä¸‹ï¼ŒçœŸçš„è¦æ˜¯æ¶‰åŠåˆ°å¤§å˜æ›´çš„æ“ä½œçš„æ—¶å€™ï¼Œè¿˜æ˜¯å»ºè®®æ‰‹åŠ¨æˆ–è€…å¯é åœ°å¤‡ä»½æ–¹å¼è¿›è¡Œã€‚å®˜æ–¹ä¹Ÿæä¾›äº†å®‰è£…æ‰‹å†Œï¼Œä¸€èˆ¬å»ºè®®å®¹å™¨åŒ–éƒ¨ç½²ï¼Œæ–¹ä¾¿çœäº‹ï¼Œå®‰è£…åŒ…å†…ä¹Ÿæœ‰Dockerfileï¼ŒäºŒæ¬¡å¼€å‘çš„åŒå­¦ä¹Ÿå¯ä»¥è‡ªå·±æ„å»ºå‘å¸ƒã€‚\nåœ¨éœ€è¦é…ç½®é’‰é’‰æˆ–è€…å¾®ä¿¡çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡é€‰é¡¹è®¾ç½®é€šçŸ¥æ—¶æ˜¾ç¤ºYearningçš„å¹³å°åœ°å€\nä¸‹é¢æ˜¯é…ç½®é’‰é’‰å’ŒOpenLDAPç™»å½•çš„å‚è€ƒ:\næ— é—¨æ§›é¢†å–DNSPOD/è…¾è®¯çš„åŸŸåæ³¨å†Œ5å…ƒåˆ¸\n","description":"Yearningå¸®ä½ å‡å°æ—¥å¸¸å˜æ›´æ•°æ®åº“çš„é£é™©ï¼Œè§„èŒƒæœ‰åºè®°å½•è¿›è¡Œæ•°æ®åº“å˜æ›´æ“ä½œ","id":10,"section":"posts","tags":["yearning","mysql","Database"],"title":"Yearningç›®å‰æœ€æµè¡Œçš„å¼€æºæ•°æ®åº“å®¡æ ¸å¹³å°","uri":"https://linuxermaster.github.io/en/posts/20200625-sql%E5%AE%A1%E6%A0%B8%E5%BC%80%E6%BA%90%E7%A5%9E%E5%A5%87yearning/"},{"content":"æœ€è¿‘æœ‰å¾ˆå¤šæœ‹å‹çœ‹äº†æˆ‘çš„æ–‡ç« ä¹‹åï¼Œé—®æˆ‘ä½ ç»ˆç«¯æ˜¯æ€ä¹ˆè®¾ç½®çš„ï¼Œä¸ºä»€ä¹ˆå¦‚æ­¤ç‚«é…·ï¼Œè¿™è¿™è¿™\u0026hellip;è®©æˆ‘æ€ä¹ˆè¯´ï¼Œéš¾é“æˆ‘çš„æ–‡ç« ä¸å¹²å—ï¼Ÿè¿˜æ˜¯ç‰¹å¹²çœ‹ä¸ä¸‹å»äº†ï¼Ÿå¥½å§ï¼Œä»Šå¤©è¶ç€å‘¨æœ«ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œå¦‚ä½•è®¾ç½®ä¸€ä¸ªä½ è®¤ä¸ºå¾ˆé«˜å¤§ä¸Šçš„ç»ˆç«¯ï¼Œå¯¹äºå¸¸ç”¨ç»ˆç«¯çš„å‘çƒ§å‹æ¥è¯´æ— ç–‘æ˜¯ä¸€ç¯‡å€¼å¾—æ”¶è—çš„å¥½æ–‡ç« ï¼Œå“ˆå“ˆ\næƒ³è¦é…ç½®è¿™ä¹ˆé«˜å¤§ä¸Šçš„ç»ˆç«¯ï¼Ÿä½ éœ€è¦å®‰è£…ä¸€ä¸ªå«åšItermçš„è¿œç¨‹è¿æ¥å·¥å…·ï¼Œå®˜æ–¹è¯´æ˜¯macOS Terminal Replacementï¼Œå¯¹çš„ï¼Œä½ çš„ç”µè„‘å¿…é¡»æ˜¯Macosç³»ç»Ÿæ‰å¯ä»¥ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ä¸€æ­¥ä¸€æ­¥çš„æ•™ä½ å¦‚ä½•é…ç½®ä¸€ä¸ªä»¤ä½ å¿ƒä»ªçš„itermï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦æŒæ¡ä¸€ä¸‹åŸºç¡€çš„ä¸œè¥¿ï¼Œç„¶ååœ¨è‡ªå®šä¹‰ä¸€äº›å–œæ¬¢çš„ä¸œè¥¿ã€‚\nå‰æœŸå‡†å¤‡ å®‰è£…Iterm2 åœ¨å®˜ç½‘ä¸‹è½½å¥½iterm2çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç„¶åç›´æ¥æ‰˜æ”¾åˆ°Macosç³»ç»Ÿçš„Applicationçš„æ–‡ä»¶å¤¹å†…ï¼Œç„¶åä½ å°±å¯ä»¥åœ¨å¯åŠ¨å°``launché‡Œé¢æ‰¾åˆ°Itermäº†ã€‚å®‰è£…å®Œæˆä¹‹åï¼Œæ‰“å¼€è½¯ä»¶ï¼Œä»¥ä¸‹çš„æ“ä½œå‡åœ¨iterm2ä¸Šæ“ä½œ`ã€‚\né…ç½®oh-my-zsh ç°åœ¨æˆ‘ä»¬å°±éœ€è¦é…ç½®ä¸€ä¸ªç¥åŠ©å·¥å…·oh-my-zshæ¥è®©ä½ çš„Iterm2èµ·é£ï¼Œæœ€å¼€å§‹çš„æ—¶å€™ï¼Œä½ çš„itermæ˜¯è¿™æ ·çš„\nä¸‹é¢ï¼Œæˆ‘ä»¬ä¿®æ”¹é»˜è®¤çš„bashä¸ºzshï¼Œè¿™é‡Œè¦æ³¨æ„çš„æ˜¯ï¼ŒåæœŸéœ€è¦åšä¸€äº›å‘½ä»¤åˆ«å,ç¯å¢ƒå˜é‡çš„æ—¶å€™ï¼Œå°±ä¸å†æ˜¯ä»¥å‰çš„bashrcç­‰äº†ï¼Œåº”æ˜¯~/.zshrcæˆ–è€…/etc/zshrcå•¦ã€‚\n1 2  brew install zsh # å®‰è£…zsh chsh -s /bin/zsh   å¦‚æœä½ æƒ³è¦ä¿®æ”¹å›æ¥\n1  chsh -s /bin/bash   ä¿®æ”¹ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡wgetæˆ–è€…curlçš„æ–¹å¼ä¸‹è½½oh-my-zshï¼Œä»¥ä¸‹å®‰è£…æ–¹å¼é€‰æ‹©ä»»æ„ä¸€ç§å³å¯:\n curlæ–¹å¼  1  $ sh -c \u0026#34;$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\u0026#34;    wgetæ–¹å¼  1  $ sh -c \u0026#34;$(wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -)\u0026#34;   æ‰§è¡Œå®Œä¹‹åï¼Œå°±å¦‚ä¸‹æ‰€ç¤º:\nå®é™…ä¸Šï¼Œå°±æ˜¯é€šè¿‡curlæˆ–è€…wgetçš„æ–¹å¼å°†oh-my-zshçš„ä»£ç ä»“åº“å…‹éš†åˆ°ä½ çš„å®¶ç›®å½•ä¸‹/Users/marionxue/.oh-my-zshä¸‹\næä¾›å­—ä½“æ”¯æŒ æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å®‰è£…ä¸€äº›å­—ä½“ï¼Œè¿™äº›å­—ä½“æä¾›äº†æŸäº›oh-my-zshä¸»é¢˜çš„ç‰¹æ®Šå­—ç¬¦çš„æ”¯æŒï¼Œåœ¨ç¾åŒ–é…ç½®ä¸Šæ˜¯å¿…ä¸å¯å°‘çš„ã€‚\n1 2 3 4 5 6 7 8 9  git clone https://github.com/powerline/fonts.git --depth=1 # clone git clone https://github.com/powerline/fonts.git --depth=1 # install cd fonts ./install.sh # clean-up a bit cd .. rm -rf fonts   å®‰è£…å¥½ä¹‹åï¼Œé€‰æ‹©ä¸€æ¬¾Powerlineå­—ä½“äº†ï¼šiterm2 -\u0026gt; Preferences -\u0026gt; Profiles -\u0026gt; Text -\u0026gt; Font -\u0026gt; Change Fontï¼ˆæˆ‘ç”¨çš„æ˜¯nerd-fontså› ä¸ºè¯¥å­—ä½“æ”¯æŒé ASCII ç å­—ä½“ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰,å½“ä½ çš„ç»ˆç«¯åœ¨é…ç½®ä¸»é¢˜ä¹‹åï¼Œå‡ºç°äº†ä¹±ç ï¼Œé‚£ä¹ˆä½ çš„å­—ä½“ä¸€å®šæ˜¯æ²¡æœ‰é€‰å¯¹ï¼Œè¿™é‡Œéœ€è¦ä½¿ç”¨powerlineç³»åˆ—çš„å­—ä½“ï¼Œè¿™æ˜¯éœ€è¦æ³¨æ„çš„åœ°æ–¹ã€‚å¦‚æœä½ éœ€è¦å®‰è£…nerd-fonts,ç›´æ¥ä½¿ç”¨brewå³å¯\n1 2  brew tap caskroom/fonts brew cask install font-hack-nerd-font   ç¾åŒ–iterm2 ä¸€äº›ç‰¹åˆ«å¸å¼•çœ¼çƒçš„ç¾åŒ–è®¾ç½®éƒ½æ˜¯é€šè¿‡åœ¨ä¸»é¢˜çš„åŸºç¡€ä¸Šè‡ªå®šä¹‰ä¿®æ”¹å®ç°çš„ï¼Œé»˜è®¤çš„oh-my-zshä½¿ç”¨çš„ä¸»é¢˜æ˜¯ZSH_THEME=\u0026quot;robbyrussell\u0026quot;ï¼Œä¸ªäººå¹¶ä¸å¥½çœ‹ï¼Œä¸‹é¢æˆ‘ä»¬è‡ªå·±é€‰æ‹©ä¸€ä¸ªåˆé€‚çš„ä¸»é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨/Users/marionxue/.oh-my-zsh/themesä¸‹é¢æŸ¥çœ‹é»˜è®¤æä¾›çš„ä¸»é¢˜ã€‚è€Œé…ç½®æ–‡ä»¶å°±æ˜¯æˆ‘ä»¬ä¹‹å‰æåŠåˆ°çš„~/.zshrcæ–‡ä»¶ï¼Œ\næˆ‘ä»¬æ‰“å¼€è¯¥æ–‡ä»¶æ‰¾åˆ°ZSH_THEME=\u0026quot;robbyrussell\u0026quot;ï¼Œç„¶åä¿®æ”¹robbyrussellä¸ºä½ å–œæ¬¢çš„ä¸»é¢˜å³å¯ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯ZSH_THEME=\u0026quot;agnoster\u0026quot;ä¸è¿‡æˆ‘ä¹Ÿæ¨èè¿™ä¸ªä¸»é¢˜ã€‚è®°å¾—æ¯æ¬¡ä¿®æ”¹~/.zshrcæ–‡ä»¶ä¹‹åï¼Œéœ€è¦source ~/.zshrcè®©é…ç½®æ–‡ä»¶ç”Ÿæ•ˆï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹æ•ˆæœå›¾ï¼š\nä½†æ˜¯çœ‹èµ·æ¥æ¯”è¾ƒå•è°ƒï¼Œä¸æ˜¯é‚£ä¹ˆçš„é«˜å¤§ä¸Šå•Šï¼Œäºæ˜¯æœ‰äº›äººåœ¨ç½‘ä¸Šè‚¯å®šå‘ç°è¿‡ä»¥ä¸‹è¿™ç§æ ·å¼ï¼Œçœ‹èµ·æ¥ç›¸å¯¹æ¯”è¾ƒå®Œç¾ï¼Œç ”ç©¶ä¸€ä¸‹ä¸‹é¢è¿™ç§å›¾çš„åšæ³•ï¼š\nä»”ç»†è§‚å¯Ÿï¼Œå‘½ä»¤æç¤ºç¬¦å·¦ä¾§æ˜¾ç¤ºçš„æ˜¯gitçš„åˆ†æ”¯ï¼Œåä¾§æ˜¾ç¤ºçš„æ‰§è¡Œç»“æœçŠ¶æ€ã€æ‰§è¡Œå‘½ä»¤çš„æ•°é‡ä»¥åŠæ—¶é—´ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæµè¡Œçš„ç¬¬ä¸‰æ–¹ PowerLevel9k å¼€æºä¸»é¢˜ï¼Œæˆ‘ä»¬å°†å…¶ä¸‹è½½åˆ°~/.oh-my-zsh/custom/themesä¸‹ï¼Œè¯¦ç»†çš„é…ç½®è®¾ç½®å‚è€ƒgithubä¸Šçš„æ–‡æ¡£:\n1 2  cd ~/.oh-my-zsh/custom/themes https://github.com/bhilburn/powerlevel9k.git   ä¿®æ”¹é…ç½®æ–‡ä»¶ä¸­çš„ä¸»é¢˜è®¾ç½®ä¸º:\n1  ZSH_THEME=\u0026#34;powerlevel9k/powerlevel9k\u0026#34;   ç„¶åé…ç½®git,historyå’Œtimeï¼Œæˆ‘ä»¬åœ¨\n1 2  POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(context dir vcs) POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(status history time)   è¿™æ ·å°±å®Œæˆäº†ä¸Šå›¾çš„é…ç½®ã€‚å½“ç„¶ä½ å¯ä»¥è®¾ç½®ä¸€äº›å¸¦æœ‰iconçš„æ¨¡å¼æ¯”å¦‚:\n1  POWERLEVEL9K_MODE=\u0026#39;nerdfont-complete\u0026#39;   æ•ˆæœå¦‚ä¸‹:\nä½ ä¹Ÿå¯ä»¥è‡ªå·²å®šä¹‰ä¸€äº›èƒŒæ™¯é¢œè‰²ï¼Œä½ å¯ä»¥é€šè¿‡æ‰§è¡Œä¸€ä¸‹å‘½ä»¤è·å–é…è‰²\n1 2  spectrum_bls # æ˜¾ç¤ºå‰é…è‰² spectrum_ls # æ˜¾ç¤ºåé…è‰²   ç¾åŒ–è¿›é˜¶ è¿™é‡Œå°±æ˜¯ç¾åŒ–ç»ˆç«¯çš„åŸºæœ¬æ“ä½œï¼Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹å¦‚ä½•åœ¨åŸæœ‰çš„åŸºç¡€ä¸Šé…ç½®ä¸€ä¸‹è‡ªå·±å–œæ¬¢çš„iconå’Œæ’ä»¶ï¼š\nçº¢è‰²æ¡† çº¢è‰²æ¡†æ˜¯itermçš„èµ„æºçŠ¶æ€æ ï¼Œä½ å¯ä»¥åœ¨iterm2ä¸­ä½¿ç”¨å¿«æ·é”®command+,æˆ–è€…èœå•æ æ‰“å¼€é¦–é€‰é¡¹ï¼Œè¿›è¡Œè®¾ç½®ï¼Œåé¢å°±ä¸åœ¨èµ˜è¿°å¦‚ä½•å¸¦å¼€äº†ï¼Œ\nç‚¹å‡»configure status barå°†éœ€è¦çš„æ‰˜æ”¾åœ¨ä¸‹é¢æ—¢å¯\né’è‰²çš„ğŸ³ é’è‰²çš„ğŸ³æ˜¯ä¸€ä¸ªemoji.å¯ä»¥åˆ©ç”¨touchbarå¡«å……ä¸Šå»ï¼Œå¯ä»¥å†™æ–‡å­—\né»„è‰²çš„ç›®å½• è¿™é‡Œæ˜¯å®‰è£…çš„ä¸€äº›é«˜æ•ˆæ˜“ç”¨çš„æ’ä»¶\n git-open: ä¸€ä¸ªå¿«æ·å·¥å…·ï¼Œå½“ä½ cdåˆ°ä¸€ä¸ªç‰ˆæœ¬åŒ–çš„ä»£ç ä»“åº“ç›®å½•ä¸‹ï¼Œæ‰§è¡Œgit-openä¼šè‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨å¹¶è·³è½¬åˆ°è¯¥ä»£ç ä»“åº“åœ°å€ zsh-autosuggestions:è¿™æ˜¯ä¸€ä¸ªè‡ªåŠ¨æç¤ºä¹‹å‰æ‰§è¡Œè¿‡çš„å‘½ä»¤å†å² zsh-syntax-highlighting:è¿™æ˜¯ä¸€ä¸ªzshè¯­æ³•é«˜äº®çš„æ’ä»¶  è¿™äº›æ’ä»¶å®‰è£…é…ç½®ç®€å•ï¼Œåªéœ€è¦cloneå¯¹åº”çš„ä»£ç ä»“åº“åˆ°/Users/marionxue/.oh-my-zsh/custom/pluginsä¸‹ï¼Œç„¶ååœ¨.zshrcé…ç½®æ–‡ä»¶ä¸‹çš„pluginså¤„é…ç½®ä¸Šå³å¯ï¼Œæ³¨æ„æˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯agnosterä¸»é¢˜ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  cd ~/.oh-my-zsh/custom/plugins git clone https://github.com/paulirish/git-open git clone https://github.com/zsh-users/zsh-autosuggestions git clone https://github.com/zsh-users/zsh-syntax-highlighting vim ~/.zshrc plugins=( git zsh-syntax-highlighting zsh-autosuggestions git-open )   æœ€åæ˜¯é…ç½®ç”Ÿæ•ˆ\n1  source ~/.zshrc   è“è‰²æ¡†å†…çš„é…ç½® è¿™é‡Œæ˜¯é€šè¿‡agnosterä¸»é¢˜åŠ ä¸Šä¸€äº›è‡ªå·±ä¿®æ”¹çš„ä¸»é¢˜å®ç°çš„ã€‚ç„¶åç»“åˆ~/.zshrcé…ç½®å‘½ä»¤è¡Œæç¤ºç¬¦çš„æ˜¾ç¤ºï¼Œä½ å¯ä»¥åœ¨emojiç½‘ç«™1ï¼Œemojiç½‘ç«™2ä¸Šæ‰¾åˆ°å¯¹åº”çš„Bytes\nå…¶ä¸­çš„devclusterå’Œkube-opsæ˜¯æˆ‘çš„k8sé›†ç¾¤çš„é›†ç¾¤åä»¥åŠå¯¹åº”çš„å‘½åç©ºé—´ï¼Œè¿™é‡Œæ˜¯åˆ©ç”¨kubectxã€kube-ps1å®ç°çš„ï¼Œå…·ä½“çš„ä½ å¯ä»¥å‚è€ƒï¼Œä¸‹é¢æ˜¯æˆ‘çš„éƒ¨åˆ†é…ç½®æ–‡ä»¶\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  ZSH_THEME=\u0026#34;agnoster\u0026#34; DISABLE_AUTO_UPDATE=\u0026#34;true\u0026#34; DISABLE_UPDATE_PROMPT=\u0026#34;true\u0026#34; plugins=( git zsh-syntax-highlighting zsh-autosuggestions kubectl kube-ps1 git-open ) KUBE_PS1_SYMBOL_ENABLE=false KUBE_PS1_PREFIX=\u0026#34;\\u2638\\uFE0F \u0026#34; KUBE_PS1_SUFFIX=\u0026#34; \u0026#34; KUBE_PS1_DIVIDER=\u0026#34;\\xf0\\x9f\\x94\\xa5 \u0026#34; PS1=\u0026#39;$(kube_ps1)\u0026#39;$PS1   å¥½äº†ï¼Œåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œå¸Œæœ›ä½ èƒ½æœ‰æ‰€æ”¶è·~\n","description":"ä¸ºä»€ä¹ˆä½ çš„ç»ˆç«¯è¿™ä¹ˆç¾ä¸½","id":11,"section":"posts","tags":["iterm"],"title":"æ‰‹æŠŠæ‰‹å¸¦ä½ æ‰“é€ éªšæ°”çš„å‘½ä»¤è¡Œç»ˆç«¯","uri":"https://linuxermaster.github.io/en/posts/20200613-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%BD%A0%E7%9A%84%E7%BB%88%E7%AB%AF%E8%BF%99%E4%B9%88%E7%BE%8E%E4%B8%BD/"},{"content":"â€‹ æœ€è¿‘å‘ç°å¾ˆå¤šçš„å¾®ä¿¡æ–‡ç« ä¸Šå‡ºç°äº†ä¸€ç§logoè®¾è®¡ï¼Œè·ŸPç«™çš„logoè®¾è®¡é£æ ¼ä¸€æ ·è®©äººå°è±¡æ·±åˆ»ï¼Œé»‘åº•ç™½å­—ï¼Œé…ä¸Šä¸€å°æ’®æ©™è‰²ï¼Œç»™äººæå¼ºçš„å†²å‡»åŠ›ã€‚åæ¥æŸ¥äº†ä¸€ä¸‹åœ¨Githubä¸Šå‘ç°æœ‰ä¸€ä¸ªæœ‰æ„æ€çš„ç¨‹åºå‘˜å¼„çš„ä¸€ä¸ªåœ¨çº¿åˆ›æ„Logoç”Ÿæˆå™¨ï¼Œåˆ©ç”¨Logoly Proå¯ä»¥ç”Ÿæˆç±»ä¼¼YouTobeã€Pç«™ç­‰Logoé£æ ¼çš„æ ‡å¿—ã€‚åˆ†äº«ç»™å¤§å®¶ï¼Œäºæ˜¯å°±æœ‰äº†ä»Šå¤©è¿™ç¯‡æ–‡ç« ã€‚\nlogolyçš„ç”±æ¥ è¿™ä¸ªé£æ ¼çš„åˆ¶ä½œæ˜¯ç”±tencentçš„ä¸€ä½å¤§ç‰›å¼€å‘åˆ¶ä½œçš„ï¼Œå«åšç™½å®¦æˆ,è¿™é‡Œæ˜¯ä»–å¯¹äºè¿™ä¸ªç½‘é¡µç‰ˆå·¥å…·çš„è‡ªè¿°ï¼š\næˆ‘è‡ªå·±å¹³æ—¶ç»å¸¸è¦åšä¸€äº› Side Project ï¼Œåœ¨åš Side Project çš„æ—¶å€™ï¼Œå°±æ¶‰åŠåˆ°äº†è¦åš Logo ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªæ²¡æœ‰è®¾è®¡æ„Ÿçš„ç¨‹åºå‘˜ï¼Œåœ¨åš Logo æ—¶æ€»æ˜¯ä¼šåšå‡ºä¸€äº›å¾ˆä¸‘çš„ Logo ï¼Œäºæ˜¯ç—›å®šæ€ç—›ï¼Œæƒ³æƒ³æœ‰æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ç”Ÿæˆå¥½çœ‹çš„ Logoã€‚å¯¹äºæˆ‘æ¥è¯´ï¼Œä¹Ÿä¸éœ€è¦å¤ªè¿‡å¤æ‚ï¼Œèƒ½å¤Ÿæ»¡è¶³æˆ‘è‡ªå·±çš„è¦æ±‚å°±è¡Œã€‚\nPç«™Logoé£æ ¼å›¾ç‰‡ç´ æåˆ¶ä½œçš„å®˜æ–¹ç½‘ç«™ï¼šhttps://logoly.pro/ ä»£ç ä»“åº“é‡Œé¢æ˜¯è¿™æ ·æè¿°çš„ï¼Œâ€ä¸€ä¸ªç®€å•çš„åœ¨çº¿å¾½æ ‡ç”Ÿæˆå™¨ï¼Œé€‚åˆæƒ³è¦è½»æ¾è®¾è®¡å¾½æ ‡çš„äººä»¬\u0026rdquo;ã€‚\nlogolyçš„åŠŸèƒ½å’Œç‰¹è‰²  ç”ŸæˆPç«™é£æ ¼çš„logo æ”¯æŒå¯¼å‡ºpngæ ¼å¼çš„å›¾ç‰‡ æ”¯æŒä¿®æ”¹å‰ç¼€/åç¼€/èƒŒæ™¯çš„é¢œè‰² æ”¯æŒè®¾ç½®å­—ä½“çš„å¤§å° æ”¯æŒè‡ªå®šä¹‰å­—ä½“TODOï¼Œå¯èƒ½æ˜¯ä¸ºäº†é˜²æ­¢ä¾µæƒï¼Œé¿å…ä½¿ç”¨ä¸€äº›æœªå¼€æºçš„å­—ä½“  logolyçš„ä½¿ç”¨æ–¹æ³•  æ‰“å¼€logolyç½‘ç«™: https://logoly.pro/s åœ¨æ–‡æœ¬æ¡†å†…è¾“å…¥éœ€è¦çš„æ–‡æœ¬ ä¿®æ”¹ä½ éœ€è¦çš„é¢œè‰²å’Œå­—ä½“çš„å¤§å° ç‚¹å‡»å¯¼å‡ºå³å¯ä¸‹è½½pngæ ¼å¼çš„å›¾ç‰‡ è¿˜æ˜¯ä¸å¤ªæ‡‚å¾—ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹å“”å“©å“”å“©Bç«™ä¸Šåˆ«äººå‘çš„æ–‡ç« ï¼Œæˆ–è€…å°±æ”¾å¼ƒä½¿ç”¨å§ï¼  ","description":"ä¸€ä¸ªå¿«é€Ÿç”ŸæˆPç«™é£æ ¼çš„åœ¨çº¿å·¥å…·","id":12,"section":"posts","tags":["logo","logoly","å·¥å…·"],"title":"Pç«™é£æ ¼Logoç”Ÿæˆå™¨","uri":"https://linuxermaster.github.io/en/posts/20200607-p%E7%AB%99%E9%A3%8E%E6%A0%BClogo%E7%94%9F%E6%88%90%E5%99%A8/"},{"content":"åˆ†äº«ä¸€ä¸ªä½¿ç”¨Goç¼–å†™çš„æç®€å•çš„Demoæ¡ˆä¾‹ï¼Œä¸ºä»€ä¹ˆè¦åˆ†äº«å‘¢ï¼Ÿæ¶‰åŠåˆ°å‡ ä¸ªå°çŸ¥è¯†ç‚¹\n Go modçš„ä½¿ç”¨ GOä¸­å¦‚ä½•å¯¼å…¥åŒ… é€šè¿‡Goç®€å•çš„æ¼”ç¤ºåˆ†å±‚æ„å»º æ¼”ç¤ºå¦‚ä½•ç¼–å†™ä¸€ä¸ªè‡ªåŠ¨åŒ–æ„å»ºçš„è„šæœ¬å¼Jenkinfile.  1. Go modå¦‚ä½•ä½¿ç”¨ æˆ‘ä»¬å‡†å¤‡ä¸€ä¸ªapisæ¨¡å—ï¼Œåœ¨è¯¥æ¨¡å—ä¸­å®ç°ä¸€ä¸ªæ‰“å°å­—ç¬¦ä¸²çš„å‡½æ•°Says(str string):æ‰€ä»¥\n1 2 3 4 5 6 7 8 9  mkdir apis cat \u0026lt;\u0026lt; EOF \u0026gt; ./apis.go package apis import \u0026#34;fmt\u0026#34; func Says(str string) { fmt.Printf(\u0026#34;hello,%s\u0026#34;, name) }   ç„¶åæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸‹go mod\n1 2 3 4 5 6 7  go env -w GO111MODULE=\u0026#34;auto\u0026#34; go mod init code.kubemaster.top/DevOpsTeam/apis # æ­¤æ—¶æŸ¥çœ‹ä¸€ä¸‹modæ–‡ä»¶çš„å†…å®¹ä¸º: cat go.mod module code.kubemaster.top/DevOpsTeam/apis go 1.14   ç„¶åå·¥ä½œåŒºå†…ç”Ÿæˆä¸€ä¸ªgo.modæ–‡ä»¶\nç„¶åæˆ‘ä»¬åˆå§‹åŒ–æäº¤åˆ°ä»£ç ä»“åº“ä¸­å³å¯,ä»£ç ä»“åº“çš„åœ°å€ä¸ºhttps://code.kubemaster.top/DevOpsTeam/apis.gitï¼Œ\n2. å¦‚ä½•å¯¼å…¥åŒ… æ¥ä¸‹æ¥åº”è¯¥ç¼–å†™Demoäº†ï¼ŒDemoä¾èµ–apisæ¨¡å—å®ç°åŠŸèƒ½ï¼ŒDemoçš„æ–‡ä»¶åä¸ºmain.go:\n1 2 3 4 5 6 7  package main import \u0026#34;code.kubemaster.top/DevOpsTeam/apis\u0026#34; func main() { apis.Says(\u0026#34;äº‘åŸç”ŸÂ·ç”Ÿæ€åœˆ\\n\u0026#34;) }   è¿™é‡Œæœ‰ä¸ªæ³¨æ„çš„åœ°æ–¹:\nå½“ç¨‹åºè°ƒç”¨çš„æ¨¡å—ä¸æ¨¡å—çš„æ–‡ä»¶åä¸ä¸€è‡´çš„æ—¶å€™ï¼Œéœ€è¦é€šè¿‡åˆ«åå¼•å…¥ï¼Œå¦åˆ™ç›´æ¥importå³å¯ï¼š\n1 2  # å®é™…ä¸Šæ¨¡å—åä¸ºapis,ä½†æ˜¯æ­¤å¤„æ–‡ä»¶åæ˜¯api,æ‰€ä»¥éœ€è¦é€šè¿‡åˆ«åè§£å†³ import m_api \u0026#34;code.kubemaster.top/DevOpsTeam/api\u0026#34;   å½“éœ€è¦è¿è¡Œå’Œæ„å»ºmain.goçš„æ—¶å€™:\n1 2  go get -insecure code.kubemaster.top/DevOpsTeam/apis go run main.go   åˆ°è¿™é‡ŒåŸºæœ¬ä¸Šå°±æ˜ç¡®go modçš„åŸºç¡€ä½¿ç”¨äº†,ç„¶åæˆ‘ä»¬å°†å…¶æäº¤ä»£ç åˆ°ä»£ç ä»“åº“ï¼šhttps://code.kubemaster.top/DevOpsTeam/goci.gitã€‚\n3. åº”è¯¥æ€æ ·æ„å»ºGoç¨‹åº ä½¿ç”¨Dockeræ„å»ºé•œåƒï¼Œé¦–å…ˆè¦å‡†å¤‡ä¸€ä¸ªDockerfile,ä»”ç»†æ€è€ƒä¸€ä¸‹ï¼ŒGoç¼–å†™çš„ç¨‹åºä¼šç›´æ¥ç¼–è¯‘æˆæŒ‡å®šç¼–è¯‘æ¶æ„çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ†å±‚æ„å»ºçš„æ–¹å¼é¦–å…ˆåœ¨Goçš„ç¯å¢ƒä¸­è¿›è¡Œæ„å»ºï¼Œå†æŠŠæ„å»ºåçš„äºŒè¿›åˆ¶æ–‡ä»¶æ‹·è´åˆ°å¾®å°é•œåƒå†…ï¼Œä»¥ä¾¿å‡å°é•œåƒçš„ä½“ç§¯,ä¸‹é¢å†™äº†ä¸€ä¸ªDockerfileçš„æ¡ˆä¾‹:\n1 2 3 4 5 6 7 8 9 10 11 12  FROMgolang:1.14asbuilderWORKDIR/go/src/code.kubemaster.top/DevOpsTeam/demos/ARGARCH=\u0026#34;amd64\u0026#34;ARGOS=\u0026#34;linux\u0026#34;COPYmain.go.RUNgoget-insecurecode.kubemaster.top/DevOpsTeam/apis\u0026amp;\u0026amp;\\CGO_ENABLED=0GOOS=linuxgobuild-a-installsuffixcgo-omain.FROMalpine:latestWORKDIR/root/COPY--from=builder/go/src/code.kubemaster.top/DevOpsTeam/demos/.CMD[\u0026#34;./main\u0026#34;]  åœ¨é•œåƒç¼–è¯‘åï¼Œé•œåƒçš„ä½“ç§¯ä¸º7.69M,åœ¨Dockerfileå‡†å¤‡å¥½ä¹‹åï¼Œæˆ‘ä»¬æŠŠDockerfileæäº¤åˆ°gociçš„ä»£ç ä»“åº“å†…ã€‚ä¸‹é¢æˆ‘ä»¬å°±å¯ä»¥é…ç½®ä¸€ä¸‹Jenkinsfileï¼Œä»¥ä¾¿äºæˆ‘ä»¬æŒç»­æ„å»ºäº†\n4. é€šè¿‡Jenkinsfileå®ç°æŒç»­æ„å»º è¿™é‡Œç®€å•çš„é€šè¿‡è„šæœ¬å¼pipelineå®ç°æœåŠ¡çš„æŒç»­æ„å»ºï¼Œå¾ˆç®€å•ï¼Œä½†ä¹Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„åŸºç¡€æ¡†æ¶:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40  pipeline{agentanyenvironment{registry=\u0026#34;registry-vpc.cn-beijing.aliyuncs.com/kubemaster/gocodecitestdemo\u0026#34;registryCredential=\u0026#39;854bfe2f-7923-48a5-9156-7be54cc38a88\u0026#39;}stages{stage(\u0026#39;Cloning Git\u0026#39;){steps{git\u0026#39;https://code.kubemaster.top/DevOpsTeam/goci.git\u0026#39;}}stage(\u0026#39;Building image\u0026#39;){steps{script{dockerImage=docker.buildregistry+\u0026#34;:$BUILD_NUMBER\u0026#34;}}}stage(\u0026#39;Testing Image\u0026#39;){steps{sh\u0026#34;docker run --rm $registry:$BUILD_NUMBER\u0026#34;}}stage(\u0026#39;Deploy Image\u0026#39;){steps{script{docker.withRegistry(\u0026#39;https://registry-vpc.cn-beijing.aliyuncs.com\u0026#39;,registryCredential){dockerImage.push()}}}}stage(\u0026#39;Remove Unused docker image\u0026#39;){steps{sh\u0026#34;docker rmi $registry:$BUILD_NUMBER\u0026#34;}}}}  åœ¨å®ŒæˆJenkinsfileçš„å‡†å¤‡å·¥ä½œåï¼Œä¾æ—§æäº¤åˆ°gociä»£ç ä»“åº“å†…ï¼Œç„¶åæˆ‘ä»¬åœ¨jenkinsä¸Šé…ç½®å³å¯:\né¦–å…ˆå‡†å¤‡Jenkins jobé…ç½®çš„xmlé…ç½®æ–‡ä»¶goci.xmlï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45  \u0026lt;?xml version=\u0026#39;1.1\u0026#39; encoding=\u0026#39;UTF-8\u0026#39;?\u0026gt; \u0026lt;flow-definition plugin=\u0026#34;workflow-job@2.36\u0026#34;\u0026gt; \u0026lt;actions\u0026gt; \u0026lt;org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobAction plugin=\u0026#34;pipeline-model-definition@1.5.0\u0026#34;/\u0026gt; \u0026lt;org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction plugin=\u0026#34;pipeline-model-definition@1.5.0\u0026#34;\u0026gt; \u0026lt;jobProperties/\u0026gt; \u0026lt;triggers/\u0026gt; \u0026lt;parameters/\u0026gt; \u0026lt;options/\u0026gt; \u0026lt;/org.jenkinsci.plugins.pipeline.modeldefinition.actions.DeclarativeJobPropertyTrackerAction\u0026gt; \u0026lt;/actions\u0026gt; \u0026lt;description\u0026gt;\u0026lt;/description\u0026gt; \u0026lt;keepDependencies\u0026gt;false\u0026lt;/keepDependencies\u0026gt; \u0026lt;properties\u0026gt; \u0026lt;com.dabsquared.gitlabjenkins.connection.GitLabConnectionProperty plugin=\u0026#34;gitlab-plugin@1.5.13\u0026#34;\u0026gt; \u0026lt;gitLabConnection\u0026gt;\u0026lt;/gitLabConnection\u0026gt; \u0026lt;/com.dabsquared.gitlabjenkins.connection.GitLabConnectionProperty\u0026gt; \u0026lt;org.jenkinsci.plugins.gitlablogo.GitlabLogoProperty plugin=\u0026#34;gitlab-logo@1.0.5\u0026#34;\u0026gt; \u0026lt;repositoryName\u0026gt;\u0026lt;/repositoryName\u0026gt; \u0026lt;/org.jenkinsci.plugins.gitlablogo.GitlabLogoProperty\u0026gt; \u0026lt;com.synopsys.arc.jenkinsci.plugins.jobrestrictions.jobs.JobRestrictionProperty plugin=\u0026#34;job-restrictions@0.8\u0026#34;/\u0026gt; \u0026lt;/properties\u0026gt; \u0026lt;definition class=\u0026#34;org.jenkinsci.plugins.workflow.cps.CpsScmFlowDefinition\u0026#34; plugin=\u0026#34;workflow-cps@2.78\u0026#34;\u0026gt; \u0026lt;scm class=\u0026#34;hudson.plugins.git.GitSCM\u0026#34; plugin=\u0026#34;git@4.1.1\u0026#34;\u0026gt; \u0026lt;configVersion\u0026gt;2\u0026lt;/configVersion\u0026gt; \u0026lt;userRemoteConfigs\u0026gt; \u0026lt;hudson.plugins.git.UserRemoteConfig\u0026gt; \u0026lt;url\u0026gt;https://code.kubemaster.top/DevOpsTeam/goci.git\u0026lt;/url\u0026gt; \u0026lt;credentialsId\u0026gt;73a21ee2-2cdb-4658-8f99-309a3b77f2d4\u0026lt;/credentialsId\u0026gt; \u0026lt;/hudson.plugins.git.UserRemoteConfig\u0026gt; \u0026lt;/userRemoteConfigs\u0026gt; \u0026lt;branches\u0026gt; \u0026lt;hudson.plugins.git.BranchSpec\u0026gt; \u0026lt;name\u0026gt;*/master\u0026lt;/name\u0026gt; \u0026lt;/hudson.plugins.git.BranchSpec\u0026gt; \u0026lt;/branches\u0026gt; \u0026lt;doGenerateSubmoduleConfigurations\u0026gt;false\u0026lt;/doGenerateSubmoduleConfigurations\u0026gt; \u0026lt;submoduleCfg class=\u0026#34;list\u0026#34;/\u0026gt; \u0026lt;extensions/\u0026gt; \u0026lt;/scm\u0026gt; \u0026lt;scriptPath\u0026gt;Jenkinsfile\u0026lt;/scriptPath\u0026gt; \u0026lt;lightweight\u0026gt;true\u0026lt;/lightweight\u0026gt; \u0026lt;/definition\u0026gt; \u0026lt;triggers/\u0026gt; \u0026lt;disabled\u0026gt;false\u0026lt;/disabled\u0026gt;   ç„¶åï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºæ„å»ºjobå’Œæ‰§è¡Œè§¦å‘æ„å»ºäº†:\n1 2 3 4 5 6  # è·å–jenkins-crumb crumb=$(curl -u \u0026#34;admin:admin\u0026#34; -s \u0026#39;http://jenkins.kubemaster.top/crumbIssuer/api/xml?xpath=concat(//crumbRequestField,\u0026#34;:\u0026#34;,//crumb)\u0026#39;) # åˆ›å»ºjob curl -X POST \u0026#34;http://admin:admin@jenkins.kubemaster.top/createItem?name=goci\u0026#34; --data-binary \u0026#34;@goci.xml\u0026#34; -H \u0026#34;Content-Type: text/xml\u0026#34; -H ${jenkins_crumb} # æ‰§è¡Œjob curl -X POST -u admin:admin -H ${jenkins_crumb} http://jenkins.kubemaster.top/job/goci/build   çœ‹åˆ°è¿™é‡Œï¼ŒåŸºæœ¬ä¸Šå°±ç»“æŸäº†ï¼ŒåŸºæœ¬ä¸Šåœ¨å®è·µä¸­å®Œæˆäº†Demoçš„ç¼–å†™ï¼Œå®¹å™¨åŒ–æ„å»ºï¼ŒæŒç»­æ„å»ºç›¸å…³ç¯èŠ‚ï¼Œä¸‹é¢æˆ‘ä»¬çœ‹ä¸€ä¸‹æ„å»ºçš„ç»“æœï¼š\næ„å»ºçš„è§†å›¾:\nå®Œæˆçš„æ„å»ºçš„æ—¥å¿—:\n","description":"åˆ†äº«ä¸€ä¸ªä½¿ç”¨`Go`ç¼–å†™çš„æç®€å•çš„Demoæ¡ˆä¾‹","id":13,"section":"posts","tags":["go","jenkins","æŒç»­é›†æˆ"],"title":"Goè¯­è¨€é€šè¿‡Jenkinså®ç°CICD","uri":"https://linuxermaster.github.io/en/posts/20200606-go%E8%AF%AD%E8%A8%80%E9%80%9A%E8%BF%87jenkins%E5%AE%9E%E7%8E%B0cicd/"},{"content":"åœ¨å¾®æœåŠ¡ä½“ç³»çš„å»ºè®¾ä¸­ï¼Œå•ä½“æœåŠ¡çš„æ‹†åˆ†ä½¿å¾®æœåŠ¡å˜å¾—è¶Šæ¥è¶Šå¤šï¼ŒæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¹Ÿè¶Šæ¥è¶Šå¤æ‚ï¼Œéœ€è¦è§£å†³é…ç½®é›†ä¸­ç®¡ç†ã€é…ç½®å˜æ›´åçš„è‡ªåŠ¨åˆ·æ–°æˆ–è€…é‡è½½ç”šè‡³éœ€è¦å®ç°åŠ¨æ€é…ç½®ã€‚åŠ¨æ€é…ç½®æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæˆ‘æƒ³æ¥è§¦è¿‡Traefikå’ŒGitlab Runnerçš„åŒå­¦åº”è¯¥éƒ½ä¼šæœ‰æ„Ÿè§¦ï¼Œè™½ç„¶å®ç°çš„åŸç†æœ‰äº›ä¸ä¸€æ ·ï¼Œä½†æ˜¯éƒ½è¾¾åˆ°ä¸€ç§æ— é¡»è®¤ä¸ºè¿‡å¤šå¹²é¢„å³å®ç°æœåŠ¡çš„é‡è½½ç”Ÿæ•ˆã€‚\næˆ‘ä»¬æœ¬æ–‡ä¼šé€šè¿‡consulã€consul-templateã€registratorå’ŒDockerç­‰æ¨¡æ‹Ÿä¸€ä¸ªä½¿ç”¨consulä½œä¸ºæœåŠ¡å‘ç°ï¼ŒåŠ¨æ€æ¸²æŸ“nginxçš„é…ç½®æ–‡ä»¶å®ç°upstreamæœåŠ¡å¥åº·çŠ¶æ€æ£€æŸ¥åè‡ªåŠ¨çš„æ³¨å†Œä¸ä¸‹çº¿ã€‚\né¦–é€‰ä»‹ç»ä¸€ä¸‹è¿™ä¸ªå·¥å…·çš„ä½œç”¨ï¼š\nconsulï¼šæ˜¯ä¸€æ¬¾æœåŠ¡é…ç½®å’Œå‘ç°å·¥å…·ï¼Œåˆ†å¸ƒå¼çš„ã€é«˜å¯ç”¨çš„ä»¥åŠæå…·æ‰©å±•æ€§ã€‚\nconsul-template:æ˜¯ä¸€ä¸ªä»consulä¸­è·å–k/vä¿¡æ¯ï¼Œç„¶åå°†å€¼vå¡«å……åˆ°åŸºäºgo templateè¯­æ³•çš„æ–‡ä»¶ä¸­ã€‚\nregistratorï¼šæ˜¯ä¸€ä¸ªä¸docker.socké€šä¿¡ï¼Œå°†runningç€çš„Docker containerè‡ªåŠ¨çš„æ³¨å†Œåˆ°consulçš„ä¸€ä¸ªæœåŠ¡æ³¨å†Œå·¥å…·\nä¸‹é¢é€šè¿‡ä¸€ä¸ªå®é™…çš„ä¾‹å­æ¥æ¢ç´¢consulä¸consul-templateç»“åˆè§£å†³é‚£äº›å¾®æœåŠ¡æ¨¡å¼ä¸‹åŠ¨æ€å‘ç°ã€è‡ªåŠ¨åˆ·æ–°çš„é—®é¢˜ã€‚\né¦–å…ˆé€šè¿‡dockerè¿è¡Œä¸€ä¸ªconsulèŠ‚ç‚¹ï¼Œç”¨äºè®°å½•registratorå‘ç°çš„å®¹å™¨ä¿¡æ¯:\n1 2 3 4 5 6 7 8 9 10 11 12 13  docker run -d --name=consul --restart=always \\  -e \u0026#39;CONSUL_LOCAL_CONFIG={\u0026#34;skip_leave_on_interrupt\u0026#34;: true, \u0026#34;ui\u0026#34;: true, \u0026#34;dns_config\u0026#34;: { \u0026#34;allow_stale\u0026#34;: false }}\u0026#39; \\  -p 8300:8300 \\  -p 8301:8301 \\  -p 8301:8301/udp \\  -p 8302:8302/udp \\  -p 8302:8302 \\  -p 8400:8400 \\  -p 8500:8500 \\  -p 8600:8600 \\  -h node1 \\  consul agent -server -bind=192.168.99.129 -bootstrap-expect=1 -node=node1 \\  -client 0.0.0.0 -ui   ","description":"å­¦ä¹ Consulçš„åŸºç¡€çŸ¥è¯†","id":14,"section":"posts","tags":["æœåŠ¡å‘ç°","åˆ†å¸ƒå¼","consul"],"title":"Consulåœ¨å¾®æœåŠ¡ä¸­çš„è§’è‰²","uri":"https://linuxermaster.github.io/en/posts/20200605-consul%E5%9C%A8%E5%BE%AE%E6%9C%8D%E5%8A%A1%E7%9A%84%E8%A7%92%E8%89%B2/"},{"content":"äº†è§£è¿‡Traefik,nginx-ingressçš„åŒå­¦éƒ½çŸ¥é“ä»–ä»¬çš„å®˜æ–¹æ–‡æ¡£éƒ½æ˜¯åŸºäºmkdocså’Œmaterialä¸»é¢˜åˆ¶ä½œè€Œæˆï¼Œä½ è§‰å¾—è¿™ç§æ–‡æ¡£åº“æ€ä¹ˆæ ·ï¼Ÿæœ‰æ²¡æœ‰å¿ƒåŠ¨æŠŠè‡ªå·±çš„æ–‡æ¡£ä¹Ÿæ•´æˆé‚£æ ·çš„ï¼Ÿï¼Œä¸‹é¢æˆ‘ä»¬ç›´æ¥åŠ¨æ‰‹å¹²èµ·æ¥å§ã€‚\né…ç½®pipå›½å†…çš„ä¸‹è½½æº\n1 2 3  â˜¸ï¸ devclusterğŸ”¥ kube-ops ~ î‚° ğŸ³ ğŸ‘‰ cat ./.pip/pip.conf [global] index-url = https://pypi.tuna.tsinghua.edu.cn/simple   å®‰è£…mkdocs\n1 2 3 4 5 6  â˜¸ï¸ devclusterğŸ”¥ kube-ops ~ î‚° ğŸ³ ğŸ‘‰ pip3 install mkdocs Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple Requirement already satisfied: mkdocs in /Library/Frameworks/Python.framework/Versions/3.8/lib/python3.8/site-packages (1.1.2) ... WARNING: You are using pip version 19.2.3, however version 20.1.1 is available. You should consider upgrading via the \u0026#39;pip install --upgrade pip\u0026#39; command.   åˆ›å»ºå¹¶è¿è¡Œä¸€ä¸ªæ–°çš„æ–‡æ¡£åº“\n1 2 3 4  â˜¸ï¸ devclusterğŸ”¥ kube-ops ~ î‚° ğŸ³ ğŸ‘‰ mkdocs new cloudnativecosystem â˜¸ï¸ devclusterğŸ”¥ kube-ops ~ î‚° ğŸ³ ğŸ‘‰ cd cloudnativecosystem â˜¸ï¸ devclusterğŸ”¥ kube-ops ~/cloudnativecosystem î‚° ğŸ³ ğŸ‘‰ ls docs mkdocs.yml   åˆ›å»ºä¸€ä¸ªæ–°çš„GITä»“åº“https://github.com/linuxermaster/cloudnativecosystem_mkdocs\né…ç½®é€šè¿‡SSHæ— å¯†è®¿é—®ä»£ç ä»“åº“\n1  ssh-keygen -t rsa -C \u0026#34;email@qq.com\u0026#34;   ç„¶åå°†å…¬é’¥æ‹·è´åˆ°GITHUBçš„SSH-KEYä¸­\næµ‹è¯•æœ¬åœ°æ˜¯å¦å¯ä»¥è¿œç¨‹è¿æ¥\n1 2  # ssh -T git@github.com Hi linuxermaster! You\u0026#39;ve successfully authenticated, but GitHub does not provide shell access.   ç„¶åéœ€è¦åœ¨cloudnativecosystemç›®å½•å†…åˆå§‹åŒ–.gitä»“åº“ï¼Œç„¶åæ·»åŠ è¿œç¨‹ä»“åº“åœ°å€\n1 2 3 4 5  cd cloudnativecosystem git init git remote add origin https://github.com/linuxermaster/cloudnativecosystem_mkdocs.git mkdocs build --clean # åˆ›å»ºç¼–è¯‘åçš„é™æ€é¡µé¢ä»¥åŠæ ·å¼æ–‡ä»¶ mkdocs gh-deploy --clean # pushåˆ°gh-deployåˆ†æ”¯ä¸‹   æ­¤æ—¶ï¼Œå³å¯é€šè¿‡https://linuxermaster.github.io/cloudnativecosystem_mkdocs/è®¿é—®\n1  httpstat https://linuxermaster.github.io/cloudnativecosystem_mkdocs/   ç°åœ¨å¼€å§‹ä¼˜åŒ–mkdocsä»¥åŠé…ç½®ä¸»é¢˜æ ·å¼äº†ï¼Œè¿™éƒ¨åˆ†å·¥ä½œéƒ½åœ¨mkdocs.ymlä¸­å®Œæˆ\n1 2 3 4 5 6 7 8 9 10 11  site_name:äº‘åŸç”Ÿç”Ÿæ€åœˆnav:- ä¸»é¡µ:\u0026#34;index.md\u0026#34;- å…³äº:\u0026#34;about.md\u0026#34;- è‡ªåŠ¨åŒ–:\u0026#34;devops.md\u0026#34;theme:materialrepo_url:https://github.com/linuxermaster/cloudnativecosystem_mkdocs.gitrepo_name:\u0026#34;Opening on Github\u0026#34;site_description:\u0026#34;è¿™æ˜¯ä¸€ä¸ªmkdocsçš„demoæµ‹è¯•çŸ¥è¯†åº“ç½‘ç«™\u0026#34;site_author:\u0026#34;Marionxue\u0026#34;copyright:\u0026#34;1994 - 2020\u0026#34;  å…¶ä¸­themeæŒ‡å®šçš„æ˜¯ä½ çš„ä¸»é¢˜ï¼Œè¿™ä¸ªä¸»é¢˜å°±æ˜¯æˆ‘ä»¬å¸¸è§åˆ°çš„traefik,nginx-ingressç­‰åœ¨ä½¿ç”¨çš„å®˜æ–¹æ–‡æ¡£çš„ä¸»é¢˜ï¼Œå¦‚æœä½¿ç”¨å®ƒï¼Œä½ å¯èƒ½è¿˜éœ€è¦é¢å¤–çš„å®‰è£…ä¸€ä¸‹\n1  pip3 install mkdocs-material   å®‰è£…ä¹‹åï¼Œæ‰§è¡Œmkdocs gh-deploy --cleanå³å¯è®¿é—®ç½‘ç«™çš„ä¸»é¢˜:\næ¯æ¬¡æ‰‹åŠ¨éƒ¨ç½²éƒ½æ˜¯æ¯”è¾ƒéº»çƒ¦çš„ï¼Œäºæ˜¯æˆ‘ä»¬åˆ©ç”¨æ°¸ä¹…å…è´¹çš„travisæ¥å¸®åŠ©è§£å†³è¿™ä¸ªé—®é¢˜:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  language:python# Set the build language to Pythonpython:3.6# Set the version of Python to usebranches:master# Set the branch to build frominstall:- pipinstallmkdocsmkdocs-materialpymdown-extensionspygments# Install the required dependenciesscript:true# Skip script (Don\u0026#39;t use this if one already exists)before_deploy:- mkdocsbuild--verbose--clean--strict# Build a local version of the docsdeploy:# Deploy documentation to Github in the gh_pages branchprovider:pagesskip_cleanup:truegithub_token:$GITHUB_API_KEYlocal_dir:siteon:branch:master  ç„¶åæˆ‘ä»¬ä½¿ç”¨GITHUBçš„è´¦å·ç™»å½•travis, åœ°å€æ˜¯:https://travis-ci.orgï¼Œåœ¨ç™»å½•è¿›å»ä¹‹åï¼Œæˆ‘ä»¬é€‰æ‹©åˆé€‚çš„å¯ç”¨CICD\nç„¶åç‚¹å‡»settingè¿›å…¥ä»“åº“çš„é…ç½®ç•Œé¢ï¼Œè®¾ç½®ä»¥ä¸‹ä¸‰ä¸ªç¯å¢ƒå˜é‡\nå…¶ä¸­,GITHUB_API_KEYæ˜¯ä»gitubä¸Šè·å–çš„Access Token,å‰©ä¸‹çš„ä¸¤ä¸ªæ˜¯ç”¨æˆ·åå’Œå¯†ç ã€‚å®Œæˆä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰‹åŠ¨çš„è§¦å‘ä»¥ä¸‹æ„å»º:\nç´§æ¥ç€ï¼Œæˆ‘ä»¬ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬çŸ¥é“æ„å»ºæ˜¯å¦å®Œæˆï¼Œæˆ‘ä»¬åœ¨README.mdæ–‡ä»¶ä¸Šæ·»åŠ äº†ä¸€ä¸ªæ„å»ºçš„çŠ¶æ€å±•ç¤º:\nå¤åˆ¶RESULTä¿¡æ¯åˆ°readme.mdä¸­ï¼Œå³å¯æ˜¾ç¤ºæ¯æ¬¡æ„å»ºçš„çŠ¶æ€ä¿¡æ¯:\næŸ¥çœ‹ä¸€ä¸‹æˆ‘ä»¬çš„æ„å»ºå†å²\n","description":"ä½¿ç”¨mkdocsæ„å»ºæ–‡æ¡£åº“å¹¶é€šè¿‡githubå’Œtraviså®ç°è‡ªåŠ¨æ„å»ºå’Œå‘å¸ƒ","id":15,"section":"posts","tags":["mkdocs","github","travis"],"title":"mkdocsè‡ªåŠ¨åŒ–éƒ¨ç½²çŸ¥è¯†åº“","uri":"https://linuxermaster.github.io/en/posts/20200604-mkdocs%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E7%9F%A5%E8%AF%86%E5%BA%93/"},{"content":"Horizontal Pod Autoscaler å¯ä»¥æ ¹æ® CPU åˆ©ç”¨ç‡è‡ªåŠ¨ä¼¸ç¼© replication controllerã€deployment å’Œ replica set ä¸­çš„Podæ•°é‡ï¼ˆé™¤äº† CPU åˆ©ç”¨ç‡ï¼‰ä¹Ÿå¯ä»¥ åŸºäºå…¶ä»–åº”ç¨‹åºæä¾›çš„åº¦é‡æŒ‡æ ‡custom metricsã€‚ pod è‡ªåŠ¨ç¼©æ”¾ä¸é€‚ç”¨äºæ— æ³•ç¼©æ”¾çš„å¯¹è±¡ï¼Œæ¯”å¦‚ DaemonSets\nPod æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©ç‰¹æ€§ç”± Kubernetes API èµ„æºå’Œæ§åˆ¶å™¨å®ç°ã€‚èµ„æºå†³å®šäº†æ§åˆ¶å™¨çš„è¡Œä¸ºã€‚ æ§åˆ¶å™¨ä¼šå‘¨æœŸæ€§çš„è·å–å¹³å‡ CPU åˆ©ç”¨ç‡ï¼Œå¹¶ä¸ç›®æ ‡å€¼ç›¸æ¯”è¾ƒåæ¥è°ƒæ•´ replication controller æˆ– deployment ä¸­çš„å‰¯æœ¬æ•°é‡ã€‚\né€šè¿‡å®é™…çš„ Demo å¼€ä½“éªŒä¸€ä¸‹HPAåŸºäºèµ„æºå®ç°çš„æ°´å¹³è‡ªåŠ¨ä¼¸ç¼©,ä¸ºäº†æ¼”ç¤º Horizontal Pod Autoscalerï¼Œæˆ‘ä»¬å°†ä½¿ç”¨tomcaté•œåƒä½œä¸ºæµ‹è¯•å¯¹è±¡ï¼Œä»¥ä¸‹ä¸ºé…ç½® tomcat çš„deploymentçš„é…ç½®æ¸…å•ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  apiVersion:apps/v1kind:Deploymentmetadata:name:dp-tomcatnamespace:learningspec:revisionHistoryLimit:15replicas:1selector:matchLabels:app:dp-tomcatmatchExpressions:- key:appoperator:Invalues:[dp-tomcat]template:metadata:labels:app:dp-tomcatspec:nodeSelector:kubernetes.io/hostname:dev-k8s-05.xsl.linkcontainers:- name:dp-tomcatimage:tomcat:9.0resources:limits:memory:\u0026#34;1024Mi\u0026#34;cpu:\u0026#34;500m\u0026#34;ports:- containerPort:8080name:web  ä¸Šé¢çš„ yaml è¯´æ˜ä¸€ä¸‹:\n è¿è¡Œäº†ä¸€ä¸ªå‰¯æœ¬æ•°ä¸º 3 çš„ deployment æš´éœ²å‡ºä¸€ä¸ªåä¸º nginxsvc çš„ service æŒ‡å®šäº†revisionHistoryLimitè¡¨ç¤ºä¿ç•™å†å²ç‰ˆæœ¬çš„ä¸ªæ•° å› ä¸ºè¦é€šè¿‡èµ„æºè´Ÿè½½æ¨¡æ‹Ÿ HPA åŠŸèƒ½çš„åœºæ™¯ï¼Œå¿…é¡»ä¾èµ– template ä¸­å¯¹ pod åšèµ„æºé™åˆ¶ é›†ç¾¤ç¯å¢ƒéœ€è¦å®‰è£… metrics-server,æ–¹ä¾¿è§‚å¯Ÿé›†ç¾¤èµ„æºè´Ÿè½½  1 2 3 4 5 6 7 8  âœ 00-template.resources.yaml git:(master) âœ— (â˜¸ kubernetes-admin@kubernetes:default) k get pods -n learning NAME READY STATUS RESTARTS AGE abcontainer-58c67cfb87-g4j8q 1/1 Running 0 25d dp-tomcat-5b4465b6bf-82llc 1/1 Running 0 125m dp-tomcat-5b4465b6bf-zsttg 1/1 Running 0 126m nginx-deployment-8558b4659-6dkmr 1/1 Running 0 17s nginx-deployment-8558b4659-v8fzf 1/1 Running 0 17s nginx-deployment-8558b4659-w5tlq 1/1 Running 0 8m56s   ç°åœ¨ï¼Œdp-tomcatæœåŠ¡å·²ç»è¿è¡Œï¼Œæˆ‘ä»¬å°†é€šè¿‡ å®šä¹‰ä¸€ä¸ª HPA èµ„æºå¯¹è±¡æ¥åˆ›å»º Horizontal Pod Autoscalerã€‚ ä»¥ä¸‹é…ç½®æ¸…å•å°†åˆ›å»ºä¸€ä¸ªHorizontal Pod Autoscalerç”¨äºæ§åˆ¶æˆ‘ä»¬ä¸Šä¸€æ­¥éª¤ä¸­åˆ›å»ºçš„ deploymentï¼Œä½¿ Pod çš„å‰¯æœ¬æ•°é‡åœ¨ç»´æŒåœ¨ 1 åˆ° 10 ä¹‹é—´ã€‚ å¤§è‡´æ¥è¯´ï¼ŒHPA å°†é€šè¿‡å¢åŠ æˆ–è€…å‡å°‘ Pod å‰¯æœ¬çš„æ•°é‡ï¼ˆé€šè¿‡ Deployment ï¼‰ä»¥ä¿æŒæ‰€æœ‰ Pod çš„å¹³å‡ CPU åˆ©ç”¨ç‡åœ¨ 50%ä»¥å†…\nå®šä¹‰ä¸€ä¸ª HPA èµ„æºå¯¹è±¡\n1 2 3 4 5 6 7 8 9 10 11 12 13  apiVersion: autoscaling/v1 kind: HorizontalPodAutoscaler metadata: name: dp-tomcat namespace: learning spec: minReplicas: 1 maxReplicas: 10 scaleTargetRef: kind: Deployment name: dp-tomcat apiVersion: apps/v1 targetCPUUtilizationPercentage: 10   æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡éƒ¨ç½²ä¸€ä¸ªå«æœ‰abå‘½ä»¤çš„httpdé•œåƒæ¥æ¨¡æ‹Ÿè´Ÿè½½\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  apiVersion: apps/v1 kind: Deployment metadata: name: abcontainer namespace: abcontainer spec: selector: matchLabels: app: abcontainer template: metadata: labels: app: abcontainer spec: containers: - name: abcontainer image: httpd ports: - containerPort: 80   åœ¨éƒ¨ç½²å®Œæˆ httpd ä¹‹åï¼Œè¿›å…¥åˆ° abcontainer é€šè¿‡ ab å¢åŠ è´Ÿè½½\n1  k exec abcontainer-58c67cfb87-g4j8q -n learning -it -- bash   ä½¿ç”¨abå‘½ä»¤è¿›è¡Œå‹åŠ›æµ‹è¯•\n1  ab -c 5000 -n 2000000 http://tomcat-svc:8080/   æŸ¥çœ‹ HPA èµ„æºå˜åŒ–\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE dp-tomcat Deployment/dp-tomcat 0%/10% 1 10 1 16m NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE dp-tomcat Deployment/dp-tomcat 98%/10% 1 10 1 18m # ä¸­æ–­abæµ‹è¯• NAME REFERENCE TARGETS MINPODS MAXPODS REPLICAS AGE dp-tomcat Deployment/dp-tomcat 36%/10% 1 10 10 19m # podsçš„å˜åŒ– NAME READY STATUS RESTARTS AGE abcontainer-58c67cfb87-g4j8q 1/1 Running 0 25d dp-tomcat-96b7b9f6f-54v84 0/1 Pending 0 13s dp-tomcat-96b7b9f6f-55hsf 0/1 ContainerCreating 0 13s dp-tomcat-96b7b9f6f-btbzr 0/1 ContainerCreating 0 13s dp-tomcat-96b7b9f6f-dpppj 0/1 ContainerCreating 0 13s dp-tomcat-96b7b9f6f-k4jqq 1/1 Running 0 12m dp-tomcat-96b7b9f6f-mxd4f 1/1 Running 0 28s dp-tomcat-96b7b9f6f-tjpj6 1/1 Running 0 28s dp-tomcat-96b7b9f6f-zztqm 1/1 Running 0 28s   é»˜è®¤æƒ…å†µä¸‹,å½“abæ¨¡æ‹Ÿå®Œæˆä¹‹åï¼Œå½“æµé‡å¼€å§‹ä¸‹é™ï¼Œ5 åˆ†é’Ÿå pod çš„æ•°é‡ä¼šæ…¢æ…¢æ¢å¤åˆ° replicas çš„å€¼ã€‚\næ›´å¤šç²¾å½©æ–‡ç«   å¾®è½¯Â·kubernetes å­¦ä¹ æŒ‡å— v3.0 Jenkins åœ¨ kubernetes ä¸Šçš„è½åœ°å®è·µ OpenTracing å’Œ Jaeger åœ¨ kubernetes çš„åº”ç”¨ kubernetes æ ¸å¿ƒç›‘æ§æ¡†æ¶ Metrics-server  ","description":"Horizontal Pod Autoscaleré€šè¿‡Podèµ„æºä½¿ç”¨æƒ…å†µè‡ªåŠ¨æ‰©å±•","id":16,"section":"posts","tags":["Kubernetes","HPA","ab","å‹æµ‹æµ‹è¯•"],"title":"Abå‹åŠ›æµ‹è¯•æ¨¡æ‹Ÿå®ç°Kubernetes Podæ°´å¹³è‡ªåŠ¨ä¼¸ç¼©","uri":"https://linuxermaster.github.io/en/posts/20200530-ab%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95%E6%A8%A1%E6%8B%9F%E5%AE%9E%E7%8E%B0kubernetes-pod%E6%B0%B4%E5%B9%B3%E8%87%AA%E5%8A%A8%E4%BC%B8%E7%BC%A9/"},{"content":"autojump autojump æ˜¯ä¸€æ¬¾éå¸¸æ–¹ä¾¿çš„å‘½ä»¤è¡Œä¸‹çš„ç›®å½•è·³è½¬å·¥å…·ï¼Œå®ƒèƒ½å¸®ä½ å¿«é€Ÿä»ç›®å½•è®¿é—®çš„å†å²è®°å½•ä¸­ç»Ÿè®¡å‡ºå„ä¸ªç›®å½•çš„è®¿é—®é¢‘æ¬¡å’Œæƒé‡ï¼Œè¿™æ ·ï¼Œå°±èƒ½æ–¹ä¾¿çš„è®©ä½ åœ¨å„ä¸ªç›®å½•ä¸­è¿…é€Ÿè·³è½¬äº†ã€‚åªè¦ä½ è®°å¾—ä¹‹å‰æŸä¸ªè®¿é—®è¿‡çš„ç›®å½•çš„å¤§æ¦‚åå­—ï¼Œé…åˆ autojumpï¼Œå°±èƒ½å¿«é€Ÿçš„è·³è½¬è¿‡å»ï¼Œå†ä¹Ÿä¸ç”¨æ‰“ä¸€é•¿ä¸²çš„ cd å‘½ä»¤äº†ã€‚ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š\nå®‰è£… 1 2 3 4 5  brew install autojump # å¤§å¤šæ•°macç³»ç»Ÿéƒ½ä¼šå®‰è£…zsh,å› æ­¤å½“å®‰è£…é…ç½®å¥½autojumpä¹‹åï¼Œéœ€è¦å°†ä»¥ä¸‹ä»£ç å†™å…¥åˆ°~/.zshrc [[ -s `brew --prefix`/etc/autojump.sh ]] \u0026amp;\u0026amp; . `brew --prefix`/etc/autojump.sh # æœ€ååœ¨sourceä¸€é source ~/.zshrc   tig Git å·²ç»æˆä¸ºæˆ‘ä»¬å¹³æ—¶ç»å¸¸ç”¨åˆ°çš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç†å·¥å…·ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ç”¨ git log å‘½ä»¤æ¥æŸ¥çœ‹ git æäº¤çš„å†å²è®°å½•ã€‚å¦‚æœä½ å·²ç»åŒå€¦äº† git log é‚£ç§åƒç¯‡ä¸€å¾‹çš„ç•Œé¢ï¼Œé‚£ä¹ˆ tig ç»å¯¹æ˜¯ä¸€ä¸ªä¸å¯é”™è¿‡çš„å‘½ä»¤è¡Œä¸‹æŸ¥çœ‹ git å†å²æäº¤è®°å½•çš„å·¥å…·\ntig çš„ç•Œé¢çœ‹èµ·æ¥æ¯”èµ· git log è¦é…·ç‚«ä¸å°‘ï¼Œè€Œä¸”ä½¿ç”¨èµ·æ¥ä¹ŸæŒºæ–¹ä¾¿ã€‚æ­¤å¤–ï¼Œtig çš„é»˜è®¤æŒ‰é”®ç»‘å®šè¿˜è·Ÿ Vim æ¯”è¾ƒç±»ä¼¼ï¼ŒçœŸæ˜¯ Vimer çš„ç¦éŸ³ã€‚\n1  brew install tig   git summary å¹³æ—¶æˆ‘ä»¬åœ¨å¤šäººåˆä½œå¼€å‘ä¸€ä¸ªé¡¹ç›®çš„æ—¶å€™ï¼Œæƒ³è¦å¤§è‡´äº†è§£ä¸€ä¸‹æ¯ä¸ªäººå¯¹è¿™ä¸ªé¡¹ç›®æäº¤çš„ commit æ•°é‡å’Œå¤§è‡´çš„è´¡çŒ®åº¦ï¼Œé‚£ä¹ˆ git summary è¿™ä¸ªå‘½ä»¤ç»å¯¹èƒ½æ»¡è¶³ä½ çš„è¦æ±‚\ngit summary é€šè¿‡å¯¹é¡¹ç›®ä¸­æ¯ä¸€ä¸ª commit çš„ç»Ÿè®¡ï¼Œèƒ½å¤§è‡´è®¡ç®—å‡ºæ¯ä¸ª contributor çš„æäº¤æ¬¡æ•°å’Œè´¡çŒ®ç™¾åˆ†æ¯”ã€‚è®©ä½ å¯¹è¿™ä¸ªé¡¹ç›®çš„è´¡çŒ®åº¦èƒ½ä¸€ç›®äº†ç„¶ã€‚\né»˜è®¤ git æ˜¯ä¸ä¼šå¸¦æœ‰è¿™ä¸ªå‘½ä»¤çš„ï¼Œéœ€è¦åœ¨ Mac OS ä¸‹é¢å¤–å®‰è£…ä¸€ä¸ªæ‰©å±•åŒ…ï¼š\n1  brew install git-extras   the_silver_searcher UNIX/Linux ç³»ç»Ÿæœ‰ä¸å°‘å¥½ç”¨çš„å·¥å…·ï¼Œç”¨äºæ–‡æœ¬æœç´¢çš„ grep æˆ–è®¸æ˜¯å…¶ä¸­æœ€å¸¸ç”¨çš„å·¥å…·ä¹‹ä¸€ã€‚å°½ç®¡å¹³æ—¶ç§°å¿ƒå¦‚æ„ï¼Œåœ¨é¢å¯¹æ•°ç™¾ä¸‡è¡Œçš„ä»£ç åº“æ—¶ï¼Œgrep çš„ç”¨æˆ·ä½“éªŒå®åœ¨å ªå¿§ã€‚è¿˜å¥½ï¼Œæˆ‘ä»¬æœ‰ the silver searcher ï¼ˆå³ agï¼‰è¿™æ ·è¿…æ·çš„æ›¿ä»£å“\n  åœ¨æ–‡æœ¬ä¸­æœç´¢æŒ‡å®šçš„å­—ç¬¦ä¸²,æ˜¾ç¤ºåŒ…å«å­—ç¬¦ä¸²çš„è¡Œ\n1  ag \u0026#34;password\u0026#34; ./tagret.file     æ˜¾ç¤ºå«æœ‰æŒ‡å®šå­—ç¬¦ä¸²çš„æ–‡ä»¶å\n1  ag -l \u0026#39;password\u0026#39; .     tmux å½“æˆ‘ä»¬åœ¨è¿œç¨‹æ‰§è¡Œå‘½ä»¤çš„æ—¶å€™ï¼Œç»å¸¸æ€§çš„ä¼šå› ä¸ºç½‘ç»œå¼‚å¸¸æ‰“å—é€ æˆå›è¯æ–­å¼€ï¼Œå‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œæ­¤æ—¶ä½ å°±éœ€è¦ä¸€ä¸ª Tmuxï¼Œå®ƒæ˜¯ä¸€ä¸ªç»ˆç«¯å¤ç”¨å™¨ï¼ˆterminal multiplexer)ã€‚è¿™æ ·å³ä½¿ä½ è¿œç¨‹è¿æ¥æœåŠ¡å™¨çš„ç¬”è®°æœ¬æ–­ç½‘äº†ï¼Œä¹Ÿä¸ä¼šç»ˆç«¯ä½ åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„å‘½ä»¤ï¼›\n å®ƒå…è®¸åœ¨å•ä¸ªçª—å£ä¸­ï¼ŒåŒæ—¶è®¿é—®å¤šä¸ªä¼šè¯ã€‚è¿™å¯¹äºåŒæ—¶è¿è¡Œå¤šä¸ªå‘½ä»¤è¡Œç¨‹åºå¾ˆæœ‰ç”¨ å®ƒå¯ä»¥è®©æ–°çª—å£\u0026quot;æ¥å…¥\u0026quot;å·²ç»å­˜åœ¨çš„ä¼šè¯ å®ƒå…è®¸æ¯ä¸ªä¼šè¯æœ‰å¤šä¸ªè¿æ¥çª—å£ï¼Œå› æ­¤å¯ä»¥å¤šäººå®æ—¶å…±äº«ä¼šè¯ã€‚ å®ƒè¿˜æ”¯æŒçª—å£ä»»æ„çš„å‚ç›´å’Œæ°´å¹³æ‹†åˆ†ã€‚  jq json æ–‡ä»¶å¤„ç†ä»¥åŠæ ¼å¼åŒ–æ˜¾ç¤ºï¼Œæ”¯æŒé«˜äº®ï¼Œå¯ä»¥æ›¿æ¢ python -m json.tool\nhttpstat HTTP å“åº”çš„å¯è§†åŒ–å‘½ä»¤è¡Œå·¥å…·,è¯·æ±‚å«æœ‰http/httpså‰ç¼€çš„ url,æ”¯æŒæ‰€æœ‰curlæ”¯æŒçš„é™¤äº†-w,-D,-o,-S,-sä¹‹å¤–çš„æ‰€æœ‰é€‰é¡¹ã€‚\nthefuck å‘½ä»¤è¡Œæ‰“é”™äº†ä»¥åï¼Œæ‰“ä¸€ä¸ªfuckå°±ä¼šè‡ªåŠ¨çº æ­£ã€‚\nshellcheck ShellCheckï¼Œç”¨äº Shell è„šæœ¬çš„é™æ€åˆ†æå·¥å…·ï¼Œåœ¨ç½‘é¡µä¸Šæ£€æŸ¥ä½ çš„è„šæœ¬ï¼šhttps://www.shellcheck.net/ ,shellcheck å…·ä½“ä¼šæ£€æŸ¥ä¸€äº›ä»€ä¹ˆé—®é¢˜å‘¢ï¼Œä»¥ä¸‹ç»™å‡ºä¸€ä¸ªä¸å®Œæ•´çš„é—®é¢˜æ£€æŸ¥åˆ—è¡¨\n å¼•å·é—®é¢˜ æ¡ä»¶åˆ¤æ–­ ShellCheck å¯ä»¥è¯†åˆ«å¤§å¤šæ•°ä¸æ­£ç¡®çš„æ¡ä»¶åˆ¤æ–­è¯­å¥ å¸¸è§çš„å¯¹å‘½ä»¤çš„é”™è¯¯ä½¿ç”¨ ShellCheck è¯†åˆ«å¾ˆå¤šåˆå­¦è€…çš„è¯­æ³•é”™è¯¯ ShellCheck å¯ä»¥æå‡ºä¸€äº›é£æ ¼æ”¹è¿›å»ºè®® ShellCheck å¯ä»¥è¯†åˆ«ä¸€äº›æ•°æ®å’Œæ‹¼å†™é”™è¯¯ ShellCheck å¯ä»¥åšå‡ºä¸€äº›å¢å¼ºè„šæœ¬é²æ£’æ€§çš„å»ºè®® ShellCheck è­¦å‘Šä½ ä½¿ç”¨äº† shebang ä¸æ”¯æŒçš„ç‰¹æ€§. ShellCheck å¯ä»¥è¯†åˆ«åˆ°ä¸€äº›å…¶ä»–é—®é¢˜  glances top/htop`çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®˜ç½‘åœ°å€:https://nicolargo.github.io/glances/\n","description":"åæ¬¾ å¸¸ç”¨ç»ˆç«¯çš„æŠ€æœ¯äººå‘˜å¿…ä¸å¯å°‘çš„ä¾¿æ·å·¥å…·","id":17,"section":"posts","tags":["Termianl","å·¥å…·"],"title":"æŠ€æœ¯äººå‘˜æœ€å¸¸ç”¨çš„å‘½ä»¤è¡Œå·¥å…·","uri":"https://linuxermaster.github.io/en/posts/20200531-%E6%8A%80%E6%9C%AF%E4%BA%BA%E5%91%98%E6%9C%80%E5%B8%B8%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7/"},{"content":"Sample images from Pixabay\n","description":"cartoon gallery","id":18,"section":"gallery","tags":null,"title":"Cartoon","uri":"https://linuxermaster.github.io/en/gallery/cartoon/"},{"content":"Sample images from Pixabay\n","description":"photo gallery","id":19,"section":"gallery","tags":null,"title":"Photo","uri":"https://linuxermaster.github.io/en/gallery/photo/"},{"content":"Written in Go, Hugo is an open source static site generator available under the Apache Licence 2.0. Hugo supports TOML, YAML and JSON data file types, Markdown and HTML content files and uses shortcodes to add rich content. Other notable features are taxonomies, multilingual mode, image processing, custom output formats, HTML/CSS/JS minification and support for Sass SCSS workflows.\nHugo makes use of a variety of open source projects including:\n https://github.com/russross/blackfriday https://github.com/alecthomas/chroma https://github.com/muesli/smartcrop https://github.com/spf13/cobra https://github.com/spf13/viper  Hugo is ideal for blogs, corporate websites, creative portfolios, online magazines, single page applications or even a website with thousands of pages.\nHugo is for people who want to hand code their own website without worrying about setting up complicated runtimes, dependencies and databases.\nWebsites built with Hugo are extremelly fast, secure and can be deployed anywhere including, AWS, GitHub Pages, Heroku, Netlify and any other hosting provider.\nLearn more and contribute on GitHub.\n","description":"Hugo, the worldâ€™s fastest framework for building websites","id":24,"section":"","tags":null,"title":"About","uri":"https://linuxermaster.github.io/en/about/"},{"content":"ä½¿ç”¨åœºæ™¯ Jenkins Shared Librariesæ˜¯ä¸€ç§åœ¨Jenkinsfileè¯­æ³•çš„åŸºç¡€ä¸Šæ‰©å±•Jenkins Pipelineçš„æŠ€æœ¯ã€‚é€šè¿‡ç¼–å†™Jenkins Shared Librarieså¯ä»¥å®ç°å°†è‡ªå®šä¹‰çš„Stepså½“æˆæ¨¡æ¿ï¼Œå¯¹æµæ°´çº¿é€»è¾‘ä¸­é‡å¤æˆ–å¯ä»¥é€šç”¨çš„éƒ¨åˆ†è¿›è¡ŒæŠ½è±¡å’Œå°è£…ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™å°†å…¶importè¿›å»å³å¯ã€‚è¿™æ ·å¯ä»¥å¤§å¤§çš„å‡å°‘äº†æˆ‘ä»¬é¡¹ç›®jenkinsfileçš„å¤æ‚åº¦ã€‚åœ¨å®é™…çš„å·¥ä½œä½¿ç”¨ä¸­å¾ˆå¸¸ç”¨ï¼Œçœ‹çœ‹Jenkinså…±äº«åº“èƒ½å¸®æˆ‘ä»¬è§£å†³çš„é—®é¢˜ï¼š\n æœåŠ¡å›¢é˜Ÿè‡ªåŠ¨åŒ–çš„é€æ¸æ¨è¿›ï¼Œä½¿ç”¨pipelineçš„jobè¶Šæ¥è¶Šå¤šï¼Œå¤§å¤šæƒ…å†µä¸‹æ¯ä¸ªé¡¹ç›®éƒ½éœ€è¦ç¼–å†™ä»åˆ«äººé‚£é‡Œæ‹·è´ä¸€ä»½å®Œæ•´çš„Jenkinsfileï¼Œå¾ˆéº»çƒ¦ï¼Œå¦‚æœä½ çš„å…¬å¸æ­£åœ¨è½¬å˜åˆ°å¾®æœåŠ¡,é‚£ä¹ˆä½ è‚¯å®šä¼šæ„Ÿå—åˆ°è¿™ç§ä¸å˜(è¿™æ˜¯å¾®æœåŠ¡çš„é”…) ä¸ç†Ÿæ‚‰jenkins pipelineè¯­æ³•çš„äººï¼Œéšæ„æ›´æ”¹å°±ä¼šé€ æˆå„ç§é”™è¯¯ï¼Œç»™è¿ç»´é€ æˆè´Ÿæ‹…ã€‚ æ¯ä¸ªé¡¹ç›®ä¸‹æœ‰ä¸€ä¸ªJenkinsfileå°±ä¼šé€ æˆä¿®æ”¹Jenkinsfileä¹Ÿä¼šè§¦å‘ä¸€æ¬¡ä¸å¿…è¦çš„æœåŠ¡æ„å»ºã€‚ ä¿®æ”¹ä¸€äº›å…¨å±€å·¥å…·çš„æ—¶å€™éœ€è¦å‘ŠçŸ¥ä½¿ç”¨åˆ°è¯¥å·¥å…·çš„æ‰€æœ‰äººå»ä¿®æ”¹jenkinsfileè„šæœ¬ã€‚ \u0026hellip;  åœ¨å®è·µä¸­æ¯ä¸ªæœåŠ¡å›¢é˜Ÿ/Devopså›¢é˜Ÿéƒ½åº”è¯¥é€šè¿‡ç»´æŠ¤ä¸€ä¸ªæˆ–å¤šä¸ªShared Librariesé¡¹ç›®å†ç»“åˆç¬¬ä¸‰æ–¹çš„Jenkinsæ’ä»¶å®šåˆ¶å›¢é˜Ÿè‡ªå·±çš„Jenkinsæµæ°´çº¿ã€‚åªè¦è®¤çœŸç»´æŠ¤share librariesè¿™ä¸€ä¸ªè¿œç¨‹ä»“åº“å°±èƒ½è§£å†³ä»¥ä¸Šçš„æ‰€æœ‰é—®é¢˜ã€‚åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°†share libraryå­˜åœ¨ä¸€ä¸ªgitç‰ˆæœ¬æ§åˆ¶ä»“åº“é‡Œé¢ï¼Œåœ¨éœ€è¦çš„æ—¶å€™ï¼Œå°†å®ƒå¼•å…¥åˆ°å½“å‰æ¨¡å¿«å³å¯ã€‚\nåœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡GithubæŸ¥çœ‹æ˜¯å¦æœ‰åˆ«äººå†™å¥½çš„ä¸€äº›å…±äº«åº“ï¼Œé€‚åˆçš„æˆ‘ä»¬å¯ä»¥ç›´æ¥ç»™é‚£è¿‡æ¥ï¼Œä¿®æ”¹æˆé€‚åˆè‡ªå·±çš„æ¨¡æ¿åº“ã€‚Jenkinsçš„çµæ´»å–å†³äºä½¿ç”¨groovyè¯­æ³•ï¼Œè€ŒJenkinsçš„æ¨¡æ¿åº“å®é™…ä¸Šå°±æ˜¯é€šè¿‡groovyè¯­è¨€ç¼–å†™çš„ä¸€äº›åŸºç¡€çš„ç±»æ–‡ä»¶ï¼Œå­˜åœ¨å›ºå®šæ ¼å¼çš„ç›®å½•ç»“æ„ä¸­ã€‚\n1 2 3 4 5 6 7 8 9 10 11 12  (root) +- src # Groovyæºæ–‡ä»¶ | +- org | +- foo | +- Bar.groovy # org.foo.barçš„ç±»æ–‡ä»¶ +- vars | +- foo.groovy # fooæ˜¯ä¸€ä¸ªå…¨å±€å˜é‡æ–‡ä»¶ï¼Œæ˜¯å¯ä»¥ä»Pipelineä¸­å…¨å±€è®¿é—®çš„ | +- foo.txt # å…¨å±€å˜é‡fooçš„è¯´æ˜å¸®åŠ©æ–‡ä»¶ +- resources # resource files (external libraries only) | +- org | +- foo | +- bar.json # static helper data for org.foo.Bar   åœ¨å…±äº«åº“çš„ç›®å½•ç»“æ„ä¸­éœ€è¦æ³¨æ„çš„æ˜¯srcå’Œvarsç›®å½•ï¼Œå…¶ä¸­srcé‡Œé¢å­˜æ”¾çš„æ˜¯å¯ä»¥åœ¨pipelineä¸­è°ƒç”¨çš„groovyç±»æ–¹æ³•ï¼Œåœ¨æ‰§è¡Œçš„æ—¶å€™é»˜è®¤ä¼šå°†å…¶æ·»åŠ åˆ°javaçš„class_Pathç¯å¢ƒå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸‹ï¼Œvarsä¸»è¦æ˜¯ä¸€äº›è„šæœ¬æ–‡ä»¶ï¼Œåœ¨pipelineè¿è¡Œçš„æ—¶å€™è¢«å¼•ç”¨ã€‚æƒ³è¦çµæ´»çš„ä½¿ç”¨Jenkins share libraryï¼Œå¯èƒ½ä½ éœ€è¦æŒæ¡groovyçš„åŸºç¡€è¯­æ³•ã€‚\n1    ","description":"","id":28,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200611-jenkins%E5%85%B1%E4%BA%AB%E5%BA%93jenkins-share-library%E7%9A%84%E4%BD%BF%E7%94%A8/"},{"content":"é…ç½®MYSQLæ•°æ®åº“ è¿è¡ŒMySQLå®¹å™¨ 1 2 3 4  docker container run -d --restart=always -v /data/mysql/my.cnf:/etc/mysql/conf.d/my.cnf \\ -v /data/mysql/mysql:/var/lib/mysql \\ -e MYSQL_ROOT_PASSWORD=PASSWORD \\ -p 33306:3306 mysql:5.7   SonarQubeé…ç½®ä¿¡æ¯ 1 2 3 4 5 6 7 8  mkdir -p /data/sonarqube docker run -d --name sonarqube -p 9000:9000 -p 9092:9092 sonarqube:7.7-community docker cp sonarqube:/opt/sonarqube/conf /data/sonarqube/ docker cp sonarqube:/opt/sonarqube/extensions /data/sonarqube/ wget -P /data/sonar/extensions/plugins https://github.com/SonarQubeCommunity/sonar-l10n-zh/releases/download/sonar-l10n-zh-plugin-1.27/sonar-l10n-zh-plugin-1.27.jar docker stop sonarqube docker rm sonarqube chown -R suoper.suoper /data/sonarqube   åˆ›å»ºSonarQubeæ•°æ®åº“ä¿¡æ¯ 1 2 3  CREATE DATABASE sonar CHARACTER SET utf8 COLLATE utf8_general_ci; GRANT ALL ON sonar.* TO \u0026#39;sonar\u0026#39;@\u0026#39;192.168.128.%\u0026#39; IDENTIFIED BY \u0026#39;sonar\u0026#39;; FLUSH PRIVILEGES;   é…ç½®SonarQubeçš„Ldap 1 2 3 4 5 6 7  root@jenkins-master-128-93:/data/sonarqube/conf# cat sonar.properties | egrep -v \u0026#39;^$|^#\u0026#39; sonar.security.realm=LDAP sonar.authenticator.downcase=true ldap.url=ldap://192.168.128.92:389 ldap.bindDn=cn=gitlab,ou=People,dc=openldap,dc=xingshulin,dc=com ldap.bindPassword=ioPg20o5! ldap.user.baseDn=ou=People,dc=openldap,dc=xingshulin,dc=com   å¯åŠ¨SonarQubeæœåŠ¡ 1  docker run -d --restart=always --name sonarqube -p 9000:9000 -e sonar.jdbc.username=root -e sonar.jdbc.password=\u0026#39;123456\u0026#39; -e sonar.jdbc.url=\u0026#34;jdbc:mysql://192.168.128.93:33306/sonar?useUnicode=true\u0026amp;characterEncoding=utf8\u0026amp;rewriteBatchedStatements=true\u0026amp;useConfigs=maxPerformance\u0026amp;useSSL=false\u0026#34; -v /data/sonarqube/extensions:/opt/sonarqube/extensions -v /data/sonarqube/conf:/opt/sonarqube/conf sonarqube:7.7-community   é…ç½®åŸŸåè§£æ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  server { listen 80; server_name quality.xsl.link; access_log logs/access.log json; location / { proxy_pass http://192.168.128.93:9000; proxy_set_header Host $http_host; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_read_timeout 900; # allow 119.57.91.170; # allow 47.94.96.138; # allow 123.56.30.91; # allow 192.168.128.0/24; # deny all;  } }   ","description":"","id":29,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200617-sonarqube7.7%E7%A4%BE%E5%8C%BA%E7%89%88%E5%AE%89%E8%A3%85/"},{"content":"åœºæ™¯ æœ€è¿‘å‘ç°ä¸€äº›æœ‹å‹æƒ³è¦è·³æ§½ï¼Œæ­£å€¼ç–«æƒ…ï¼Œä¹Ÿä¸çŸ¥é“ç°åœ¨å¸‚åœºçš„å¦‚ä½•ï¼ŒåŒæ—¶ç›®å‰çš„ITè¡Œä¸šæ›´æ˜¯è¶Šæ¥è¶Šéš¾,æŠ€æœ¯é©æ–°è¶Šæ¥è¶Šå¿«ï¼Œå¯¹æ–°çš„å²—ä½çš„éœ€æ±‚ä¹Ÿæ˜¯ä¸æ–­çš„å˜åŒ–ï¼Œå› æ­¤å°±ä¼šæƒ³çŸ¥é“ç°åœ¨çš„åº”è˜å²—ä½å¯¹é¢è¯•è€…çš„è¦æ±‚æœ‰å“ªäº›ï¼Œå„åœ°çš„æŸä¸ªå²—ä½è–ªèµ„èŒƒå›´å¤§æ¦‚æ˜¯å¤šå°‘ç­‰ä¿¡æ¯æ—¶å€™ï¼Œæˆ‘ä»¬å°±éœ€è¦åˆ°æŸä¸ªæ‹›è˜ç½‘ç«™ä¸Šä¸æ–­çš„åˆ·é¡µé¢ï¼Œçœ‹æ•°æ®ï¼Œä½†æ˜¯ç®€å•çš„æƒ³ä¸€ä¸‹ï¼Œå¯ä»¥é€šè¿‡Pythonè„šæœ¬æ¥æ‰¹é‡çš„åˆ†ææ‹›è˜ç½‘ç«™ä¸Šå„ä¸ªå²—ä½åœ¨ä¸åŒåŸå¸‚çš„éœ€æ±‚ï¼Œé«˜æ•ˆçš„å¿«æ·çš„æ–¹ä¾¿æˆ‘ä»¬æŒæ¡å¤§è‡´çš„æ–¹å‘ã€‚\nå®ç° å¦‚ä½•è·å–æ•°æ®ï¼Œéœ€è¦æŒæ¡åŸºæœ¬çš„Pythonçˆ¬è™«çŸ¥è¯†ï¼Œ[requests](https://requests.readthedocs.io/en/master/ Requests)æ¨¡å—å°±å¯ä»¥æå®šäº†ï¼Œåœ¨çˆ¬å–æ•°æ®ä¹‹åï¼Œå°†å…¶å­˜åœ¨Excelä¸­ï¼Œå› æ­¤éœ€è¦[xlwt](https://xlwt.readthedocs.io/en/latest/ xlwt)æ¨¡å—å¤„ç†ï¼Œå½“ç„¶åœ¨è¯¸å¤šçš„Pythonæ¨¡å—ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©ä½ å–œæ¬¢çš„ï¼Œæ¯•ç«Ÿèƒ½æŠ“è€é¼ çš„çŒ«éƒ½æ˜¯å¥½çŒ«ã€‚\n1 2  xlwt 1.3.0 requests 2.18.4   ä¸‹é¢æˆ‘ä»¬å°±æ‹¿æ‹‰é’©ç½‘ç«™ä¸ºä¾‹ï¼Œæ€è€ƒå’Œè·å–éƒ¨åˆ†çš„æ•°æ®ä½œä¸ºä¸ªäººç®€å•çš„åˆ†æå‚è€ƒï¼Œè„šæœ¬ä¸­æ²¡æœ‰æ¶‰åŠåˆ°éšç§æ•°æ®ä¿¡æ¯ï¼Œå¤§å¯æ”¾å¿ƒï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸ºäº†æ‰¾å·¥ä½œçš„å°ä¼™ä¼´ä»¬æä¾›ä¸€ä¸‹å‚è€ƒçš„æ–¹å‘ï¼š\næ³¨æ„ï¼š\n è„šæœ¬ä¸­è·å–çš„æ˜¯é€šè¿‡æŒ‡å®šçš„é¡µçš„æ•°é‡è·å–å…¨å›½å„åŸå¸‚çš„å²—ä½ä¿¡æ¯ï¼Œä½ å¯ä»¥ä¿®æ”¹FetchDataæ–¹æ³•ä¸­çš„refererå’Œè¯·æ±‚åœ°å€ä¸­åŸå¸‚çš„å€¼ï¼Œä»¥ä¾¿è·å–ä½ éœ€è¦çš„ç›®æ ‡åŸå¸‚çš„å²—ä½ä¿¡æ¯ å¦‚æœè·å–çš„æ¯”è¾ƒé¢‘ç¹çš„è¯ï¼Œå¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œè¿™é‡Œä½ å¯ä»¥é€šè¿‡è®¾ç½®ä»£ç†çš„æ–¹å¼è§£å†³ï¼Œå…è´¹çš„ä»£ç†IPç½‘ç«™ä¸Šæœ‰å¾ˆå¤šï¼Œä½ å¯ä»¥å‚è€ƒè¿™ç¯‡è·å–ä»£ç†çš„æ–‡ç« ã€‚  åœ¨äº¤äº’å¼è¾“å…¥éœ€è¦è·å–çš„é¡µæ•°ä¹‹åï¼Œçˆ¬å–çš„æ•°æ®å°†ä¼šå­˜å‚¨åœ¨å½“å‰æ‰§è¡Œä½ç½®ä¸‹çš„data.xlsã€‚  ä¸‹é¢å°±ç®€å•çš„æä¾›ä¸€ä¸‹å†™å¥½çš„Pythonè„šæœ¬ï¼š\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79  #!/usr/bin/env python3.4 # encoding: utf-8 \u0026#34;\u0026#34;\u0026#34; Created on 2020-06-26 @title: \u0026#39;çˆ¬å»ç½‘ç«™çš„æ‹›è˜ä¿¡æ¯\u0026#39; @author: marionxue \u0026#34;\u0026#34;\u0026#34; import requests import xlwt # è·å–å­˜å‚¨èŒä½ä¿¡æ¯çš„jsonå¯¹è±¡ï¼Œéå†è·å¾—å…¬å¸åã€ç¦åˆ©å¾…é‡ã€å·¥ä½œåœ°ç‚¹ã€å­¦å†è¦æ±‚ã€å·¥ä½œç±»å‹ã€å‘å¸ƒæ—¶é—´ã€èŒä½åç§°ã€è–ªèµ„ã€å·¥ä½œå¹´é™ def FetchData(url, datas): my_headers = { \u0026#34;User-Agent\u0026#34;: \u0026#34;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/72.0.3626.119 Safari/537.36\u0026#34;, \u0026#34;Referer\u0026#34;: \u0026#34;https://www.lagou.com/jobs/list_Python?city=%E5%85%A8%E5%9B%BD\u0026amp;cl=false\u0026amp;fromSearch=true\u0026amp;labelWords=\u0026amp;suginput=\u0026#34;, \u0026#34;Content-Type\u0026#34;: \u0026#34;application/x-www-form-urlencoded;charset = UTF-8\u0026#34; } ses = requests.session() # è·å–session ses.headers.update(my_headers) # æ›´æ–°å¤´éƒ¨ä¿¡æ¯ ses.get(\u0026#34;https://www.lagou.com/jobs/list_%E9%83%91%E5%B7%9Ejava?city=%E5%85%A8%E5%9B%BD\u0026amp;cl=false\u0026amp;fromSearch=true\u0026amp;labelWords=\u0026amp;suginput=\u0026#34;) content = ses.post(url=url, data=datas) result = content.json() info = result[\u0026#39;content\u0026#39;][\u0026#39;positionResult\u0026#39;][\u0026#39;result\u0026#39;] info_list = [] for job in info: information = [] information.append(job[\u0026#39;positionId\u0026#39;]) # å²—ä½å¯¹åº”ID information.append(job[\u0026#39;city\u0026#39;]) # å²—ä½å¯¹åº”åŸå¸‚ information.append(job[\u0026#39;companyFullName\u0026#39;]) # å…¬å¸å…¨å information.append(job[\u0026#39;companyLabelList\u0026#39;]) # ç¦åˆ©å¾…é‡ information.append(job[\u0026#39;district\u0026#39;]) # å·¥ä½œåœ°ç‚¹ information.append(job[\u0026#39;education\u0026#39;]) # å­¦å†è¦æ±‚ information.append(job[\u0026#39;firstType\u0026#39;]) # å·¥ä½œç±»å‹ information.append(job[\u0026#39;formatCreateTime\u0026#39;]) # å‘å¸ƒæ—¶é—´ information.append(job[\u0026#39;positionName\u0026#39;]) # èŒä½åç§° information.append(job[\u0026#39;salary\u0026#39;]) # è–ªèµ„ information.append(job[\u0026#39;workYear\u0026#39;]) # å·¥ä½œå¹´é™ info_list.append(information) return info_list def main(): page = int(input(\u0026#39;è¯·è¾“å…¥ä½ è¦æŠ“å–çš„é¡µç æ€»æ•°ï¼š\u0026#39;)) info_result = [] title = [\u0026#39;å²—ä½id\u0026#39;, \u0026#39;åŸå¸‚\u0026#39;, \u0026#39;å…¬å¸å…¨å\u0026#39;, \u0026#39;ç¦åˆ©å¾…é‡\u0026#39;, \u0026#39;å·¥ä½œåœ°ç‚¹\u0026#39;, \u0026#39;å­¦å†è¦æ±‚\u0026#39;, \u0026#39;å·¥ä½œç±»å‹\u0026#39;, \u0026#39;å‘å¸ƒæ—¶é—´\u0026#39;, \u0026#39;èŒä½åç§°\u0026#39;, \u0026#39;è–ªèµ„\u0026#39;, \u0026#39;å·¥ä½œå¹´é™\u0026#39;] info_result.append(title) for x in range(1, page + 1): url = \u0026#39;https://www.lagou.com/jobs/positionAjax.json?needAddtionalResult=false\u0026#39; datas = { \u0026#39;first\u0026#39;: \u0026#39;false\u0026#39;, \u0026#39;pn\u0026#39;: x, \u0026#39;kd\u0026#39;: \u0026#39;devopså·¥ç¨‹å¸ˆ\u0026#39;, } try: info = FetchData(url, datas) info_result = info_result + info print(\u0026#34;ç¬¬%sé¡µæ•°æ®å·²é‡‡é›†\u0026#34; % x) except Exception as msg: print(\u0026#34;ç¬¬%sé¡µæ•°æ®é‡‡é›†å‡ºç°é—®é¢˜\u0026#34; % x) # åˆ›å»ºworkbook,å³excel workbook = xlwt.Workbook(encoding=\u0026#39;utf-8\u0026#39;) # åˆ›å»ºè¡¨,ç¬¬äºŒå‚æ•°ç”¨äºç¡®è®¤åŒä¸€ä¸ªcellå•å…ƒæ˜¯å¦å¯ä»¥é‡è®¾å€¼ worksheet = workbook.add_sheet(datas[\u0026#34;kd\u0026#34;], cell_overwrite_ok=True) for i, row in enumerate(info_result): # print(row) for j, col in enumerate(row): worksheet.write(i, j, col) workbook.save(\u0026#39;data.xls\u0026#39;) if __name__ == \u0026#39;__main__\u0026#39;: main()   å½“æˆ‘ä»¬éœ€è¦æŸ¥çœ‹æŸä¸ªå²—ä½çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨58è¡Œå¤„ä¿®æ”¹å²—ä½çš„åç§°å³å¯ï¼Œç„¶åè¾“å…¥ä½ è¦é‡‡é›†å¤šå°‘é¡µçš„æ•°æ®å³å¯ï¼Œè¿™æ ·å¾ˆå¿«å°±ä¼šå°†æ•°æ®é‡‡é›†å¹¶ä¸”å­˜å‚¨åœ¨Excelè¡¨ä¸­\næ•°æ®æ˜¾ç¤º æ•°æ®åŸºæœ¬ä¸Šå®Œæˆé‡‡é›†ï¼Œå½“ç„¶å¯¹äºè‡ªå·±æœ‰éœ€è¦çš„è¯ï¼Œè¿˜å¯ä»¥ç»§ç»­å®Œå–„å•Šï¼ŒğŸ˜†\n","description":"","id":30,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200626-python%E5%88%86%E6%9E%90%E5%BA%94%E8%81%98%E5%B2%97%E4%BD%8D%E6%9D%A1%E4%BB%B6%E4%BF%A1%E6%81%AF/"},{"content":"ææ ‘æ—ä¿¡æ¯æŠ€æœ¯ï¼ˆåŒ—äº¬ï¼‰æœ‰é™å…¬å¸æˆç«‹äº2011å¹´ï¼Œæ˜¯å›½å†…çŸ¥åçš„äº’è”ç½‘åŒ»ç–—ä¼ä¸šã€‚ææ ‘æ—çš„åˆå¿ƒæ˜¯è®©åŒ»ç”Ÿè¡ŒåŒ»æ›´è½»æ¾ï¼Œè®©åŒ»ç–—æ›´é«˜æ•ˆï¼Œå°†â€œåå’Œä¸‰å®â€ï¼ˆå›¾ä¹¦é¦†ã€ç—…æ¡ˆå®¤ã€è€æ•™æˆï¼‰å˜æˆä¸­å›½åŒ»ç”Ÿçš„ä¸‰å®ã€‚æ——ä¸‹APPäº§å“â€œç—…å†å¤¹â€å’Œâ€œåŒ»å£è¢‹â€ï¼Œä¸ºåŒ»ç”Ÿæä¾›ä¸“ä¸šå†…å®¹å’Œä¸´åºŠå·¥å…·ï¼Œç”¨æˆ·è¦†ç›–37%çš„ä¸­å›½åŒ»ç”Ÿç¾¤ä½“ã€‚å…¬å¸è¢«å›½é™…çŸ¥ååˆ›ä¸šåª’ä½“Fast Companyè¯„ä¸º2015å¹´å…¨çƒæœ€å…·åˆ›æ–°åŠ›åŒ»ç–—ä¼ä¸šï¼Œå¹¶å…ˆåè·å¾—è“é©°ã€çœŸæ ¼ã€å¼€ç‰©ã€åŒæ¹–ã€å¥åº·å…ƒç­‰æœºæ„çš„4è½®æŠ•èµ„ã€‚2016å¹´èµ·ï¼Œææ ‘æ—ç‡å…ˆæ‰“é€ äº†ä»¥ç—…å†ä¸ºæ ¸å¿ƒçš„ä¸€ç«™å¼å…¨åœºæ™¯åŒ»è¯è¥é”€äº‘å¹³å°ï¼Œè‡´åŠ›äºæ¨åŠ¨åŒ»è¯ä¼ä¸šåˆè§„ä¸“ä¸šåŒ–è¥é”€è½¬å‹ï¼Œä¸ºåŒ»è¯äº§å“æä¾›åŸºäºç—…å†çš„å…¨åœºæ™¯è¥é”€æœåŠ¡ï¼Œè§£å†³äº†åŒ»è¯ä¼ä¸šåˆè§„ã€ç²¾å‡†ã€æœ‰æ•ˆå­¦æœ¯è¥é”€çš„è¯‰æ±‚ã€‚ææ ‘æ—è¿˜æˆç«‹äº†å›½å†…ç¬¬ä¸€ä¸ªâ€œç—…å†è¥é”€ç ”ç©¶é™¢â€ï¼Œæ€»ç»“ç—…å†è¥é”€çš„æ–¹æ³•è®ºå’Œæœ€ä½³å®è·µï¼Œå¸®åŠ©åŒ»è¯ä¼ä¸šè½åœ°åŸºäºç—…å†è¥é”€çš„ä¸“ä¸šåŒ–è½¬å‹ã€‚åŒæ—¶ï¼Œé€šè¿‡ææ ‘æ—äº’è”ç½‘åŒ»é™¢ï¼Œå·²ç»å½¢æˆäº†â€œæ‚£è€…æ‹›å‹Ÿ-çº¿ä¸Šè¯Šç–—-é€è¯ä¸Šé—¨-æ…¢ç—…ç®¡ç†â€çš„é—­ç¯æœåŠ¡ã€‚æˆªè‡³å½“å‰ï¼Œææ ‘æ—å·²ç»ä¸ä¸­å›½å¸‚åœºä¸Šæ•°åå®¶é¢†å…ˆåŒ»è¯å·¥ä¸šã€å•†ä¸šä¼ä¸šä»¥åŠåŒ»ç–—å™¨æ¢°ä¼ä¸šè¾¾æˆé•¿æœŸä¸šåŠ¡åˆä½œï¼ŒæœåŠ¡äº†ä¸€ç™¾å¤šä¸ªåŒ»è¯äº§å“ã€‚å¤–èµ„è¯ä¼åå¼ºä¸å›½å†…å·¥ä¸šåå¼ºè¶…è¿‡åŠæ•°æ˜¯ææ ‘æ—çš„å®¢æˆ·ã€‚\nåˆçº§å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ(8k-15k) ã€å²—ä½èŒè´£ã€‘  æ–°ä¸šåŠ¡åŠŸèƒ½å¼€å‘å’Œç»´æŠ¤; è´Ÿè´£å®šä½å¹¶è§£å†³ç°æœ‰æ¨¡å—å­˜åœ¨çš„é—®é¢˜; æŒç»­ä¼˜åŒ–é¡µé¢ï¼Œä¿è¯ç½‘ç«™çš„é«˜æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§;  ã€ä»»èŒè¦æ±‚ã€‘ èƒ½åŠ›è¦æ±‚:\n æœ¬ç§‘åŠä»¥ä¸Šå­¦å†ï¼Œ1 å¹´ä»¥ä¸Šäº’è”ç½‘å·¥ä½œç»éªŒï¼Œå¯æ¥å—èƒ½åŠ›ä¼˜ç§€çš„åº”å±Šæ¯•ä¸šç”Ÿã€åœ¨æ ¡å®ä¹  ç”Ÿ; æœ‰ä»£ç æ´ç™–ï¼Œå¯¹æ–°æŠ€æœ¯æœ‰çƒ­æƒ…ï¼Œå…³æ³¨æŠ€æœ¯å‘å±•æ–¹å‘; æå¼ºçš„è´£ä»»å¿ƒï¼Œè¿½æ±‚å®Œç¾çš„ä¹ æƒ¯ï¼Œåˆ¨æ ¹é—®åº•çš„ç²¾ç¥; æœ‰å›¢é˜Ÿç²¾ç¥ï¼Œèƒ½å¤Ÿç§¯æä¸»åŠ¨æ¨åŠ¨å›¢é˜Ÿæ›´å¥½çš„å‘å±•; ä¹äºæŠ€æœ¯çš„åˆ†äº«ã€‚  æŠ€æœ¯è¦æ±‚\n ç†Ÿç»ƒæŒæ¡ HTML5/CSS3/JavaScript ç›¸å…³æŠ€èƒ½; ç†Ÿæ‚‰åŸºæœ¬çš„è®¡ç®—æœºç½‘ç»œæ¦‚å¿µï¼Œç†Ÿæ‚‰ HTTP åè®®ï¼Œäº†è§£ TCP/IP çš„åŸºæœ¬å·¥ä½œåŸç†ï¼Œç†Ÿæ‚‰å„ ç§ Web æ ‡å‡†è§„èŒƒ; ä½¿ç”¨è¿‡è‡³å°‘ä¸€ç§ JS æ¡†æ¶ï¼ŒReact æˆ– Vue ç­‰; ç†Ÿæ‚‰ hybird å¼€å‘ï¼Œèƒ½è§£å†³è·¨æµè§ˆå™¨å’Œä¸åŒåˆ†è¾¨ç‡ç§»åŠ¨è®¾å¤‡å…¼å®¹æ€§; ç†Ÿæ‚‰å‰ç«¯è‡ªåŠ¨åŒ–å’Œå·¥ç¨‹åŒ–ï¼Œä½¿ç”¨è¿‡ Webpack æˆ– Gulp ç­‰å¸¸è§æ„å»ºå·¥å…·ã€‚ ç†Ÿæ‚‰ Node å¼€å‘ï¼Œç†Ÿç»ƒä½¿ç”¨ Git; æœ‰å°ç¨‹åºå¼€å‘ç»éªŒè€…ä¼˜å…ˆã€æœ‰ github å¼€æºé¡¹ç›®è€…ä¼˜å…ˆ;  ä¸­çº§å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ(12k-25k): ã€å²—ä½è¦æ±‚ã€‘  æ–°ä¸šåŠ¡åŠŸèƒ½å¼€å‘å’Œç»´æŠ¤; è´Ÿè´£ Node æ¡†æ¶çš„æ€§èƒ½ä¼˜åŒ–å’Œç»´æŠ¤; 3ã€è´Ÿè´£å®šä½å¹¶è§£å†³ç°æœ‰æ¨¡å—å­˜åœ¨çš„é—®é¢˜; 4ã€æŒç»­ä¼˜åŒ–é¡µé¢ï¼Œä¿è¯ç½‘ç«™çš„é«˜æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§; 5ã€è§„èŒƒå’Œæ–‡æ¡£çš„ç¼–å†™ã€ç»´æŠ¤ã€‚  ã€ä»»èŒè¦æ±‚ã€‘ èƒ½åŠ›è¦æ±‚:\n æœ¬ç§‘ä»¥ä¸Šï¼Œ2 å¹´ä»¥ä¸Šäº’è”ç½‘å·¥ä½œç»éªŒ; èƒ½å¤Ÿå‘ç°å›¢é˜Ÿé‡Œçš„é—®é¢˜ï¼Œæå‡ºæ–¹æ¡ˆï¼Œå¹¶è½åœ°; æœ‰ä»£ç æ´ç™–ï¼ŒæŠ€æœ¯å…¨é¢ï¼Œå¯¹æ–°æŠ€æœ¯æœ‰çƒ­æƒ…ï¼Œå…³æ³¨æŠ€æœ¯å‘å±•æ–¹å‘; æå¼ºçš„è´£ä»»å¿ƒï¼Œè¿½æ±‚å®Œç¾çš„ä¹ æƒ¯ï¼Œåˆ¨æ ¹é—®åº•çš„ç²¾ç¥; æœ‰å›¢é˜Ÿç²¾ç¥ï¼Œèƒ½å¤Ÿç§¯æä¸»åŠ¨æ¨åŠ¨å›¢é˜Ÿæ›´å¥½çš„å‘å±•; ä¹äºæŠ€æœ¯çš„åˆ†äº«ã€‚  æŠ€æœ¯è¦æ±‚:\n  2 å¹´ä»¥ä¸Š Web å‰ç«¯å·¥ä½œç»éªŒï¼Œç†Ÿç»ƒæŒæ¡ HTML5/CSS3/JavaScript ç›¸å…³æŠ€èƒ½;\n  ç†Ÿæ‚‰åŸºæœ¬çš„è®¡ç®—æœºç½‘ç»œæ¦‚å¿µï¼Œç†Ÿæ‚‰ HTTP åè®®ï¼Œäº†è§£ TCP/IP çš„åŸºæœ¬å·¥ä½œåŸç†ï¼Œç†Ÿæ‚‰å„ ç§ Web æ ‡å‡†è§„èŒƒ;\n  ç†Ÿç»ƒä½¿ç”¨è‡³å°‘ä¸€ç§ JS æ¡†æ¶ï¼ŒReact æˆ– Vue ç­‰ï¼ŒæŒæ¡å…¶åŸç†ï¼Œèƒ½ç‹¬ç«‹å¼€å‘å¸¸ç”¨ç»„ä»¶;\n  ç†Ÿæ‚‰ hybird å¼€å‘ï¼Œèƒ½è§£å†³è·¨æµè§ˆå™¨å’Œä¸åŒåˆ†è¾¨ç‡ç§»åŠ¨è®¾å¤‡å…¼å®¹æ€§;\n  ç†Ÿæ‚‰å‰ç«¯è‡ªåŠ¨åŒ–å’Œå·¥ç¨‹åŒ–ï¼Œå¯¹ Webpackã€Gulp ç­‰å¸¸è§æ„å»ºå·¥å…·æœ‰è‡ªå·±çš„è®¤çŸ¥ä¸ç†è§£ã€‚\n  ç†Ÿæ‚‰ Node å¼€å‘ï¼Œç†Ÿç»ƒä½¿ç”¨ Git;\n  æœ‰å°ç¨‹åºå¼€å‘ç»éªŒè€…ä¼˜å…ˆã€æœ‰ github å¼€æºé¡¹ç›®è€…ä¼˜å…ˆ;\n  é«˜çº§å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ(20k-35k) ã€å²—ä½èŒè´£ã€‘\n æ–°ä¸šåŠ¡åŠŸèƒ½å¼€å‘å’Œç»´æŠ¤; è´Ÿè´£æ¡†æ¶çš„æ€§èƒ½ä¼˜åŒ–å’Œç»´æŠ¤; è´Ÿè´£å®šä½å¹¶è§£å†³ç°æœ‰æ¨¡å—å­˜åœ¨çš„é—®é¢˜; æŒç»­ä¼˜åŒ–é¡µé¢ï¼Œä¿è¯åŠŸèƒ½çš„é«˜æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§; è§„èŒƒå’Œæ–‡æ¡£çš„ç¼–å†™ã€ç»´æŠ¤; å‚ä¸å›¢é˜Ÿçš„æŠ€æœ¯æ²‰æ·€ã€ä¸å›¢é˜Ÿä¸€èµ·æˆé•¿ã€‚  ã€ä»»èŒè¦æ±‚ã€‘ æŠ€æœ¯è¦æ±‚:\n ç²¾é€š CSS ã€JavaScript ç­‰å‰ç«¯æŠ€æœ¯; ç†Ÿæ‚‰åŸºæœ¬çš„è®¡ç®—æœºç½‘ç»œæ¦‚å¿µï¼Œç†Ÿæ‚‰ HTTP åè®®ï¼Œäº†è§£ TCP/IP çš„åŸºæœ¬å·¥ä½œåŸç†ï¼Œç†Ÿæ‚‰å„ç§ Web æ ‡å‡†è§„èŒƒ; ä½¿ç”¨è¿‡ React æˆ– Vue ç­‰å‰ç«¯æ¡†æ¶ï¼ŒæŒæ¡å…¶åŸç†ï¼Œèƒ½ç‹¬ç«‹å¼€å‘å¸¸ç”¨ç»„ä»¶; å¯¹å‰ç«¯å¼€å‘ç”Ÿæ€ä¸­çš„çŸ¥è¯†æœ‰åŸºæœ¬äº†è§£(è‡ªåŠ¨åŒ–æ„å»ºã€ç»„ä»¶åŒ–ã€æ€§èƒ½ã€å®‰å…¨ç­‰); å¯¹ä¸­åå°ä¸šåŠ¡ç»„ä»¶åŒ–å¼€å‘æœ‰å……åˆ†ç†è§£å’Œå®è·µ; å¯¹ web å¼€å‘åœºæ™¯å¸¸ç”¨çš„æœåŠ¡ç«¯ã€è¿ç»´é¢†åŸŸçš„ç›¸å…³æŠ€æœ¯æœ‰ä¸€å®šäº†è§£; 7ã€æœ‰æœåŠ¡ç«¯å¼€å‘ç»éªŒã€å…¶ä»–è¯­è¨€ç»éªŒä¼˜å…ˆã€‚  èƒ½åŠ›è¦æ±‚:\n æœ¬ç§‘åŠä»¥ä¸Šå­¦å†ï¼Œ5 å¹´åŠä»¥ä¸Š Web å‰ç«¯å·¥ä½œç»éªŒ; èƒ½å¤Ÿå‘ç°å›¢é˜Ÿé‡Œçš„é—®é¢˜ï¼Œæå‡ºæ–¹æ¡ˆï¼Œå¹¶è½åœ°; æœ‰ä»£ç æ´ç™–ï¼ŒæŠ€æœ¯å…¨é¢ï¼Œå¯¹æ–°æŠ€æœ¯æœ‰çƒ­æƒ…ï¼Œå…³æ³¨æŠ€æœ¯å‘å±•æ–¹å‘; æå¼ºçš„è´£ä»»å¿ƒï¼Œè¿½æ±‚å®Œç¾çš„ä¹ æƒ¯ï¼Œåˆ¨æ ¹é—®åº•çš„ç²¾ç¥; æœ‰å›¢é˜Ÿç²¾ç¥ï¼Œèƒ½å¤Ÿç§¯æä¸»åŠ¨æ¨åŠ¨å›¢é˜Ÿæ›´å¥½çš„å‘å±•; è‰¯å¥½çš„æ²Ÿé€šåè°ƒèƒ½åŠ›ï¼Œåœ¨å›¢é˜Ÿä¸­èƒ½å¤Ÿæ‰®æ¼”ä¸€å®šçš„æŠ€æœ¯ç®¡ç†èƒ½åŠ›ã€‚  å‘˜å·¥ç¦åˆ©  å¥åº·ï¼šæä¾›å…¨ç§‘åŒ»ç”Ÿé—®è¯ŠæœåŠ¡åŠå®šåˆ¶åŒ–å¹´åº¦ä½“æ£€ï¼Œå…¨æ–¹ä½è§£å†³å‘˜å·¥åŠå®¶å±çš„å„çº§åŒ»ç–—éœ€æ±‚ï¼Œä¸ºå‘˜å·¥åŠå®¶äººå¥åº·ä¿é©¾æŠ¤èˆªã€‚ æ¿€åŠ±ï¼šæœ‰å¸å¼•åŠ›çš„ä¸šç»©å¥–åŠ±ï¼Œæ¯å¹´2æ¬¡è°ƒè–ªæœºä¼šã€‚ ä¿é™©ï¼šå…­é™©ä¸€é‡‘ï¼ˆå…»è€ä¿é™©ã€åŒ»ç–—ä¿é™©ã€å·¥ä¼¤ä¿é™©ã€å¤±ä¸šä¿é™©ã€ç”Ÿè‚²ä¿é™©ã€ä½æˆ¿å…¬ç§¯é‡‘åŠè¡¥å……åŒ»ç–—ä¿é™©ï¼‰ æ´»åŠ¨ï¼šå›¢å»ºç»è´¹ã€å„ç§ä¿±ä¹éƒ¨ï¼šç¾½æ¯›çƒã€è¶³çƒã€ç¯®çƒã€æ¸¸æ³³ã€æ»‘é›ªã€éª‘è¡Œç­‰ã€‚ å…³æ€€ï¼šä»å¿ƒåˆ°èº«çš„å…¨é¢å…³æ€€ï¼Œè¯»ä¹¦åˆ†äº«ã€å†…éƒ¨åŸ¹è®­ã€é¤è¡¥ã€ä¸‹åˆèŒ¶é¥®æ–™ã€æ°´æœé›¶é£Ÿã€æŒ‰æ‘©æ¤…ç­‰ å…¶ä»–ï¼šæŠ€æœ¯åˆ†äº«ã€å…è´¹çš„ä¸‹åˆèŒ¶é¥®æ–™ç­‰\u0026hellip;  åŠ å…¥æˆ‘ä»¬ å¦‚æœæ‚¨å¯¹ä»¥ä¸Šçš„å²—ä½æ„Ÿå…´è¶£ï¼Œæ‚¨å¯ä»¥æ‰«æä»¥ä¸‹çš„äºŒç»´ç åŠ æˆ‘ï¼Œç›´æ¥å°†æ‚¨çš„å»ºç«‹é€è¾¾HRå¤„ã€‚\n","description":"","id":31,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200628-%E6%9D%8F%E6%A0%91%E6%9E%97%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%88%E6%8B%9B%E8%81%98/"},{"content":"kuboard Kuboard æ˜¯ä¸€æ¬¾å…è´¹çš„ Kubernetes ç®¡ç†å·¥å…·ï¼Œæä¾›äº†ä¸°å¯Œçš„åŠŸèƒ½ï¼Œç»“åˆå·²æœ‰æˆ–æ–°å»ºçš„ä»£ç ä»“åº“ã€é•œåƒä»“åº“ã€CI/CDå·¥å…·ç­‰ï¼Œå¯ä»¥ä¾¿æ·çš„æ­å»ºä¸€ä¸ªç”Ÿäº§å¯ç”¨çš„ Kubernetes å®¹å™¨äº‘å¹³å°ï¼Œè½»æ¾ç®¡ç†å’Œè¿è¡Œäº‘åŸç”Ÿåº”ç”¨ã€‚æ‚¨ä¹Ÿå¯ä»¥ç›´æ¥å°† Kuboard å®‰è£…åˆ°ç°æœ‰çš„ Kubernetes é›†ç¾¤ï¼Œé€šè¿‡ Kuboard æä¾›çš„ Kubernetes RBAC ç®¡ç†ç•Œé¢ï¼Œå°† Kubernetes æä¾›çš„èƒ½åŠ›å¼€æ”¾ç»™æ‚¨çš„å¼€å‘å›¢é˜Ÿã€‚\nKuboard æä¾›çš„åŠŸèƒ½æœ‰ï¼š\n Kubernetes åŸºæœ¬ç®¡ç†åŠŸèƒ½  èŠ‚ç‚¹ç®¡ç† åç§°ç©ºé—´ç®¡ç† å­˜å‚¨ç±»/å­˜å‚¨å·ç®¡ç† æ§åˆ¶å™¨ï¼ˆDeployment/StatefulSet/DaemonSet/CronJob/Job/ReplicaSetï¼‰ç®¡ç† Service/Ingress ç®¡ç† ConfigMap/Secret ç®¡ç† CustomerResourceDefinition ç®¡ç†   Kubernetes é—®é¢˜è¯Šæ–­  Top Nodes / Top Pods äº‹ä»¶åˆ—è¡¨åŠé€šçŸ¥ å®¹å™¨æ—¥å¿—åŠç»ˆç«¯ KuboardProxy (kubectl proxy çš„åœ¨çº¿ç‰ˆæœ¬) PortForward (kubectl port-forward çš„å¿«æ·ç‰ˆæœ¬) å¤åˆ¶æ–‡ä»¶ ï¼ˆkubectl cp çš„åœ¨çº¿ç‰ˆæœ¬ï¼‰   è®¤è¯ä¸æˆæƒ  Github/GitLab å•ç‚¹ç™»å½• KeyCloak è®¤è¯ LDAP è®¤è¯ å®Œæ•´çš„ RBAC æƒé™ç®¡ç†   Kuboard ç‰¹è‰²åŠŸèƒ½  Kuboard å®˜æ–¹å¥—ä»¶  Grafana+Prometheus èµ„æºç›‘æ§ Grafana+Loki+Promtail æ—¥å¿—èšåˆ   Kuboard è‡ªå®šä¹‰åç§°ç©ºé—´å¸ƒå±€ Kuboard ä¸­è‹±æ–‡è¯­è¨€åŒ…    Lens lensæ˜¯ä¸€ä¸ªå…è´¹ã€å¼€æºçš„å¯ä»¥æ§åˆ¶å¤škubernetesé›†ç¾¤çš„IDEå·¥å…·ï¼Œå¦‚ä¸‹å›¾ï¼Œå·¦ä¾§å›¾æ ‡æ˜¾ç¤ºçš„æ˜¯ä¸åŒçš„Kubernetesé›†ç¾¤ï¼Œåœ¨æ­¤IDEä¸Šï¼Œå¯ä»¥å¯è§†åŒ–äº¤äº’å¼çš„å¿«é€ŸæŸ¥çœ‹é›†ç¾¤çŠ¶æ€ã€æ¯ä¸ªèµ„æºå¯¹è±¡çš„è¿è¡ŒçŠ¶æ€ç­‰ã€‚IDEæ”¯æŒMacã€windowså’ŒLinuxæ“ä½œç³»ç»Ÿï¼Œå¯ä»¥ç›´æ¥åœ¨Githubä¸Šä¸‹è½½ã€‚ä¸‹é¢çœ‹ä¸€ä¸‹lensè¿™æ¬¾IDEæ”¯æŒçš„è¯¦ç»†çš„åŠŸèƒ½ï¼š\n kubernetes IDE  å¯¹äºéœ€è¦æ¯å¤©å¤„ç†Kubernetesé›†ç¾¤çš„äººæ¥è¯´ï¼ŒLensæ˜¯åŠŸèƒ½æœ€å¼ºå¤§çš„IDEã€‚å®ƒæ˜¯é€‚ç”¨äºMacOSï¼ŒWindowså’ŒLinuxæ“ä½œç³»ç»Ÿçš„ç‹¬ç«‹åº”ç”¨ç¨‹åºã€‚ç¡®ä¿æ­£ç¡®è®¾ç½®å’Œé…ç½®äº†ç¾¤é›†ã€‚äº«å—å¢å¼ºçš„å¯è§æ€§ï¼Œå®æ—¶ç»Ÿè®¡ä¿¡æ¯ï¼Œæ—¥å¿—æµå’ŒåŠ¨æ‰‹æ•…éšœæ’é™¤åŠŸèƒ½ã€‚å€ŸåŠ©Lensï¼Œæ‚¨å¯ä»¥æ›´è½»æ¾ï¼Œæ›´å¿«é€Ÿåœ°ä½¿ç”¨é›†ç¾¤ï¼Œä»è€Œä»æ ¹æœ¬ä¸Šæé«˜ç”Ÿäº§åŠ›å’Œä¸šåŠ¡é€Ÿåº¦ã€‚\n å¤šé›†ç¾¤ç®¡ç†  å¯ä»¥ä»ä¸€ä¸ªç»Ÿä¸€çš„IDEæ”¾å¿ƒåœ°è®¿é—®å’Œä½¿ç”¨ç¾¤é›†ã€‚Lenså¯ä¸ä»»æ„æ•°é‡çš„Kubernetesé›†ç¾¤ä¸€èµ·ä½¿ç”¨ã€‚ä½¿ç”¨å†…ç½®çš„kubectlæ¥æ‰§è¡ŒKubernetes RBACï¼Œä»è€Œå¯ä»¥è®¿é—®é›†ç¾¤ã€‚ç¾¤é›†å¯ä»¥æ˜¯æœ¬åœ°ç¾¤é›†ï¼ˆä¾‹å¦‚ï¼Œè¿·ä½ åº“ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¤–éƒ¨ç¾¤é›†ï¼ˆä¾‹å¦‚ï¼ŒEKSï¼ŒAKSï¼ŒGKEï¼ŒPharosï¼ŒUCPï¼ŒRancheræˆ–OpenShiftï¼‰ã€‚åªéœ€å¯¼å…¥å¸¦æœ‰é›†ç¾¤è¯¦ç»†ä¿¡æ¯çš„kubeconfigå³å¯æ·»åŠ é›†ç¾¤ã€‚æ·»åŠ åï¼Œå¯ä»¥è½»æ¾åœ°åœ¨é›†ç¾¤ä¹‹é—´è¿›è¡Œåˆ‡æ¢ã€‚ä½¿ç”¨Lensï¼Œæ‚¨å°†ä¸ºæ‰€æœ‰ç¾¤é›†è·å¾—ä¸€ä¸ªç»Ÿä¸€çš„IDEï¼\n å¤šå·¥ä½œåŒº  å°†é›†ç¾¤ç»„ç»‡æˆé€»è¾‘ç»„ã€‚å·¥ä½œåŒºç”¨äºå°†å¤šä¸ªç¾¤é›†ç»„ç»‡æˆé€»è¾‘ç»„ã€‚å¯¹äºéœ€è¦å¤„ç†å¤šä¸ªï¼ˆç”šè‡³æ•°ç™¾ä¸ªï¼‰ç¾¤é›†çš„DevOpså’ŒSREï¼Œå®ƒä»¬éå¸¸æœ‰ç”¨ã€‚å•ä¸ªå·¥ä½œç©ºé—´åŒ…å«é›†ç¾¤åŠå…¶å®Œæ•´é…ç½®çš„åˆ—è¡¨ã€‚åˆ›å»ºå’Œåœ¨å·¥ä½œç©ºé—´ä¹‹é—´åˆ‡æ¢å¾ˆå®¹æ˜“ã€‚\n å†…ç½®æ™®ç½—ç±³ä¿®æ–¯ç»Ÿè®¡  æŸ¥çœ‹ä½œä¸ºä»ªè¡¨æ¿ä¸€éƒ¨åˆ†é›†æˆçš„æ‰€æœ‰ç›¸å…³å›¾å½¢å’Œèµ„æºåˆ©ç”¨ç‡å›¾è¡¨ã€‚Lenså¸¦æœ‰å†…ç½®çš„å¤šç§Ÿæˆ·Prometheusè®¾ç½®ï¼Œè¯¥è®¾ç½®å°†å°Šé‡æ¯ä¸ªç”¨æˆ·çš„RBACã€‚ç”¨æˆ·å°†çœ‹åˆ°ä»–ä»¬æœ‰æƒè®¿é—®çš„æ‰€æœ‰åç§°ç©ºé—´å’Œèµ„æºçš„å¯è§†åŒ–ã€‚æ‰€æœ‰å›¾å½¢å’Œèµ„æºåˆ©ç”¨ç‡å›¾è¡¨çš„è®¾è®¡å‡æ˜“äºè®¿é—®ï¼Œå¹¶ä¸”åœ¨é€‚å½“çš„ä¸Šä¸‹æ–‡ä¸­å‡å¯ä½¿ç”¨ï¼Œæ— è®ºæ‚¨æ“ä½œçš„æ˜¯ä»ªè¡¨æ¿çš„å“ªä¸€éƒ¨åˆ†ã€‚\n ä¸Šä¸‹æ–‡ç»ˆç«¯æ„Ÿåº”  å†…ç½®ç»ˆç«¯éšé™„äº†kubectlï¼Œè¯¥APIå§‹ç»ˆåœ¨æ­£ç¡®çš„ä¸Šä¸‹æ–‡ä¸­ä¸æ‚¨çš„é›†ç¾¤å…¼å®¹ã€‚Lenså†…ç½®ç»ˆç«¯å°†ç¡®ä¿Kubernetesé›†ç¾¤APIçš„ç‰ˆæœ¬ä¸kubectlçš„ç‰ˆæœ¬å…¼å®¹ã€‚å®ƒä¼šå³æ—¶ä¸‹è½½å¹¶åˆ†é…æ­£ç¡®çš„ç‰ˆæœ¬ï¼Œå› æ­¤æ‚¨ä¸å¿…è¿™æ ·åšã€‚é€šè¿‡åˆ‡æ¢kubectlä¸Šä¸‹æ–‡ä»¥åŒ¹é…æ‚¨å½“å‰ä½¿ç”¨çš„é›†ç¾¤ï¼Œå®ƒä¹Ÿå°†ä½¿æ‚¨é«˜æ•æ— å¿§ã€‚\nKubeSphere KubeSphere æ˜¯åœ¨ Kubernetes ä¹‹ä¸Šæ„å»ºçš„ä»¥åº”ç”¨ä¸ºä¸­å¿ƒçš„ä¼ä¸šçº§åˆ†å¸ƒå¼å®¹å™¨å¹³å°ï¼Œæä¾›ç®€å•æ˜“ç”¨çš„æ“ä½œç•Œé¢ä»¥åŠå‘å¯¼å¼æ“ä½œæ–¹å¼ï¼Œåœ¨é™ä½ç”¨æˆ·ä½¿ç”¨å®¹å™¨è°ƒåº¦å¹³å°å­¦ä¹ æˆæœ¬çš„åŒæ—¶ï¼Œæå¤§å‡è½»å¼€å‘ã€æµ‹è¯•ã€è¿ç»´çš„æ—¥å¸¸å·¥ä½œçš„å¤æ‚åº¦ï¼Œæ—¨åœ¨è§£å†³ Kubernetes æœ¬èº«å­˜åœ¨çš„å­˜å‚¨ã€ç½‘ç»œã€å®‰å…¨å’Œæ˜“ç”¨æ€§ç­‰ç—›ç‚¹ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¹³å°å·²ç»æ•´åˆå¹¶ä¼˜åŒ–äº†å¤šä¸ªé€‚ç”¨äºå®¹å™¨åœºæ™¯çš„åŠŸèƒ½æ¨¡å—ï¼Œä»¥å®Œæ•´çš„è§£å†³æ–¹æ¡ˆå¸®åŠ©ä¼ä¸šè½»æ¾åº”å¯¹æ•æ·å¼€å‘ä¸è‡ªåŠ¨åŒ–è¿ç»´ã€DevOpsã€å¾®æœåŠ¡æ²»ç†ã€ç°åº¦å‘å¸ƒã€å¤šç§Ÿæˆ·ç®¡ç†ã€å·¥ä½œè´Ÿè½½å’Œé›†ç¾¤ç®¡ç†ã€ç›‘æ§å‘Šè­¦ã€æ—¥å¿—æŸ¥è¯¢ä¸æ”¶é›†ã€æœåŠ¡ä¸ç½‘ç»œã€åº”ç”¨å•†åº—ã€é•œåƒæ„å»ºä¸é•œåƒä»“åº“ç®¡ç†å’Œå­˜å‚¨ç®¡ç†ç­‰å¤šç§ä¸šåŠ¡åœºæ™¯ã€‚åç»­ç‰ˆæœ¬è¿˜å°†æä¾›å’Œæ”¯æŒå¤šé›†ç¾¤ç®¡ç†ã€å¤§æ•°æ®ã€äººå·¥æ™ºèƒ½ç­‰æ›´ä¸ºå¤æ‚çš„ä¸šåŠ¡åœºæ™¯ã€‚\nå› ä¸ºåŠŸèƒ½é½å…¨ï¼Œæ˜¾å¾—ç”¨èµ·æ¥ç›¸å¯¹å¾ˆç¬¨é‡ï¼Œkubesphereæ”¯æŒåœ¨çº¿å’Œç¦»çº¿å®‰è£…ï¼Œå¦‚æœæƒ³è¦ä½“éªŒï¼Œå¯ä»¥å…ˆæœ€å°åŒ–å®‰è£…ä¸€ä¸‹è¯•è¯•ï¼Œkubesphereè¿˜æœ‰devopsï¼Œloggingï¼Œservice meshï¼Œå‘Šè­¦é€šçŸ¥ç­‰å¯ä»¥æŒ‰éœ€å°è¯•ä½“éªŒã€‚\nWayne æ˜¯360å¼€æºçš„ä¸€ä¸ªé€šç”¨çš„ã€åŸºäº Web çš„ Kubernetes å¤šé›†ç¾¤ç®¡ç†å¹³å°ã€‚é€šè¿‡å¯è§†åŒ– Kubernetes å¯¹è±¡æ¨¡æ¿ç¼–è¾‘çš„æ–¹å¼ï¼Œé™ä½ä¸šåŠ¡æ¥å…¥æˆæœ¬ï¼Œ æ‹¥æœ‰å®Œæ•´çš„æƒé™ç®¡ç†ç³»ç»Ÿï¼Œé€‚åº”å¤šç§Ÿæˆ·åœºæ™¯ï¼Œæ˜¯ä¸€æ¬¾é€‚åˆä¼ä¸šçº§é›†ç¾¤ä½¿ç”¨çš„å‘å¸ƒå¹³å°ã€‚Wayneå·²å¤§è§„æ¨¡æœåŠ¡äº360æœç´¢ï¼Œæ‰¿è½½äº†å†…éƒ¨ç»å¤§éƒ¨åˆ†ä¸šåŠ¡ï¼Œç¨³å®šç®¡ç†äº†è¿‘åƒä¸ªä¸šåŠ¡ï¼Œä¸Šä¸‡ä¸ªå®¹å™¨ï¼Œè¿è¡Œäº†ä¸¤å¹´å¤šæ—¶é—´ï¼Œç»å—ä½äº†ç”Ÿäº§çš„è€ƒéªŒã€‚\nwayneçš„åŠŸèƒ½ç‰¹æ€§\n è§†åŒ–æ“ä½œï¼šæä¾›ç›´è§‚ã€ç®€ä¾¿çš„æ–¹å¼æ“ä½œ Kubernetes é›†ç¾¤ï¼Œå‡å°å­¦ä¹ æˆæœ¬ï¼Œå¿«é€Ÿä¸Šçº¿ä¸šåŠ¡ã€‚ å¤šæ ·çš„ç¼–è¾‘æ¨¡å¼ï¼šæ”¯æŒå›¾å½¢åŒ–ç¼–è¾‘ï¼Œä¹Ÿæ”¯æŒ Jsonã€Yaml ä¸¤ç§é«˜çº§å®šåˆ¶åŒ–ç¼–è¾‘æ¨¡å¼ã€‚ å¾®å†…æ ¸æ¶æ„ï¼šé‡‡ç”¨å¯æ‰©å±•çš„æ’ä»¶åŒ–æ–¹å¼å¼€å‘ï¼Œå®šåˆ¶åŒ–é€‰æ‹©ç‰¹æ€§åŠŸèƒ½ï¼Œæ›´æ–¹ä¾¿çš„é›†æˆç¬¦åˆä¼ä¸šéœ€æ±‚çš„æ–°åŠŸèƒ½ã€‚ å¤šé›†ç¾¤ç®¡ç†ï¼šå¯ä»¥åŒæ—¶ç®¡ç†å¤šä¸ª Kubernetes é›†ç¾¤ï¼Œæ›´æ–¹ä¾¿çš„ç®¡ç†å¤šä¸ªé›†ç¾¤ã€‚ ä¸°å¯Œçš„æƒé™ç®¡ç†ï¼šå°†èµ„æºæŠ½è±¡åŒ–ä¸ºéƒ¨é—¨ã€é¡¹ç›®çº§åˆ«ï¼Œè§’è‰²çš„æƒé™å¯ä»¥æ›´ç»†åŒ–çš„æ§åˆ¶ï¼Œé€‚ç”¨äºå¤šéƒ¨é—¨ã€å¤šé¡¹ç›®çš„ç»Ÿä¸€é›†ä¸­ç®¡ç†ã€‚ å¤šç§ç™»å½•æ¨¡å¼ï¼šæ”¯æŒä¼ä¸šçº§ LDAP ç™»å½•ã€æ”¯æŒ OAuth2 ç™»å½•ï¼Œæ”¯æŒæ•°æ®åº“ç™»å½•å¤šç§æ¨¡å¼ã€‚ å®Œå¤‡çš„å®¡è®¡ï¼šæ‰€æœ‰æ“ä½œéƒ½ä¼šæœ‰å®Œæ•´çš„å®¡è®¡åŠŸèƒ½ï¼Œæ–¹ä¾¿è¿½è¸ªæ“ä½œå†å²ã€‚ å¼€æ”¾å¹³å°ï¼šæ”¯æŒ APIKey å¼€æ”¾å¹³å°ï¼Œç”¨æˆ·å¯è‡ªä¸»ç”³è¯·ç›¸å…³ APIKey å¹¶ç®¡ç†è‡ªå·±çš„é¡¹ç›®ã€‚ å¤šå±‚æ¬¡ç›‘æ§ï¼šæä¾›å¤šçº§åˆ«çš„ç›‘æ§ç»Ÿè®¡ä¿¡æ¯ï¼Œå®æ—¶å…³æ³¨é›†ç¾¤çš„è¿è¡ŒçŠ¶æ€ã€‚  Kubernetes Dashbaord Kubernetesä»ªè¡¨æ¿æ˜¯Kubernetesé›†ç¾¤çš„åŸºäºWebçš„é€šç”¨UIã€‚å®ƒå…è®¸ç”¨æˆ·ç®¡ç†ç¾¤é›†ä¸­è¿è¡Œçš„åº”ç”¨ç¨‹åºå¹¶å¯¹å…¶è¿›è¡Œæ•…éšœæ’é™¤ï¼Œä»¥åŠç®¡ç†ç¾¤é›†æœ¬èº«ã€‚å¦‚æœæƒ³è¦æ­£å¸¸çš„æ˜¾ç¤ºèµ„æºçš„ä½¿ç”¨æƒ…å†µï¼Œéœ€è¦kubernetesé›†ç¾¤ä¸­æœ‰metrics-serverï¼Œå¹¶ä¸”åŸç”Ÿæ€çš„Kubernetes Dashboardä¸æ”¯æŒå…¶ä»–ç¬¬ä¸‰æ–¹è®¤è¯\n","description":"","id":32,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200629-kubernetes%E5%9B%BE%E5%BD%A2%E5%8C%96%E7%95%8C%E9%9D%A2/"},{"content":"YamlåŸºç¡€è¯­æ³•ä¸æŠ€å·§  å­—ç¬¦æ”¯æŒï¼šYAMLæ”¯æŒUnicodeå­—ç¬¦é›†ï¼Œå¯ä»¥ä½¿ç”¨UTF-8ã€UTF-16ã€UTF-32å­—ç¬¦é›†  1 2 3 4 5 6  date:2020-06-28info:- name:Marionxuetags:- num:1- descript:\u0026#34;writing somthing here\u0026#34;   ç¼©è¿›ï¼šYAMLä¸­ç¼©è¿›æ˜¯éå¸¸é‡è¦çš„è§„èŒƒï¼Œä¸æ”¯æŒTabï¼Œæ”¯æŒç©ºæ ¼ï¼Œæ²¡æœ‰ä¸¥æ ¼è¦æ±‚ç©ºæ ¼ä¸ªæ•°ï¼Œä½†æ˜¯éœ€è¦ç¡®ä¿åŒä¸€å±‚æ¬¡çš„å·¦ä¾§å¯¹é½ å•è¡Œæ³¨é‡Šï¼šå•è¡Œæ³¨é‡Šä½¿ç”¨#è¿›è¡Œæ ‡è®°ï¼Œå¯ä»¥åœ¨å•è¡Œçš„ä»»ä½•ä½ç½®å¼€å§‹æ³¨é‡Šçš„å†…å®¹ å¤šè¡Œæ³¨é‡Šï¼šä¸æä¾›ç‰¹æ®Šçš„å¤šè¡Œæ³¨é‡Šï¼Œä½¿ç”¨å¤šè¡Œè¡Œé¦–çš„å•è¡Œæ³¨é‡Š#å®ç°å¤šè¡Œæ³¨é‡Šçš„éœ€æ±‚  1 2 3  info:# ä¸‹é¢æ˜¯ä¸¤ä¸ªç©ºæ ¼ï¼Œç„¶åä¸€ä¸ªçŸ­æ¨ªçº¿- name:Marionxue   åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ”¯æŒæ•´å‹ã€æµ®ç‚¹å‹ã€æ—¶é—´æˆ³ç±»å‹ã€Nullç­‰åŸºæœ¬æ•°æ®ç±»å‹ ç»„åˆæ•°æ®ç±»å‹ï¼šæ”¯æŒé”®/å€¼æ–¹å¼å’Œåˆ—è¡¨ç±»å‹ï¼Œå¹¶å¯è¿›è¡ŒåµŒå¥—ç»„åˆ é”®/å€¼æ–¹å¼ï¼šä½¿ç”¨å†’å·:è¿›è¡Œåˆ†éš”ï¼Œä¹Ÿå¯ä½¿ç”¨{}ç»“åˆé€—å·è¿›è¡Œè¡¨è¾¾ åˆ—è¡¨ç±»å‹ï¼šä½¿ç”¨æ¨ªçº¿-è¿›è¡Œåˆ†éš”ï¼Œä¹Ÿå¯ä½¿ç”¨[]ç»“åˆé€—å·è¿›è¡Œè¡¨è¾¾ å¼€å§‹ç¬¦å·: ---ç”¨äºè¡¨ç¤ºå¼€å§‹çš„ç¬¦å·ï¼Œåœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­åŒ…å«å¤šä¸ªYAMLè®¾å®šçš„æ—¶å€™ä½¿ç”¨éå¸¸å¸¸è§ã€‚ ç»“æŸç¬¦å·ï¼šâ€¦ç”¨äºè¡¨ç¤ºyamlæ–‡ä»¶ç»“æŸ  1 2 3 4 5 6 7 8 9 10  ---# start- [blue,red,green]#list- [Age,Bag]- site:{osc:www.oschina.net, baidu:www.baidu.com}# key/value list- describle:| Hi,all:mynameisxxx.- code:\u0026gt; fmt.Println(\u0026#34;å§“å: %s\u0026#34;,name)    å•å¼•å·ä¸åŒå¼•å·ï¼šå­—ç¬¦ä¸²ç±»å‹å¯ä»¥ä¸ä½¿ç”¨å•å¼•å·å’ŒåŒå¼•å·ï¼Œä½¿ç”¨å•å¼•å·å’ŒåŒå¼•å·ä¸ä¸ä½¿ç”¨çš„æ—¶å€™åœ¨ç‰¹æ®Šå­—ç¬¦åŠå…¶è½¬ä¹‰çš„æ—¶å€™æœ‰äº›ç»†å¾®çš„åŒºåˆ«ï¼Œå¯ç”¨å€’æ–œçº¿**ï¼ˆ\\ï¼‰**è¿›è¡Œç‰¹æ®Šå­—ç¬¦è½¬ä¹‰\n  åŒºå—çš„å­—ä¸²ç”¨ç¼©æ’å’Œä¿®é¥°è¯ï¼ˆéå¿…è¦ï¼‰æ¥å’Œå…¶ä»–èµ„æ–™åˆ†éš”ï¼Œæœ‰æ–°è¡Œä¿ç•™ï¼ˆä½¿ç”¨ç¬¦å·|ï¼‰æˆ–æ–°è¡ŒæŠ˜å ï¼ˆä½¿ç”¨ç¬¦å·\u0026gt;ï¼‰ä¸¤ç§æ–¹å¼\n |è¡¨ç¤ºä¿ç•™åŒºå—ä¸­çš„å›è½¦æ¢è¡Œ \u0026gt;è¡¨ç¤ºå°†åŒºå—ä¸­çš„å›è½¦æ¢è¡Œæ›¿æ¢ä¸ºç©ºè¡Œï¼Œæœ€ç»ˆè¿æˆä¸€è¡Œ     å¼ºåˆ¶ç±»å‹è½¬æ¢ï¼šå¯ä»¥ä½¿ç”¨!!ç”¨äºå¼ºåˆ¶ç±»å‹è½¬æ¢\né‡å¤æ€§å†…å®¹ï¼šå¯ä»¥ä½¿ç”¨é”šç‚¹æ ‡è®°\u0026amp;å’Œåº”ç”¨æ ‡è®°*ç»“åˆä½¿ç”¨å¯ä»¥å¤„ç†é‡å¤æ€§çš„å†…å®¹\nä¿ç•™å­—ç¬¦ï¼š@å’Œ`ä¸ºå½“å‰YAMLè§„æ ¼çš„ä¿ç•™å­—ç¬¦\nè¾ƒé•¿çš„æç»˜æ€§è¯´æ˜ï¼šä½¿ç”¨|ä¸\u0026gt;ä»¥åŠ\u0026gt;-æ¥å¤„ç†å¸¸è§çš„å¯¹äºè¾ƒé•¿çš„æç»˜æ€§è¯´æ˜çš„è¦æ±‚\nç©ºç™½å­—ç¬¦é™åˆ¶ï¼šåœ¨ä½¿ç”¨é€—å·åŠå†’å·æ—¶ï¼Œåé¡»æ¥ä¸€ä¸ªç©ºç™½å­—ç¬¦   YAMLä½¿ç”¨å¯æ‰“å°çš„Unicodeå­—ç¬¦ï¼Œå¯ä½¿ç”¨UTF-8æˆ–UTF-16 ä½¿ç”¨ç©ºç™½å­—ç¬¦**ï¼ˆä¸èƒ½ä½¿ç”¨Tabï¼‰**åˆ†å±‚ï¼ŒåŒå±‚å…ƒç´ å·¦ä¾§å¯¹é½ å•è¡Œæ³¨è§£ç”±äº•å­—å·**ï¼ˆ # ï¼‰**å¼€å§‹ï¼Œå¯ä»¥å‡ºç°åœ¨è¡Œä¸­ä»»ä½•ä½ç½® æ¯ä¸ªæ¸…å•æˆå‘˜ä»¥å•è¡Œè¡¨ç¤ºï¼Œå¹¶ç”¨çŸ­æ +ç©ºç™½**ï¼ˆ- ï¼‰**èµ·å§‹ æ¯ä¸ªæ‚å‡‘è¡¨çš„æˆå‘˜ç”¨å†’å·+ç©ºç™½**ï¼ˆ: ï¼‰**åˆ†å¼€é”®å’Œå€¼ æ‚å‡‘è¡¨çš„é”®å€¼å¯ä»¥ç”¨é—®å· **(?)**èµ·å§‹ï¼Œè¡¨ç¤ºå¤šä¸ªè¯æ±‡ç»„æˆçš„é”®å€¼ å­—ä¸²ä¸€èˆ¬ä¸ä½¿ç”¨å¼•å·ï¼Œä½†å¿…è¦çš„æ—¶å€™å¯ä»¥ç”¨å¼•å·æ¡†ä½ ä½¿ç”¨åŒå¼•å·è¡¨ç¤ºå­—ä¸²æ—¶ï¼Œå¯ç”¨å€’æ–œçº¿**ï¼ˆ\\ï¼‰**è¿›è¡Œç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ åŒºå—çš„å­—ä¸²ç”¨ç¼©æ’å’Œä¿®é¥°è¯ï¼ˆéå¿…è¦ï¼‰æ¥å’Œå…¶ä»–èµ„æ–™åˆ†éš”ï¼Œæœ‰æ–°è¡Œä¿ç•™ï¼ˆä½¿ç”¨ç¬¦å·|ï¼‰æˆ–æ–°è¡ŒæŠ˜å ï¼ˆä½¿ç”¨ç¬¦å·\u0026gt;ï¼‰ä¸¤ç§æ–¹å¼ åœ¨å•ä¸€æ¡£æ¡ˆä¸­ï¼Œå¯ç”¨è¿ç»­ä¸‰ä¸ªè¿å­—å·ï¼ˆ\u0026mdash;ï¼‰åŒºåˆ†å¤šä¸ªæ¡£æ¡ˆ å¯é€‰æ‹©æ€§çš„è¿ç»­ä¸‰ä¸ªç‚¹å·ï¼ˆ\u0026hellip;ï¼‰ç”¨æ¥è¡¨ç¤ºæ¡£æ¡ˆç»“å°¾(åœ¨æµå¼ä¼ è¾“æ—¶éå¸¸æœ‰ç”¨ï¼Œä¸éœ€è¦å…³é—­æµå³å¯çŸ¥é“åˆ°è¾¾ç»“å°¾å¤„) é‡å¤çš„å†…å®¹å¯ä½¿ä»å‚è€ƒæ ‡è®°æ˜Ÿå· (*)å¤åˆ¶åˆ°é”šç‚¹æ ‡è®°ï¼ˆ\u0026amp;ï¼‰ æŒ‡å®šæ ¼å¼å¯ä»¥ä½¿ç”¨ä¸¤ä¸ªæƒŠå¹å· ( !! )ï¼Œåé¢æ¥ä¸Šåç§°  ","description":"","id":33,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200629-yaml%E8%AF%AD%E6%B3%95%E6%A0%BC%E5%BC%8F%E5%AD%A6%E4%B9%A0/"},{"content":"æ—¥å¿—ç±»æŸ¥çœ‹ 1  dmesg -T   ","description":"","id":34,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200630-linux%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E9%94%A6%E5%9B%8A/"},{"content":"2020å¹´6æœˆ24æ—¥ï¼ŒBFEå¼€æºé¡¹ç›®è¢«CNCF ï¼ˆCloud Native Computing Foundationï¼Œäº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šï¼‰æ­£å¼æ¥çº³ä¸ºSandbox Projectã€‚è¿™æ˜¯ç™¾åº¦ç¬¬ä¸€ä¸ªè¢«CNCFæ¥çº³çš„å¼€æºé¡¹ç›®ï¼Œä¹Ÿæ˜¯åœ¨ç½‘ç»œæ–¹å‘ä¸Šä¸­å›½ç¬¬ä¸€ä¸ªè¢«CNCFæ¥çº³çš„å¼€æºé¡¹ç›®ã€‚\nBFEåŸåä¸ºBaidu Front Endï¼ˆç™¾åº¦ç»Ÿä¸€å‰ç«¯ï¼‰ï¼Œæ˜¯ç™¾åº¦çš„ç»Ÿä¸€ä¸ƒå±‚æµé‡è½¬å‘å¹³å°ã€‚BFEå¹³å°ç›®å‰å·²æ¥å…¥ç™¾åº¦å¤§éƒ¨åˆ†æµé‡ï¼Œæ¯æ—¥è½¬å‘è¯·æ±‚æ¥è¿‘1ä¸‡äº¿ï¼Œå³°å€¼QPSè¶…è¿‡1000ä¸‡ã€‚åœ¨2019å¹´ç™¾åº¦æ˜¥æ™šçº¢åŒ…æ´»åŠ¨ä¸­ï¼ŒBFEå¹³å°åœ¨è¶…å¤§ç”¨æˆ·å‹åŠ›ã€æ•°æ¬¡æµé‡æ³¢å³°ä¸‹å¹³ç¨³è¿è¡Œï¼Œä¿è¯äº†æ˜¥æ™šçº¢åŒ…æ´»åŠ¨çš„é¡ºåˆ©è¿›è¡Œã€‚\nä½œä¸ºç»¼åˆçš„æµé‡è½¬å‘å¹³å°ï¼ŒBFEå¹³å°é›†æˆäº†ä»¥ä¸‹4å¤§åŠŸèƒ½ï¼š\n æµé‡æ¥å…¥å’Œè½¬å‘ï¼šæ”¯æŒHTTPã€HTTPSã€HTTP/2ã€QUICç­‰å¤šç§åè®®ï¼Œå¹¶æ”¯æŒå¼ºå¤§çš„åº”ç”¨å±‚è·¯ç”±èƒ½åŠ› æµé‡å…¨å±€è°ƒåº¦ï¼šæ”¯æŒç”±å¤–ç½‘æµé‡è°ƒåº¦å’Œå†…ç½‘æµé‡è°ƒåº¦å…±åŒæ„æˆçš„å…¨å±€æµé‡è°ƒåº¦ç³»ç»Ÿ å®‰å…¨å’Œé˜²æ”»å‡»ï¼šæ”¯æŒé»‘åå•å°ç¦ã€ç²¾ç»†é™æµå’Œåº”ç”¨å±‚é˜²ç«å¢™ï¼ˆWAFï¼‰ç­‰å¤šç§é˜²æ”»å‡»èƒ½åŠ› å®æ—¶æ•°æ®åˆ†æï¼šæ”¯æŒåˆ†é’Ÿçº§çš„è¶…é«˜ç»´åº¦æ—¶åºæŠ¥è¡¨  ä½œä¸ºBFEå¹³å°çš„æ ¸å¿ƒç»„ä»¶ï¼ŒBFEè½¬å‘å¼•æ“ä»2012å¹´å¼€å§‹ç ”å‘ï¼Œå¹¶äº2014å¹´ä½¿ç”¨Goè¯­è¨€å®Œæˆé‡æ„ã€‚ç”±äºåŸºäºGoè¯­è¨€ï¼Œå’Œä¸šç•Œæ™®éä½¿ç”¨çš„Nginxå¼€æºè½¯ä»¶ç›¸æ¯”ï¼ŒBFEå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š\n ç ”å‘æ•ˆç‡é«˜ï¼šGoè¯­è¨€çš„å¼€å‘æ•ˆç‡è¿œé«˜äºCè¯­è¨€ï¼ˆåŠLuaï¼‰ï¼Œåœ¨ä»£ç çš„å¯ç»´æŠ¤æ€§æ–¹é¢ä¹Ÿæœ‰å·¨å¤§ä¼˜åŠ¿ã€‚ ç³»ç»Ÿçš„å®‰å…¨å’Œç¨³å®šæ€§é«˜ï¼šGoè¯­è¨€æ²¡æœ‰Cè¯­è¨€å›ºæœ‰çš„ç¼“å†²åŒºæº¢å‡ºéšæ‚£ï¼Œè§„é¿äº†å¤§é‡çš„ç¨³å®šæ€§å’Œå®‰å…¨é£é™©ï¼›å¦å¤–å¯¹äºå¼‚å¸¸å¯ä»¥æ•æ‰ï¼Œä¿è¯ç¨‹åºåœ¨å¿«é€Ÿè¿­ä»£ä¸Šçº¿çš„æƒ…å†µä¸‹ä¹Ÿä¸å´©æºƒã€‚  æœ‰ç†ç”±ç›¸ä¿¡ï¼Œä»é•¿æœŸè¶‹åŠ¿çœ‹ï¼ŒåŸºäºæ›´é«˜çº§ç¼–ç¨‹è¯­è¨€çš„è½¯ä»¶ç³»ç»Ÿä¼šé€æ­¥å–å¾—ç«äº‰çš„ä¼˜åŠ¿ã€‚\nCPUç­‰ç¡¬ä»¶èµ„æºçš„ä»·æ ¼ä»ä¼šå¿«é€Ÿä¸‹é™ï¼Œè€Œå¼€å‘äººåŠ›æˆæœ¬ã€é¡¹ç›®ç ”å‘é£é™©ã€ç³»ç»Ÿç¨³å®šæ€§/å®‰å…¨æ€§æ–¹é¢ä¼šæˆä¸ºæ›´é‡è¦çš„å†³ç­–è€ƒè™‘ã€‚ä»è¿™æ–¹é¢å‡ºå‘ï¼Œä¸»è¦åŸºäºCè¯­è¨€çš„Nginxä¼šé€æ­¥è¡°è½ï¼Œè€Œç±»ä¼¼BFEè¿™æ ·çš„åŸºäºæ›´é«˜çº§ç¼–ç¨‹è¯­è¨€çš„è½¯ä»¶ä¼šé€æ­¥æˆä¸ºä¸»æµã€‚\nå¦å¤–ï¼ŒBFEåœ¨è®¾è®¡ä¸­ï¼Œè¿˜ç‰¹åˆ«å¢åŠ äº†ä¼ä¸šçº§åº”ç”¨åœºæ™¯çš„è€ƒè™‘ï¼š\n è½¬å‘åœºæ™¯çš„ç›´æ¥æ”¯æŒï¼šå’ŒNginxè¿™æ ·ä»Web Serverè½¬å‹ä¸ºProxyçš„è¿›åŒ–è·¯å¾„ä¸åŒï¼ŒBFEç›´æ¥ä¸ºè½¬å‘åœºæ™¯è®¾è®¡ï¼Œä»è½¬å‘æ¨¡å‹å’Œè½¬å‘é…ç½®æ–¹é¢æ›´æ»¡è¶³è½¬å‘åœºæ™¯çš„éœ€æ±‚ å¤šç§Ÿæˆ·çš„æ”¯æŒï¼šåœ¨äº‘è®¡ç®—çš„åœºæ™¯ä¸‹ï¼Œå¤šç§Ÿæˆ·å¤ç”¨æ˜¯æ™®éçš„éœ€æ±‚ã€‚åœ¨BFEçš„è®¾è®¡ä¸­ï¼Œå†…ç½®æä¾›äº†å¤šç§Ÿæˆ·çš„æ”¯æŒã€‚ ç»“æ„åŒ–çš„é…ç½®ï¼šBFEçš„é…ç½®è®¾è®¡ï¼Œå¤§é‡ä½¿ç”¨JSONè¿™æ ·çš„ç»“æ„åŒ–æ–¹å¼ï¼Œä¾¿äºå’Œç›¸å…³é…ç½®ç®¡ç†ç³»ç»Ÿå¯¹æ¥ ä¸°å¯Œçš„ç›‘æ§æ¢é’ˆï¼šä½œä¸ºä¸€ä¸ªå·¥ä¸šçº§è½¯ä»¶ï¼Œåœ¨BFEçš„è®¾è®¡ä¸­å……åˆ†è€ƒè™‘äº†çº¿ä¸Šç›‘æ§çš„éœ€æ±‚ï¼ŒBFEç¨‹åºé€šè¿‡HTTPæ–¹å¼å‘å¤–æš´éœ²æ•°åƒä¸ªå†…éƒ¨çŠ¶æ€å˜é‡  ä¸ºäº†ä¿ƒè¿›è´Ÿè½½å‡è¡¡æŠ€æœ¯çš„äº¤æµå’Œå‘å±•ï¼ŒBFEçš„è½¬å‘å¼•æ“äº2019å¹´7æœˆæ­£å¼å¼€æºï¼Œå¹¶è·å¾—äº†å¹¿æ³›çš„å…³æ³¨ã€‚2019å¹´11æœˆ19æ—¥ï¼ŒBFEå¼€æºé¡¹ç›®ç™»ä¸ŠGitHub Trending Top 3ã€‚2019å¹´12æœˆï¼ŒBFEå¼€æºé¡¹ç›®çš„Github starsè¶…è¿‡3000ã€‚\nBFEå¼€æºæ”¯æŒä»¥ä¸‹é‡è¦èƒ½åŠ›ï¼š\n1ã€ä¸»æµç½‘ç»œåè®®æ¥å…¥\n æ”¯æŒHTTP/HTTPS/SPDY/HTTP2/WebSocketç­‰ æ”¯æŒTLS/HTTP/ WebSocketåå‘ä»£ç†æ¨¡å¼  2ã€å¯æ‰©å±•æ’ä»¶æ¡†æ¶\n é€šè¿‡å¯æ‰©å±•æ’ä»¶æ¡†æ¶ï¼Œå¿«é€Ÿå®šåˆ¶å¼€å‘æ‰©å±•æ¨¡å—ï¼Œæ»¡è¶³ä¸šåŠ¡å®šåˆ¶åŒ–éœ€æ±‚ å†…ç½®é‡å†™ã€é‡å®šå‘ã€æµé‡ä¿®æ”¹ã€å°ç¦ç­‰ä¸°å¯Œæ’ä»¶  3ã€åŸºäºè¯·æ±‚å†…å®¹çš„åˆ†æµ\n åŸºäºé¢†åŸŸä¸“æœ‰è¯­è¨€çš„åˆ†æµè§„åˆ™ï¼Œæ»¡è¶³å¤æ‚ä¸šåŠ¡åœºæ™¯å®šåˆ¶åŒ–æµé‡è½¬å‘ æ”¯æŒå®Œå¤‡çš„åˆ†æµæ¡ä»¶åŸè¯­é›†ï¼ŒåŒ…æ‹¬åŸºäºè¯·æ±‚å†…å®¹ï¼ˆURI/Header/Cookieç­‰ï¼‰ä»¥åŠè¯·æ±‚ä¸Šä¸‹æ–‡ï¼ˆIPã€åè®®ã€æ ‡ç­¾ã€æ—¶é—´ç­‰ï¼‰çš„æ¡ä»¶åŸè¯­ã€‚  4ã€çµæ´»çš„è´Ÿè½½å‡è¡¡ç­–ç•¥\n æ”¯æŒé›†ç¾¤çº§åˆ«è´Ÿè½½å‡è¡¡åŠå®ä¾‹çº§åˆ«è´Ÿè½½å‡è¡¡ï¼Œå®ç°å¤šå¯ç”¨åŒºå®¹ç¾åŠè¿‡è½½ä¿æŠ¤ å†…ç½®åŠ æƒè½®è¯¢ã€åŠ æƒæœ€å°è¿æ¥æ•°ç­–ç•¥ï¼ŒåŸºäºIPæˆ–è¯·æ±‚å†…å®¹è¯†åˆ«ç”¨æˆ·å®ç°ä¼šè¯ä¿æŒ  CNCFæ˜¯äº‘è®¡ç®—é¢†åŸŸå…¨çƒé¡¶çº§çš„å¼€æºç¤¾åŒºã€‚BFEå¼€æºé¡¹ç›®åœ¨2020å¹´å¯åŠ¨äº†åŠ å…¥CNCFçš„ç”³è¯·å·¥ä½œã€‚ç»è¿‡ä¸€ç³»åˆ—çš„å‡†å¤‡å·¥ä½œï¼Œäº2020å¹´6æœˆ18æ—¥é€šè¿‡CNCF SIG-NETWORKçš„ç­”è¾©ï¼Œå¹¶åœ¨ä¸åˆ°ä¸€å‘¨å†…æ”¶åˆ°äº†è¢«CNCF TOCæ¥å—çš„é€šçŸ¥ã€‚åœ¨åŠ å…¥CNCFåï¼ŒBFEå°†æ”¹åä¸ºBeyond Front Endã€‚\nBFEå¼€æºæŠ€æœ¯å·²åœ¨ç™¾åº¦å†…è¢«HTTPDNSã€äº‘åŠ é€Ÿã€BMLç­‰äº§å“ä½¿ç”¨ï¼Œå¹¶å°†å’Œç™¾åº¦çš„äº‘åŸç”Ÿäº§å“è¿›ä¸€æ­¥æ·±å…¥ç»“åˆã€‚BFEå•†ç”¨äº§å“å·²ç»è¢«åº¦å°æ»¡ã€å¤®è§†ç½‘ç­‰å®¢æˆ·é€‰ç”¨ï¼Œå¹¶å·²ç»åœ¨å¤šä¸ªå®¢æˆ·è¿›è¡Œäº†æµ‹è¯•éªŒè¯ã€‚BFEå°†è¿›ä¸€æ­¥æ‰©å¤§å¼€æºèŒƒå›´ï¼ŒåŠ å¼ºå¼€æºç”Ÿæ€çš„å»ºè®¾ï¼Œå¹¶åŸºäºå¼€æºå»ºç«‹ç™¾åº¦è´Ÿè½½å‡è¡¡çš„å•†ä¸šç”Ÿæ€ã€‚\n","description":"","id":35,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200701-%E7%99%BE%E5%BA%A6%E5%BC%80%E6%BA%90bfe%E8%A2%ABcncf%E6%8E%A5%E7%BA%B3%E4%B8%BAsandbox-project/"},{"content":"Etcdé›†ç¾¤çš„éƒ¨ç½²å®è·µ æˆ‘ä»¬å‡†å¤‡ä¸‰å°æœºå™¨ï¼Œåˆ†åˆ«åœ¨è¿™ä¸‰å°æœºå™¨ä¸Šå®‰è£…éƒ¨ç½²etcd\n1 2  wget https://github.com/etcd-io/etcd/releases/download/v3.4.9/etcd-v3.4.9-linux-amd64.tar.gz   åœ¨æ¯ä¸ªèŠ‚ç‚¹çš„æœºå™¨ä¸Šæ‰§è¡Œä¸€ä¸‹ç¯å¢ƒè®¾å®š\n1 2 3 4 5 6 7 8 9  TOKEN=token-01 CLUSTER_STATE=new NAME_1=machine-1 NAME_2=machine-2 NAME_3=machine-3 HOST_1=10.240.0.17 HOST_2=10.240.0.18 HOST_3=10.240.0.19 CLUSTER=${NAME_1}=http://${HOST_1}:2380,${NAME_2}=http://${HOST_2}:2380,${NAME_3}=http://${HOST_3}:2380   ","description":"","id":36,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200703-etcd%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA%E5%AE%9E%E8%B7%B5%E7%AF%87/"},{"content":"æ–‡ç« èƒŒæ™¯ æ—¥å¸¸çš„å·¥ä½œä¸­ï¼Œä¼šæ”¶åˆ°ä¸€å †CPUä½¿ç”¨ç‡è¿‡é«˜çš„å‘Šè­¦é‚®ä»¶ï¼Œé‡åˆ°æŸå°æœåŠ¡çš„CPUè¢«å æ»¡äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦å»æŸ¥çœ‹æ˜¯ä»€ä¹ˆè¿›ç¨‹å°†æœåŠ¡å™¨çš„CPUèµ„æºå ç”¨æ»¡äº†ã€‚é€šå¸¸æˆ‘ä»¬ä¼šé€šè¿‡topæˆ–è€…htopæ¥å¿«é€Ÿçš„æŸ¥çœ‹å æ®CPUæœ€é«˜çš„é‚£ä¸ªè¿›ç¨‹ï¼Œå¦‚ä¸‹å›¾ï¼š\nè¿™é‡Œæ˜¯é€šè¿‡ä¸€ä¸ªæ™®é€šçš„æœåŠ¡å™¨åšæ¼”ç¤ºä½¿ç”¨ï¼Œå¦‚å›¾æ‰€ç¤ºå½“å‰æœåŠ¡å™¨å ç”¨CPUæœ€é«˜çš„æ˜¯ä¸€ä¸ªå«åškube-apiserverå‘½ä»¤è¿è¡Œçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œè¯¥è¿›ç¨‹çš„PIDä¸º25633,å½“ç„¶ä½ å¯èƒ½é‡åˆ°ä¸€ä¸ªæœåŠ¡å™¨ä¸Šè¿è¡Œæœ‰å¤šä¸ªæœåŠ¡ï¼Œæƒ³å¿«é€ŸçŸ¥é“å ç”¨ç‡æœ€é«˜çš„é‚£å‡ ä¸ªè¿›ç¨‹çš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤:\n1 2  ps aux|head -1;ps -aux | sort -k3nr | head -n 10 //æŸ¥çœ‹å‰10ä¸ªæœ€å ç”¨CPUçš„è¿›ç¨‹ ps aux|head -1;ps -aux | sort -k4nr | head -n 10 //æŸ¥çœ‹å‰10ä¸ªæœ€å ç”¨å†…å­˜çš„è¿›ç¨‹   ä½†æ˜¯é€šè¿‡ä»¥ä¸Šçš„æ–¹æ³•è·å–åˆ°æœåŠ¡å™¨å ç”¨èµ„æºçš„è¿›ç¨‹ä¹‹åï¼Œè¿˜æ˜¯ä¸çŸ¥é“CPUä½¿ç”¨ç©¶ç«Ÿè€—æ—¶åœ¨å“ªé‡Œ,ä¸æ¸…æ¥šç“¶é¢ˆåœ¨å“ªé‡Œï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡Linuxç³»ç»Ÿçš„æ€§èƒ½åˆ†æå·¥å…·perfåˆ†æï¼Œåˆ†æå…¶è¿”å›çš„æ­£åœ¨æ¶ˆè€—CPUçš„å‡½æ•°ä»¥åŠè°ƒç”¨æ ˆã€‚ç„¶åå¯ä»¥é€šè¿‡è§£æperfé‡‡é›†çš„æ•°æ®ï¼Œæ¸²æŸ“åˆ°ç«ç„°å›¾ğŸ”¥ï¼Œå°±æ¸…æ¥šçš„çŸ¥é“ç©¶ç«Ÿå ç”¨ç³»ç»ŸCPUèµ„æºçš„ç½ªé­ç¥¸é¦–äº†ã€‚\nåœ¨åˆ¶ä½œç«ç„°å›¾ä¹‹å‰ï¼Œéœ€è¦å…ˆæ¥è¯´è¯´è¿™ä¸ªLinuxæ€§èƒ½åˆ†æå·¥å…·perf,è¯¥å·¥å…·æ˜¯ä¸€ä¸ªç›¸å¯¹ç®€å•æ˜“ä¸Šæ‰‹çš„æ€§èƒ½åˆ†æå·¥å…·ï¼Œæ˜¯Performanceå•è¯çš„ç¼©å†™ï¼Œé€šè¿‡å…¶perfçš„å‘½ä»¤é€‰é¡¹å®Œæˆç³»ç»Ÿäº‹ä»¶çš„é‡‡é›†åˆ°è§£æï¼Œæˆ‘ä»¬æ¥ç®€å•çš„è®¤è¯†ä¸€ä¸‹ï¼š\nlinuxä¸Šçš„æ€§èƒ½åˆ†æå·¥å…·Perf å®‰è£…perf æˆ‘ç›®å‰çš„æœåŠ¡å™¨å‘è¡Œç‰ˆæ˜¯Ubuntu 16.04.6 LTSå› æ­¤éœ€è¦å…ˆå®‰è£…perfæ‰èƒ½ä½¿ç”¨ï¼Œè¯¥å·¥å…·ç”±linux-tools-commonæä¾›ï¼Œä½†æ˜¯å®ƒéœ€è¦å®‰è£…åé¢çš„ä¾èµ–ã€‚\n1 2 3 4 5  #å®‰è£… root@master:~# apt install linux-tools-common linux-tools-4.4.0-142-generic linux-cloud-tools-4.4.0-142-generic -y root@master:~# perf -v #æ˜¾ç¤ºperfçš„ç‰ˆæœ¬ perf version 4.4.167   åœ¨å®‰è£…å®Œæˆæ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¯¹ä¸Šå›¾CPUä½¿ç”¨ç‡æœ€é«˜çš„è¿›ç¨‹IDä¸º25633çš„è¿›ç¨‹è¿›è¡Œé‡‡æ ·åˆ†æã€‚\né¦–é€‰æˆ‘ä»¬é‡‡é›†ä¸€ä¸‹è¯¥è¿›ç¨‹çš„è°ƒç”¨æ ˆä¿¡æ¯:\n1 2 3  root@master:~# sudo perf record -F 99 -p 25633 -g -- sleep 30 [ perf record: Woken up 1 times to write data ] [ perf record: Captured and wrote 0.039 MB perf.data (120 samples) ]   è¿™ä¸ªå‘½ä»¤ä¼šäº§ç”Ÿä¸€ä¸ªå¤§çš„æ•°æ®æ–‡ä»¶ï¼Œå–å†³ä¸ä½ é‡‡é›†çš„è¿›ç¨‹ä¸CPUçš„é…ç½®ï¼Œå¦‚æœä¸€å°æœåŠ¡å™¨æœ‰16ä¸ª CPUï¼Œæ¯ç§’æŠ½æ ·99æ¬¡ï¼ŒæŒç»­30ç§’ï¼Œå°±å¾—åˆ° 47,520 ä¸ªè°ƒç”¨æ ˆï¼Œé•¿è¾¾å‡ åä¸‡ç”šè‡³ä¸Šç™¾ä¸‡è¡Œã€‚ä¸Šé¢çš„å‘½ä»¤ä¸­ï¼Œperf recordè¡¨ç¤ºè®°å½•ï¼Œ-F 99è¡¨ç¤ºæ¯ç§’99æ¬¡ï¼Œ-p 25633æ˜¯è¿›ç¨‹å·ï¼Œå³å¯¹å“ªä¸ªè¿›ç¨‹è¿›è¡Œåˆ†æï¼Œ-gè¡¨ç¤ºè®°å½•è°ƒç”¨æ ˆï¼Œsleep 30åˆ™æ˜¯æŒç»­30ç§’ï¼Œå‚æ•°ä¿¡æ¯å¯ä»¥è§†æƒ…å†µè°ƒæ•´ã€‚ç”Ÿæˆçš„æ•°æ®é‡‡é›†æ–‡ä»¶åœ¨å½“å‰ç›®å½•ä¸‹ï¼Œåç§°ä¸ºperf.dataã€‚\nperf recordå‘½ä»¤å¯ä»¥ä»é«˜åˆ°ä½æ’åˆ—ç»Ÿè®¡æ¯ä¸ªè°ƒç”¨æ ˆå‡ºç°çš„ç™¾åˆ†æ¯”ï¼Œæ˜¾ç¤ºç»“æœå¦‚ä¸‹å›¾æ‰€ç¤º:\n1  root@master:~# sudo perf report -n --stdio   è¿™æ ·çš„æ•ˆæœå¯¹ä½¿ç”¨è€…æ¥è¯´è¿˜æ˜¯ä¸é‚£ä¹ˆç›´è§‚æ˜“è¯»ï¼Œè¿™æ—¶å€™ï¼Œç«ç„°ğŸ”¥å›¾ä¹Ÿå°±çœŸæ­£çš„æ´¾ä¸Šç”¨é€”äº†ã€‚\nåˆ¶ä½œç«ç„°ğŸ”¥å›¾ ç«ç„°ğŸ”¥å›¾å¹¶éä¸€å®šå°±æ˜¯ç«ç„°ç³»åˆ—çš„é¢œè‰²ä¸»é¢˜ï¼Œåªæ˜¯é€šè¿‡ğŸ”¥è‰²ç³»æ›´èƒ½è¡¨è¾¾å‡ºå«ä¹‰ã€‚ç«ç„°å›¾å¸¸è§çš„ç±»å‹æœ‰ On-CPU, Off-CPU, è¿˜æœ‰ Memory, Hot/Cold, [Differential](http://www.brendangregg.com/blog/2014-11-09/differential-flame-graphs.html \u0026quot;Differential\u0026quot;) ç­‰ç­‰. on-CPU/off-cpu`çš„åŒºåˆ«å°±æ˜¯ä¸€ä¸ªæ˜¯ç”¨äºCPUæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œä¸€ä¸ªæ˜¯IOæ˜¯æ€§èƒ½ç“¶é¢ˆï¼Œå½“ä½ ä¸çŸ¥é“å½“å‰çš„æœåŠ¡å™¨çš„æ€§èƒ½ç“¶é¢ˆç©¶ç«Ÿæ˜¯ä»€ä¹ˆçš„æ—¶å€™ï¼Œä½ å¯ä»¥ä½¿ç”¨è¿™ä¸¤ç§ç±»å‹è¿›è¡Œå¯¹æ¯”ï¼Œé€šè¿‡ä¸¤ç§ç«ç„°å›¾çš„å·®åˆ«æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå¦‚æœä¸¤å¼ ç«ç„°å›¾é•¿å¾—å·®ä¸å¤š, é‚£ä¹ˆé€šå¸¸è®¤ä¸ºCPUè¢«å…¶å®ƒè¿›ç¨‹æŠ¢å äº†.\nå¦å¤–ä¸€ç§æƒ…å†µå°±æ˜¯å¦‚æœæ— æ³•ç¡®å®šå½“å‰çš„ç³»ç»Ÿç“¶é¢ˆ, å¯ä»¥é€šè¿‡å‹æµ‹å·¥å…·æ¥ç¡®è®¤ : é€šè¿‡å‹æµ‹å·¥å…·çœ‹çœ‹èƒ½å¦è®©CPUä½¿ç”¨ç‡è¶‹äºé¥±å’Œ, å¦‚æœèƒ½é‚£ä¹ˆä½¿ç”¨ On-CPU ç«ç„°å›¾, å¦‚æœä¸ç®¡æ€ä¹ˆå‹, CPU ä½¿ç”¨ç‡å§‹ç»ˆä¸Šä¸æ¥, é‚£ä¹ˆå¤šåŠè¯´æ˜ç¨‹åºè¢« IO æˆ–é”å¡ä½äº†, æ­¤æ—¶é€‚åˆä½¿ç”¨ Off-CPU ç«ç„°å›¾. ä½ å¯ä»¥é€šè¿‡å‹æµ‹å·¥å…·è¿›è¡Œæµ‹è¯•ï¼Œç›®å‰æ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯abå’Œwrkï¼Œæˆ‘å»ºè®®å°è¯•ä½¿ç”¨è¯¸å¦‚ wrk ä¹‹ç±»æ›´ç°ä»£çš„å‹æµ‹å·¥å…·.\n å¦‚æœé€‰æ‹© ab çš„è¯, é‚£ä¹ˆåŠ¡å¿…è®°å¾—å¼€å¯ -k é€‰é¡¹, ä»¥é¿å…è€—å°½ç³»ç»Ÿçš„å¯ç”¨ç«¯å£\n Githubä¸Šæœ‰Brendan D. Gregg çš„ Flame Graph å·¥ç¨‹å®ç°äº†ä¸€å¥—ç”Ÿæˆç«ç„°å›¾çš„è„šæœ¬.æˆ‘ä»¬å¯ä»¥ç›´æ¥å…‹éš†ä¸‹æ¥ç›´æ¥ç”¨ã€‚\n1  cd \u0026amp;\u0026amp; git clone https://github.com/brendangregg/FlameGraph.git   ç”Ÿæˆç«ç„°ğŸ”¥å›¾ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½éµå¾ªä»¥ä¸‹æµç¨‹\n æ•è·å †æ ˆ: ä½¿ç”¨perfæ•æ‰è¿›ç¨‹è¿è¡Œå †æ ˆä¿¡æ¯ æŠ˜å å †æ ˆ: å¯¹æŠ“å–çš„ç³»ç»Ÿå’Œç¨‹åºè¿è¡Œæ¯ä¸€æ—¶åˆ»çš„å †æ ˆä¿¡æ¯è¿›è¡Œåˆ†æç»„åˆ, å°†é‡å¤çš„å †æ ˆç´¯è®¡åœ¨ä¸€èµ·, ä»è€Œä½“ç°å‡ºè´Ÿè½½å’Œå…³é”®è·¯å¾„ï¼Œé€šè¿‡stackcollapseè„šæœ¬å®Œæˆ ç”Ÿæˆç«ç„°å›¾ï¼šåˆ†æ stackcollapse è¾“å‡ºçš„å †æ ˆä¿¡æ¯æ¸²æŸ“æˆç«ç„°å›¾  Flame Graphä¸­æä¾›äº†æŠ“å–ä¸åŒä¿¡æ¯çš„è„šæœ¬ï¼Œå¯ä»¥æŒ‰éœ€ä½¿ç”¨ã€‚ä¸‹é¢æˆ‘ä»¬éœ€è¦å¯¹æ•è·åˆ°çš„è¿›ç¨‹å †æ ˆä¿¡æ¯perf.dataè¿›è¡ŒæŠ˜å ï¼Œç”ŸæˆæŠ˜å çš„å †æ ˆä¿¡æ¯:\n1  root@master:~# perf script -i /root/perf.data \u0026amp;\u0026gt; /root/perf.unfold   ç”¨ stackcollapse-perf.pl å°† perf è§£æå‡ºçš„å†…å®¹ perf.unfold ä¸­çš„ç¬¦å·è¿›è¡ŒæŠ˜å \n1 2 3 4 5 6 7  root@master:~/FlameGraph# ls aix-perf.pl docs example-perf.svg pkgsplit-perf.pl stackcollapse-aix.pl stackcollapse-go.pl stackcollapse-ljp.awk stackcollapse-pmc.pl stackcollapse-vsprof.pl test.sh demos example-dtrace-stacks.txt files.pl range-perf.pl stackcollapse-bpftrace.pl stackcollapse-instruments.pl stackcollapse-perf.pl stackcollapse-recursive.pl stackcollapse-vtune.pl dev example-dtrace.svg flamegraph.pl README.md stackcollapse-elfutils.pl stackcollapse-java-exceptions.pl stackcollapse-perf-sched.awk stackcollapse-sample.awk stackcollapse-xdebug.php difffolded.pl example-perf-stacks.txt.gz jmaps record-test.sh stackcollapse-gdb.pl stackcollapse-jstack.pl stackcollapse.pl stackcollapse-stap.pl test root@master:~/FlameGraph# ./stackcollapse-perf.pl /root/perf.unfold \u0026amp;\u0026gt; /root/perf.folded root@master:~/FlameGraph#   æœ€åå°±æ˜¯ç”Ÿæˆç«ç„°ğŸ”¥å›¾äº†\n1  root@master:~/FlameGraph# ./flamegraph.pl /root/perf.folded \u0026gt; /root/perf.svg   å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡ç®¡é“ç¬¦|å°†æ•´ä¸ªè¿‡ç¨‹ç®€åŒ–:\n1  cd \u0026amp;\u0026amp; perf script | FlameGraph/stackcollapse-perf.pl | FlameGraph/flamegraph.pl \u0026gt; process.svg   æœ€ååœ¨è°·æ­Œæµè§ˆå™¨ä¸Šæ‰“å¼€è¯¥ç«ç„°å›¾:\nç«ç„°å›¾æ˜¯åŸºäºstackä¿¡æ¯ç”Ÿæˆçš„SVG å›¾ç‰‡, ç”¨æ¥å±•ç¤º CPU çš„è°ƒç”¨æ ˆã€‚\n  y è½´è¡¨ç¤ºè°ƒç”¨æ ˆ, æ¯ä¸€å±‚éƒ½æ˜¯ä¸€ä¸ªå‡½æ•°. è°ƒç”¨æ ˆè¶Šæ·±, ç«ç„°å°±è¶Šé«˜, é¡¶éƒ¨å°±æ˜¯æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°, ä¸‹æ–¹éƒ½æ˜¯å®ƒçš„çˆ¶å‡½æ•°.\n  x è½´è¡¨ç¤ºæŠ½æ ·æ•°, å¦‚æœä¸€ä¸ªå‡½æ•°åœ¨ x è½´å æ®çš„å®½åº¦è¶Šå®½, å°±è¡¨ç¤ºå®ƒè¢«æŠ½åˆ°çš„æ¬¡æ•°å¤š, å³æ‰§è¡Œçš„æ—¶é—´é•¿. æ³¨æ„, x è½´ä¸ä»£è¡¨æ—¶é—´, è€Œæ˜¯æ‰€æœ‰çš„è°ƒç”¨æ ˆåˆå¹¶å, æŒ‰å­—æ¯é¡ºåºæ’åˆ—çš„.\n  ç«ç„°å›¾å°±æ˜¯çœ‹é¡¶å±‚çš„å“ªä¸ªå‡½æ•°å æ®çš„å®½åº¦æœ€å¤§. åªè¦æœ‰\u0026quot;å¹³é¡¶\u0026quot;(plateaus), å°±è¡¨ç¤ºè¯¥å‡½æ•°å¯èƒ½å­˜åœ¨æ€§èƒ½é—®é¢˜ã€‚é¢œè‰²æ²¡æœ‰ç‰¹æ®Šå«ä¹‰, å› ä¸ºç«ç„°å›¾è¡¨ç¤ºçš„æ˜¯ CPU çš„ç¹å¿™ç¨‹åº¦, æ‰€ä»¥ä¸€èˆ¬é€‰æ‹©æš–è‰²è°ƒ.\nå½“è°ƒç”¨æ ˆä¸å®Œæ•´è°ƒç”¨æ ˆè¿‡æ·±æ—¶ï¼ŒæŸäº›ç³»ç»Ÿåªè¿”å›å‰é¢çš„ä¸€éƒ¨åˆ†ï¼ˆæ¯”å¦‚å‰10å±‚ï¼‰;å½“å‡½æ•°åç¼ºå¤±ï¼Œå‡½æ•°æ²¡æœ‰åå­—ï¼Œç¼–è¯‘å™¨åªç”¨å†…å­˜åœ°å€æ¥è¡¨ç¤ºï¼ˆæ¯”å¦‚åŒ¿åå‡½æ•°ï¼‰ï¼Œæ‰€ä»¥ä½¿ç”¨ç«ç„°å›¾ä¹Ÿæ˜¯å­˜åœ¨åˆ†æä¸åˆ°çš„åœ°æ–¹ã€‚ä½ ä¹Ÿå¯ä»¥é€šè¿‡ä»¥ä¸‹è„šæœ¬è¿›è¡Œé‡‡é›†åˆ†æç«ç„°å›¾:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  if [ $# -ne 1 ];then echo \u0026#34;Usage: $0seconds\u0026#34; exit 1 fi perf record -a -g -o perf.data \u0026amp; PID=`ps aux| grep \u0026#34;perf record\u0026#34;| grep -v grep| awk \u0026#39;{print $2}\u0026#39;` if [ -n \u0026#34;$PID\u0026#34; ]; then sleep $1 kill -s INT $PID fi # wait until perf exite sleep 1 perf script -i perf.data \u0026amp;\u0026gt; perf.unfold perl stackcollapse-perf.pl perf.unfold \u0026amp;\u0026gt; perf.folded perl flamegraph.pl perf.folded \u0026gt;perf.svg   ","description":"","id":37,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200704-%E5%A6%82%E4%BD%95%E7%A1%AE%E5%AE%9Acpu%E6%B6%88%E8%80%97%E5%9C%A8%E5%93%AA%E4%BA%9B%E5%87%BD%E6%95%B0%E4%B8%8A/"},{"content":"æœ€è¿‘åœ¨é˜¿é‡Œäº‘å¼€å‘è€…è—ç»é˜ä¸­å‘ç°ä¸€æœ¬æœ‰è¶£çš„ç”µå­ä¹¦ï¼Œç”±å£°ä¸œç¼–å†™çš„ã€Šæ·±å…¥æµ…å‡ºKubernetesã€‹ï¼Œæ–‡æœ«æœ‰ä¸‹è½½æ–¹å¼ï¼š\n ä¸€æ¬¡ææ‡‚6ä¸ªæ ¸å¿ƒåŸç†åƒé€ç†è®ºåŸºç¡€ ä¸€æ¬¡å­¦ä¼š6ä¸ªå…¸å‹é—®é¢˜çš„åä¸½æ“ä½œ  124é¡µçš„é˜¿é‡Œäº‘ã€Šæ·±å…¥æµ…å‡ºKubernetesã€‹ä»ç†è®ºåˆ°å®è·µçš„å¹²è´§å¤§çº²:\nç†è®ºç¯‡  è¿™ä¹ˆç†è§£é›†ç¾¤æ§åˆ¶å™¨ï¼Œèƒ½è¡Œï¼ é›†ç¾¤ç½‘ç»œè¯¦è§£ é›†ç¾¤ä¼¸ç¼©åŸç† è®¤è¯ä¸è°ƒåº¦ é›†ç¾¤æœåŠ¡çš„ä¸‰ä¸ªè¦ç‚¹å’Œä¸€ç§å®ç° é•œåƒæ‹‰å»è¿™ä»¶å°äº‹  å®è·µç¯‡  è¯»æ‡‚è¿™ä¸€ç¯‡ï¼Œé›†ç¾¤èŠ‚ç‚¹ä¸ä¸‹çº¿ èŠ‚ç‚¹ä¸‹çº¿å§Šå¦¹ç¯‡ æˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šåˆ é™¤ä¸äº†é›†ç¾¤çš„å‘½åç©ºé—´ï¼Ÿ é˜¿é‡Œäº‘ACKäº§å“å®‰å…¨ç»„é…ç½®ç®¡ç† äºŒåˆ†ä¹‹ä¸€æ´»çš„å¾®æœåŠ¡ åŠå¤œä¸¤ç‚¹Caè¯ä¹¦è¿‡æœŸé—®é¢˜å¤„ç†æƒ¨å†µæ€»ç»“   åœ¨å¾®ä¿¡å…¬ä¼—å·å†…å›å¤\u0026quot;é˜¿é‡Œäº‘\u0026quot;å³å¯ä¸‹è½½ã€Šæ·±å…¥æµ…å‡ºKubernetesã€‹PDFç‰ˆã€‚\n ç²¾å½©æ–‡ç« å›é¡¾   ç«ç„°å›¾ï¼šå…¨å±€è§†é‡çš„Linuxæ€§èƒ½å‰–æ 1k+åœ¨è¯»\n  æœ€æµè¡Œçš„äº”æ¬¾Kubernetesäº¤äº’å¼å¯è§†åŒ–å·¥å…· 900+åœ¨è¯»\n  è½»æ¾çˆ¬å–æ‹‰å‹¾ç½‘å²—ä½æ‹›è˜ä¿¡æ¯ 600+åœ¨è¯»\n  Yearning - æœ€Popularçš„MYSQLå®¡è®¡å¹³å° 700+åœ¨è¯»\n  Prometheusç›‘æ§ç³»åˆ—-éƒ¨ç½²ç¯‡ 500+åœ¨è¯»\n  ","description":"","id":38,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200705-%E9%98%BF%E9%87%8C%E4%BA%91kubernetes%E7%94%B5%E5%AD%90%E4%B9%A6%E5%88%86%E4%BA%AB/"},{"content":"å‰æ®µæ—¶é—´ï¼Œå‘ç°æ–°è¿ç»´ç¤¾åŒºçš„èµµç­é•¿(èµµèˆœä¸œ)æ›´æ–°äº†ä¸€ç‰ˆã€Šè¿ç»´çŸ¥è¯†ä½“ç³» v3.1ã€‹å…¶ä¸­æ–°å¢äº†ä¸€äº›ç›®å‰æ¯”è¾ƒç«çš„ã€æˆç†Ÿçš„è¿ç»´è§£å†³æ–¹æ¡ˆï¼Œä¹ŸåŒ…æ‹¬å®¹å™¨ç¼–æ’ï¼Œå¾®æœåŠ¡æ¡†æ¶lstioç­‰ã€‚åˆ†å±‚çš„å½’ç±»æ€»ç»“å„ä¸ªå±‚æ¬¡å¸¸ç”¨çš„å¼€æºè½¯ä»¶ä»¥åŠæœåŠ¡ç»„åˆè§£å†³æ–¹æ¡ˆï¼Œå…¶ä¸­åŒ…æ‹¬å®¢æˆ·ç«¯å±‚ã€å¤–éƒ¨å±‚ã€ç½‘ç»œå±‚ã€æ¥å…¥å±‚ã€åº”ç”¨æœåŠ¡å±‚ã€å­˜å‚¨å±‚ã€åŸºç¡€æœåŠ¡å±‚ã€å®¹å™¨å±‚ã€æ“ä½œç³»ç»Ÿå±‚ã€åŸºç¡€è®¾æ–½å±‚ç­‰ï¼Œä»¥åŠæŠ€æœ¯åœ¨è¿ç»´ã€è¿ç»´è‡ªåŠ¨åŒ–æˆé•¿æ–¹å‘çš„å‘å±•ä»¥åŠè¿­ä»£çš„è¶‹åŠ¿ï¼Œè¿™é‡Œè´´å‡ºè¿ç»´çŸ¥è¯†ä½“ç³»-v3.1ä»¥åŠWebç¼“å­˜çŸ¥è¯†ä½“ç³»-V3.0ä¾›å¤§å®¶å­¦ä¹ å‚è€ƒã€‚\nè¿ç»´çŸ¥è¯†ä½“ç³»-v3.1 Webç¼“å­˜çŸ¥è¯†ä½“ç³»-V3.0  å›¾ç‰‡ç´ ææ¥æº: https://www.unixhot.com/\n ç²¾å½©æ–‡ç« å›é¡¾  Jenkinshä¸“è¾‘|è§£å†³Jenkinså®‰è£…çš„ç–‘éš¾æ‚ç—‡ Harbor2.0å¼€æºé•œåƒä»“åº“ä¼ä¸šçº§å®ç° Harbor2.0é…ç½®é«˜å¯ç”¨çš„Harboré•œåƒä»“åº“ é˜¿é‡Œäº‘å‡ºå“Â·Kubernetes æ·±å…¥æµ…å‡ºå®è·µ v1.0 å¾®è½¯å‡ºå“Â·Kubernetes æœ€æ–°å­¦ä¹ æŒ‡å— v3.0 ç«ç„°å›¾ï¼šå…¨å±€è§†é‡çš„ Linux æ€§èƒ½å‰–æ 1k+åœ¨è¯» æœ€æµè¡Œçš„äº”æ¬¾ Kubernetes äº¤äº’å¼å¯è§†åŒ–å·¥å…· 900+åœ¨è¯» è½»æ¾çˆ¬å–æ‹‰å‹¾ç½‘å²—ä½æ‹›è˜ä¿¡æ¯ 600+åœ¨è¯» Yearning - æœ€ Popular çš„ MYSQL å®¡è®¡å¹³å° 700+åœ¨è¯»  ","description":"","id":41,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/20200710-%E8%BF%90%E7%BB%B4%E7%9A%84%E7%9F%A5%E8%AF%86%E9%9D%A2%E7%A9%B6%E7%AB%9F%E6%9C%89%E5%A4%9A%E5%A4%A7/"},{"content":"è¯·ä½¿ç”¨ Chrome æµè§ˆå™¨ã€‚\nè¯·é˜…è¯»ä¸‹æ–¹æ–‡æœ¬ç†Ÿæ‚‰å·¥å…·ä½¿ç”¨æ–¹æ³•ï¼Œæœ¬æ–‡å¯ç›´æ¥æ‹·è´åˆ°å¾®ä¿¡ä¸­é¢„è§ˆã€‚\n1 Markdown Nice ç®€ä»‹  æ”¯æŒè‡ªå®šä¹‰æ ·å¼çš„ Markdown ç¼–è¾‘å™¨ æ”¯æŒå¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹å’Œç¨€åœŸæ˜é‡‘ æ¬¢è¿æ‰«ç å›å¤ã€Œæ’ç‰ˆã€åŠ å…¥ç”¨æˆ·ç¾¤  2 ä¸»é¢˜ https://preview.mdnice.com/themes/\næ¬¢è¿æäº¤ä¸»é¢˜ï¼Œæä¾›æ›´å¤šæ–‡ç« ç¤ºä¾‹~~\n3 é€šç”¨è¯­æ³• 3.1 æ ‡é¢˜ åœ¨æ–‡å­—å†™ä¹¦å†™ä¸åŒæ•°é‡çš„#å¯ä»¥å®Œæˆä¸åŒçš„æ ‡é¢˜ï¼Œå¦‚ä¸‹ï¼š\nä¸€çº§æ ‡é¢˜ äºŒçº§æ ‡é¢˜ ä¸‰çº§æ ‡é¢˜ 3.2 æ— åºåˆ—è¡¨ æ— åºåˆ—è¡¨çš„ä½¿ç”¨ï¼Œåœ¨ç¬¦å·-ååŠ ç©ºæ ¼ä½¿ç”¨ã€‚å¦‚ä¸‹ï¼š\n æ— åºåˆ—è¡¨ 1 æ— åºåˆ—è¡¨ 2 æ— åºåˆ—è¡¨ 3  å¦‚æœè¦æ§åˆ¶åˆ—è¡¨çš„å±‚çº§ï¼Œåˆ™éœ€è¦åœ¨ç¬¦å·-å‰ä½¿ç”¨ç©ºæ ¼ã€‚å¦‚ä¸‹ï¼š\n æ— åºåˆ—è¡¨ 1 æ— åºåˆ—è¡¨ 2  æ— åºåˆ—è¡¨ 2.1 æ— åºåˆ—è¡¨ 2.2    ç”±äºå¾®ä¿¡åŸå› ï¼Œæœ€å¤šæ”¯æŒåˆ°äºŒçº§åˆ—è¡¨ã€‚\n3.3 æœ‰åºåˆ—è¡¨ æœ‰åºåˆ—è¡¨çš„ä½¿ç”¨ï¼Œåœ¨æ•°å­—åŠç¬¦å·.ååŠ ç©ºæ ¼åè¾“å…¥å†…å®¹ï¼Œå¦‚ä¸‹ï¼š\n æœ‰åºåˆ—è¡¨ 1 æœ‰åºåˆ—è¡¨ 2 æœ‰åºåˆ—è¡¨ 3  3.4 å¼•ç”¨ å¼•ç”¨çš„æ ¼å¼æ˜¯åœ¨ç¬¦å·\u0026gt;åé¢ä¹¦å†™æ–‡å­—ã€‚å¦‚ä¸‹ï¼š\n è¯»ä¸€æœ¬å¥½ä¹¦ï¼Œå°±æ˜¯åœ¨å’Œé«˜å°šçš„äººè°ˆè¯ã€‚ â€”â€”æ­Œå¾·\n  é›‡ç”¨åˆ¶åº¦å¯¹å·¥äººä¸åˆ©ï¼Œä½†å·¥äººæ ¹æœ¬æ— åŠ›æ‘†è„±è¿™ä¸ªåˆ¶åº¦ã€‚ â€”â€”é˜®ä¸€å³°\n 3.5 ç²—ä½“å’Œæ–œä½“ ç²—ä½“çš„ä½¿ç”¨æ˜¯åœ¨éœ€è¦åŠ ç²—çš„æ–‡å­—å‰åå„åŠ ä¸¤ä¸ª*ã€‚\nè€Œæ–œä½“çš„ä½¿ç”¨åˆ™æ˜¯åœ¨éœ€è¦æ–œä½“çš„æ–‡å­—å‰åå„åŠ ä¸€ä¸ª*ã€‚\nå¦‚æœè¦ä½¿ç”¨ç²—ä½“å’Œæ–œä½“ï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨éœ€è¦æ“ä½œçš„æ–‡å­—å‰ååŠ ä¸‰ä¸ª*ã€‚å¦‚ä¸‹ï¼š\nè¿™ä¸ªæ˜¯ç²—ä½“\nè¿™ä¸ªæ˜¯æ–œä½“\nè¿™ä¸ªæ˜¯ç²—ä½“åŠ æ–œä½“\næ³¨ï¼šç”±äº commonmark æ ‡å‡†ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŠ ç²—ä¸æƒ³è±¡ä¸ä¸€è‡´ï¼Œå¦‚ä¸‹\n**ä»Šå¤©å¤©æ°”å¥½æ™´æœ—ï¼Œ**å¤„å¤„å¥½é£å…‰ã€‚\nè¿™ä¸ªæ˜¯æ­£å¸¸ç°è±¡ï¼Œè¯·å‚è€ƒåŠ ç²— Issueã€‚\n3.6 é“¾æ¥ å¾®ä¿¡å…¬ä¼—å·ä»…æ”¯æŒå…¬ä¼—å·æ–‡ç« é“¾æ¥ï¼Œå³åŸŸåä¸ºhttps://mp.weixin.qq.com/çš„åˆæ³•é“¾æ¥ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š\nå¯¹äºè¯¥è®ºè¿°ï¼Œæ¬¢è¿è¯»è€…æŸ¥é˜…ä¹‹å‰å‘è¿‡çš„æ–‡ç« ï¼Œä½ æ˜¯ã€Šæœªæ¥ä¸–ç•Œçš„å¹¸å­˜è€…ã€‹ä¹ˆï¼Ÿ\n3.7 åˆ†å‰²çº¿ å¯ä»¥åœ¨ä¸€è¡Œä¸­ç”¨ä¸‰ä¸ªä»¥ä¸Šçš„å‡å·æ¥å»ºç«‹ä¸€ä¸ªåˆ†éš”çº¿ï¼ŒåŒæ—¶éœ€è¦åœ¨åˆ†éš”çº¿çš„ä¸Šé¢ç©ºä¸€è¡Œã€‚å¦‚ä¸‹ï¼š\n3.8 åˆ é™¤çº¿ åˆ é™¤çº¿çš„ä½¿ç”¨ï¼Œåœ¨éœ€è¦åˆ é™¤çš„æ–‡å­—å‰åå„ä½¿ç”¨ä¸¤ä¸ª~ï¼Œå¦‚ä¸‹ï¼š\nè¿™æ˜¯è¦è¢«åˆ é™¤çš„å†…å®¹ã€‚\n3.9 è¡¨æ ¼ å¯ä»¥ä½¿ç”¨å†’å·æ¥å®šä¹‰è¡¨æ ¼çš„å¯¹é½æ–¹å¼ï¼Œå¦‚ä¸‹ï¼š\n   å§“å å¹´é¾„ å·¥ä½œ     å°å¯çˆ± 18 åƒå¯çˆ±å¤š   å°å°å‹‡æ•¢ 20 çˆ¬æ£µå‹‡æ•¢æ ‘   å°å°å°æœºæ™º 22 çœ‹ä¸€æœ¬æœºæ™ºä¹¦    3.10 å›¾ç‰‡ æ’å…¥å›¾ç‰‡ï¼Œå¦‚æœæ˜¯è¡Œå†…å›¾ç‰‡åˆ™æ— å›¾ä¾‹ï¼Œå¦åˆ™æœ‰å›¾ä¾‹ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š\nå¯ä»¥é€šè¿‡åœ¨å›¾ç‰‡å°¾éƒ¨æ·»åŠ å®½åº¦å’Œé«˜åº¦æ§åˆ¶å›¾ç‰‡å¤§å°ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n![åŒæ—¶è®¾ç½®å®½åº¦å’Œé«˜åº¦](https://imgkr.cn-bj.ufileos.com/4f78d8e8-77f6-4ea8-8a93-305087da06bd.png =150x150)\n![åªè®¾ç½®å®½åº¦ï¼Œæ¨èä½¿ç”¨ç™¾åˆ†æ¯”](https://imgkr.cn-bj.ufileos.com/4f78d8e8-77f6-4ea8-8a93-305087da06bd.png =40%x)\nè¯¥è¯­æ³•æ¯”è¾ƒç‰¹æ®Šï¼Œå…¶ä»– Markdown ç¼–è¾‘å™¨ä¸å®Œå…¨é€šç”¨ã€‚\næ”¯æŒ jpgã€pngã€gifã€svg ç­‰å›¾ç‰‡æ ¼å¼ï¼Œå…¶ä¸­ svg æ–‡ä»¶ä»…å¯åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°ä¸­ä½¿ç”¨ï¼Œsvg æ–‡ä»¶ç¤ºä¾‹å¦‚ä¸‹ï¼š\n æ”¯æŒå›¾ç‰‡æ‹–æ‹½å’Œæˆªå›¾ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­ä¸Šä¼ ï¼Œä¸Šä¼ æ—¶ä½¿ç”¨å½“å‰é€‰æ‹©çš„å›¾åºŠã€‚ å¯ä½¿ç”¨æ ¼å¼-\u0026gt;å›¾ç‰‡ä¸Šä¼ æœ¬åœ°å›¾ç‰‡ï¼Œç½‘ç«™ä»…æ”¯æŒã€Œå›¾å£³ã€å›¾åºŠï¼Œå¤±è´¥ç‡ä½å¯é•¿ä¹…ä¿å­˜ï¼  æ³¨ï¼šä»…æ”¯æŒ https çš„å›¾ç‰‡ï¼Œå›¾ç‰‡ç²˜è´´åˆ°å¾®ä¿¡æ—¶ä¼šè‡ªåŠ¨ä¸Šä¼ å¾®ä¿¡æœåŠ¡å™¨ï¼Œä¸å¿…æ‹…å¿ƒä½¿ç”¨ä¸Šè¿°å›¾åºŠä¼šå¯¼è‡´å¾®ä¿¡å†…å›¾ç‰‡ä¸¢å¤±ã€‚\n4. ç‰¹æ®Šè¯­æ³• 4.1 è„šæ³¨  æ”¯æŒå¹³å°ï¼šå¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹ã€‚\n è„šæ³¨ä¸é“¾æ¥çš„åŒºåˆ«å¦‚ä¸‹æ‰€ç¤ºï¼š\n1 2  é“¾æ¥ï¼š[æ–‡å­—](é“¾æ¥) è„šæ³¨ï¼š[æ–‡å­—](è„šæ³¨è§£é‡Š \u0026#34;è„šæ³¨åå­—\u0026#34;)   æœ‰äººè®¤ä¸ºåœ¨å¤§å‰ç«¯æ—¶ä»£çš„èƒŒæ™¯ä¸‹ï¼Œç§»åŠ¨ç«¯å¼€å‘ï¼ˆAndroidã€IOSï¼‰å°†é€æ­¥é€€å‡ºå†å²èˆå°ã€‚\nå…¨æ ˆå·¥ç¨‹å¸ˆåœ¨ä¸šåŠ¡å¼€å‘æµç¨‹ä¸­èµ·åˆ°äº†è‡³å…³é‡è¦çš„ä½œç”¨ã€‚\nè„šæ³¨å†…å®¹è¯·æ‹‰åˆ°æœ€ä¸‹é¢è§‚çœ‹ã€‚\n4.2 ä»£ç å—  æ”¯æŒå¹³å°ï¼šå¾®ä¿¡ä»£ç ä¸»é¢˜ä»…æ”¯æŒå¾®ä¿¡å…¬ä¼—å·ï¼å…¶ä»–ä¸»é¢˜æ— é™åˆ¶ã€‚\n å¦‚æœåœ¨ä¸€ä¸ªè¡Œå†…éœ€è¦å¼•ç”¨ä»£ç ï¼Œåªè¦ç”¨åå¼•å·å¼•èµ·æ¥å°±å¥½ï¼Œå¦‚ä¸‹ï¼š\nUse the printf() function.\nåœ¨éœ€è¦é«˜äº®çš„ä»£ç å—çš„å‰ä¸€è¡ŒåŠåä¸€è¡Œä½¿ç”¨ä¸‰ä¸ªåå¼•å·ï¼ŒåŒæ—¶ç¬¬ä¸€è¡Œåå¼•å·åé¢è¡¨ç¤ºä»£ç å—æ‰€ä½¿ç”¨çš„è¯­è¨€ï¼Œå¦‚ä¸‹ï¼š\n1 2 3 4 5 6 7  // FileName: HelloWorld.java public class HelloWorld { // Java å…¥å£ç¨‹åºï¼Œç¨‹åºä»æ­¤å…¥å£  public static void main(String[] args) { System.out.println(\u0026#34;Hello,World!\u0026#34;); // å‘æ§åˆ¶å°æ‰“å°ä¸€æ¡è¯­å¥  } }   æ”¯æŒä»¥ä¸‹è¯­è¨€ç§ç±»ï¼š\nbash clojureï¼Œcppï¼Œcsï¼Œcss dartï¼Œdockerfile, diff erlang goï¼Œgradleï¼Œgroovy haskell javaï¼Œjavascriptï¼Œjsonï¼Œjulia kotlin lispï¼Œlua makefileï¼Œmarkdownï¼Œmatlab objectivec perlï¼Œphpï¼Œpython rï¼Œrubyï¼Œrust scalaï¼Œshellï¼Œsqlï¼Œswift texï¼Œtypescript verilogï¼Œvhdl xml yaml å¦‚æœæƒ³è¦æ›´æ¢ä»£ç ä¸»é¢˜ï¼Œå¯åœ¨ä¸Šæ–¹æŒ‘é€‰ï¼Œä¸æ”¯æŒä»£ç ä¸»é¢˜è‡ªå®šä¹‰ã€‚\nå…¶ä¸­å¾®ä¿¡ä»£ç ä¸»é¢˜ä¸å¾®ä¿¡å®˜æ–¹ä¸€è‡´ï¼Œæœ‰ä»¥ä¸‹æ³¨æ„äº‹é¡¹ï¼š\n å¸¦è¡Œå·ä¸”ä¸æ¢è¡Œï¼Œä»£ç å¤§å°ä¸å®˜æ–¹ä¸€è‡´ éœ€è¦åœ¨ä»£ç å—å¤„æ ‡å¿—è¯­è¨€ï¼Œå¦åˆ™æ— æ³•é«˜äº® ç²˜è´´åˆ°å…¬ä¼—å·åï¼Œç”¨é¼ æ ‡ç‚¹ä»£ç å—å†…å¤–ä¸€æ¬¡ï¼Œå®Œæˆé«˜äº®  diff ä¸èƒ½åŒæ—¶å’Œå…¶ä»–è¯­è¨€çš„é«˜äº®åŒæ—¶æ˜¾ç¤ºï¼Œä¸”éœ€è¦è°ƒæ•´ä»£ç ä¸»é¢˜ä¸ºå¾®ä¿¡ä»£ç ä¸»é¢˜ä»¥å¤–çš„ä»£ç ä¸»é¢˜æ‰èƒ½çœ‹åˆ° diff æ•ˆæœï¼Œä½¿ç”¨æ•ˆæœå¦‚ä¸‹:\n1 2  + æ–°å¢é¡¹ - åˆ é™¤é¡¹   å…¶ä»–ä¸»é¢˜ä¸å¸¦è¡Œå·ï¼Œå¯è‡ªå®šä¹‰æ˜¯å¦æ¢è¡Œï¼Œä»£ç å¤§å°ä¸å½“å‰ç¼–è¾‘å™¨ä¸€è‡´\n4.3 æ•°å­¦å…¬å¼  æ”¯æŒå¹³å°ï¼šå¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹ã€‚\n è¡Œå†…å…¬å¼ä½¿ç”¨æ–¹æ³•ï¼Œæ¯”å¦‚è¿™ä¸ªåŒ–å­¦å…¬å¼ï¼š$\\ce{Hg^2+ -\u0026gt;[I-] HgI2 -\u0026gt;[I-] [Hg^{II}I4]^2-}$\nå—å…¬å¼ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š\n$$H(D_2) = -\\left(\\frac{2}{4}\\log_2 \\frac{2}{4} + \\frac{2}{4}\\log_2 \\frac{2}{4}\\right) = 1$$\nçŸ©é˜µï¼š\n$$\n\\begin{pmatrix}\n1 \u0026amp; a_1 \u0026amp; a_1^2 \u0026amp; \\cdots \u0026amp; a_1^n \\\n1 \u0026amp; a_2 \u0026amp; a_2^2 \u0026amp; \\cdots \u0026amp; a_2^n \\\n\\vdots \u0026amp; \\vdots \u0026amp; \\vdots \u0026amp; \\ddots \u0026amp; \\vdots \\\n1 \u0026amp; a_m \u0026amp; a_m^2 \u0026amp; \\cdots \u0026amp; a_m^n \\\n\\end{pmatrix}\n$$\nå…¬å¼ç”±äºå¾®ä¿¡ä¸æ”¯æŒï¼Œç›®å‰çš„è§£å†³æ–¹æ¡ˆæ˜¯è½¬æˆ svg æ”¾åˆ°å¾®ä¿¡ä¸­ï¼Œæ— éœ€è°ƒæ•´ï¼ŒçŸ¢é‡ä¸å¤±çœŸã€‚\nç›®å‰æµ‹è¯•å¦‚æœå…¬å¼é‡è¿‡å¤§ï¼Œåœ¨ Chrome ä¸‹ä¼šå­˜åœ¨ç²˜è´´åæ— å“åº”ï¼Œä½†æ˜¯åœ¨ Firefox ä¸­å§‹ç»ˆèƒ½å¤ŸæˆåŠŸã€‚\n4.4 TOC  æ”¯æŒå¹³å°ï¼šå¾®ä¿¡å…¬ä¼—å·ã€çŸ¥ä¹ã€‚\n TOC å…¨ç§°ä¸º Table of Contentï¼Œåˆ—å‡ºå…¨éƒ¨æ ‡é¢˜ã€‚ç”±äºç¤ºä¾‹æ ‡é¢˜è¿‡å¤šï¼Œéœ€è¦ä½¿ç”¨å°†ä¸‹æ–¹ä»£ç æ®µå»é™¤å³å¯ã€‚\n[TOC] ç”±äºå¾®ä¿¡åªæ”¯æŒåˆ°äºŒçº§åˆ—è¡¨ï¼Œæœ¬å·¥å…·ä»…æ”¯æŒäºŒçº§æ ‡é¢˜å’Œä¸‰çº§æ ‡é¢˜çš„æ˜¾ç¤ºã€‚\n4.5 æ³¨éŸ³ç¬¦å·  æ”¯æŒå¹³å°ï¼šå¾®ä¿¡å…¬ä¼—å·ã€‚\n æ”¯æŒæ³¨éŸ³ç¬¦å·ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\nMarkdown Nice è¿™ä¹ˆå¥½ç”¨ï¼Œç®€ç›´æ˜¯{å–œå¤§æ™®å¥”|hÄ“ hÄ“ hÄ“ hÄ“}å‘€ï¼\n4.6 æ¨ªå±æ»‘åŠ¨å¹»ç¯ç‰‡  æ”¯æŒå¹³å°ï¼šå¾®ä¿¡å…¬ä¼—å·ã€‚\n é€šè¿‡\u0026lt;![](url),![](url)\u0026gt;è¿™ç§è¯­æ³•è®¾ç½®æ¨ªå±æ»‘åŠ¨æ»‘åŠ¨ç‰‡ï¼Œå…·ä½“ç”¨æ³•å¦‚ä¸‹ï¼š\n\u0026lt;,,\u0026gt;\n5 å…¶ä»–è¯­æ³• 5.1 HTML æ”¯æŒåŸç”Ÿ HTML è¯­æ³•ï¼Œè¯·å†™å†…è”æ ·å¼ï¼Œå¦‚ä¸‹ï¼š\næ©™è‰²å±…å³\næ©™è‰²å±…ä¸­\n5.2 UML ä¸æ”¯æŒï¼Œæ¨èä½¿ç”¨å¼€æºå·¥å…·https://draw.io/åˆ¶ä½œåå†å¯¼å…¥å›¾ç‰‡\n5.3 ç»„ä»¶å›¾åºŠ ç»„ä»¶ç›®å‰å…±æ”¯æŒ 3 ç§å›¾åºŠå’Œ 1 ç§è‡ªå®šä¹‰å›¾åºŠï¼Œä¸»è¦ç‰¹ç‚¹å¦‚ä¸‹ï¼š\n   å›¾åºŠ è´¹ç”¨ æœ‰æ•ˆæœŸ å¤±è´¥ç‡     SM.MS å…è´¹ é•¿æœŸ é«˜   é˜¿é‡Œäº‘ ä»˜è´¹ è‡ªå®šä¹‰ ä½   ä¸ƒç‰›äº‘ 10G å…è´¹ è‡ªå®šä¹‰ ä½   è‡ªå®šä¹‰ é«˜æ˜‚ è‡ªå®šä¹‰ è‡ªå®šä¹‰    4 ä¸ªå›¾åºŠçš„ç¼ºç‚¹ï¼š\n   å›¾åºŠ ç¼ºç‚¹     SM.MS å¤±è´¥ç‡é«˜å¯ç”¨æ€§å¾ˆå·®   é˜¿é‡Œäº‘ é…ç½®ç¹çï¼Œè´¹ç”¨æ˜‚è´µ   ä¸ƒç‰›äº‘ é…ç½®ç¹çï¼Œéœ€è´­ä¹°é•¿æœŸåŸŸå   è‡ªå®šä¹‰ æ­å»ºåå°ç¹ç    5.4 æ›´å¤šæ–‡æ¡£ æ›´å¤šæ–‡æ¡£è¯·å‚è€ƒ markdown-nice-docs\n","description":"","id":43,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/docs-template/"},{"content":"1 GitlabRunner ç®€ä»‹ 1.1 Gitlab-runner GitLab Runner æ˜¯ä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œç”¨äºè¿è¡Œæ‚¨çš„ä½œä¸šå¹¶å°†ç»“æœå‘é€å› GitLabã€‚å®ƒä¸GitLab CIç»“åˆä½¿ç”¨ï¼ŒGitLab CIæ˜¯GitLabéšé™„çš„ç”¨äºåè°ƒä½œä¸šçš„å¼€æºæŒç»­é›†æˆæœåŠ¡ã€‚\n1.2 è¦æ±‚  GitLab Runner æ˜¯ç”¨Goç¼–å†™çš„ï¼Œå¯ä»¥ä½œä¸ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶è¿è¡Œï¼Œä¸éœ€è¦ç‰¹å®šäºè¯­è¨€çš„è¦æ±‚ã€‚å®ƒæ—¨åœ¨åœ¨ GNU / Linuxï¼ŒmacOS å’Œ Windows æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œã€‚åªè¦æ‚¨å¯ä»¥åœ¨å…¶ä»–æ“ä½œç³»ç»Ÿä¸Šç¼–è¯‘ Go äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå…¶ä»–æ“ä½œç³»ç»Ÿå°±å¯èƒ½ä¼šè¿è¡Œã€‚ å¦‚æœè¦ä½¿ç”¨ Dockerï¼Œè¯·å®‰è£…æœ€æ–°ç‰ˆæœ¬ã€‚GitLab Runner éœ€è¦æœ€å°‘çš„ Docker v1.13.0ã€‚ GitLab Runner ç‰ˆæœ¬åº”ä¸ GitLab ç‰ˆæœ¬åŒæ­¥ã€‚å°½ç®¡è¾ƒæ—§çš„ Runner ä»å¯ä»¥ä½¿ç”¨è¾ƒæ–°çš„ GitLab ç‰ˆæœ¬ï¼Œåä¹‹äº¦ç„¶ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¦‚æœç‰ˆæœ¬å­˜åœ¨å·®å¼‚ï¼Œåˆ™åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨æˆ–æ— æ³•æ­£å¸¸å·¥ä½œã€‚åœ¨æ¬¡è¦ç‰ˆæœ¬æ›´æ–°ä¹‹é—´å¯ä»¥ä¿è¯å‘åå…¼å®¹æ€§ï¼Œä½†æ˜¯è¯·æ³¨æ„ï¼ŒGitLab çš„æ¬¡è¦ç‰ˆæœ¬æ›´æ–°ä¼šå¼•å…¥æ–°åŠŸèƒ½ï¼Œè¿™äº›æ–°åŠŸèƒ½å°†è¦æ±‚ Runner åœ¨åŒä¸€æ¬¡è¦ç‰ˆæœ¬ä¸Šä½¿ç”¨ã€‚  1.3 ç‰¹ç‚¹  è¿è¡Œæ¨¡å¼ï¼š  åŒæ—¶æ‰§è¡Œå¤šä¸ªä½œä¸šã€‚ å¯¹å¤šä¸ªæœåŠ¡å™¨ï¼ˆç”šè‡³æ¯ä¸ªé¡¹ç›®ï¼‰ä½¿ç”¨å¤šä¸ªä»¤ç‰Œã€‚ é™åˆ¶æ¯ä¸ªä»¤ç‰Œçš„å¹¶è¡Œä½œä¸šæ•°ã€‚   job å¯ä»¥è¿è¡Œåœ¨ï¼š  åœ¨æœ¬åœ°ã€‚ ä½¿ç”¨ Docker å®¹å™¨ã€‚ ä½¿ç”¨ Docker å®¹å™¨å¹¶é€šè¿‡ SSH æ‰§è¡Œä½œä¸šã€‚ ä½¿ç”¨ Docker å®¹å™¨åœ¨ä¸åŒçš„äº‘å’Œè™šæ‹ŸåŒ–ç®¡ç†ç¨‹åºä¸Šè‡ªåŠ¨ç¼©æ”¾ã€‚ è¿æ¥åˆ°è¿œç¨‹ SSH æœåŠ¡å™¨ã€‚   ç”¨ Go ç¼–å†™å¹¶ä»¥å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„å½¢å¼åˆ†å‘ï¼Œè€Œæ²¡æœ‰å…¶ä»–è¦æ±‚ã€‚ æ”¯æŒ Bashï¼ŒWindows Batch å’Œ Windows PowerShellã€‚ åœ¨ GNU / Linuxï¼ŒmacOS å’Œ Windowsï¼ˆå‡ ä¹å¯ä»¥åœ¨ä»»ä½•å¯ä»¥è¿è¡Œ Docker çš„åœ°æ–¹ï¼‰ä¸Šè¿è¡Œã€‚ å…è®¸è‡ªå®šä¹‰ job è¿è¡Œç¯å¢ƒã€‚ Gitlab runner çš„é…ç½®æ–‡ä»¶çƒ­åŠ è½½ï¼Œæ— éœ€é‡å¯ã€‚ æ˜“äºä½¿ç”¨çš„è®¾ç½®ï¼Œå¹¶æ”¯æŒ Dockerï¼ŒDocker-SSHï¼ŒParallels æˆ– SSH è¿è¡Œç¯å¢ƒã€‚ å¯ä»¥åˆ©ç”¨ Docker å®¹å™¨çš„ç¼“å­˜ã€‚ æ˜“äºå®‰è£…ï¼Œå¯ä½œä¸º GNU / Linuxï¼ŒmacOS å’Œ Windows çš„æœåŠ¡ã€‚ åµŒå…¥å¼ Prometheus æŒ‡æ ‡ HTTP æœåŠ¡å™¨ã€‚ è£åˆ¤å·¥ä½œè€…ç›‘è§† Prometheus åº¦é‡æ ‡å‡†å’Œå…¶ä»–ç‰¹å®šäºå·¥ä½œçš„æ•°æ®å¹¶å°†å…¶ä¼ é€’ç»™ GitLabã€‚  2 Gitlab Runner éƒ¨ç½²ä½¿ç”¨ç¯‡ 2.1 å®‰è£…ç¯‡  å®‰è£…é¡»çŸ¥ï¼ï¼ï¼\n   é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£… gitlab runner æœåŠ¡ä¼šè‡ªåŠ¨çš„åˆ›å»º gitlab runner ç”¨æˆ·\n  å¦‚æœéœ€è¦ä½¿ç”¨ Docker ç¯å¢ƒæˆ–è€…åˆ©ç”¨ Docker ç¼“å­˜æ„å»ºï¼Œéœ€å°†gitlab-runnerç”¨æˆ·åŠ å…¥åˆ° docker ç”¨æˆ·ç»„\n1  usermod -aG docker gitlab-runner     å¦‚æœæˆæƒä¹‹åä¾æ—§æ˜¾ç¤ºæ— æƒé™æ“ä½œdocker.sockï¼Œæ­¤æ—¶ä½ éœ€è¦ä¿®æ”¹ Gitlab runner æ‰€è¿è¡Œåœ¨çš„ä¸»æœºä¸Šçš„ Docker daemon\n  2.2 æ³¨å†Œç¯‡ 2.2.1 Gitlab Runner æ³¨å†Œ  äº¤äº’å¼æ³¨å†Œ  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  docker run --rm -t -i -v ~/data/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner:v12.6.0 register Runtime platform arch=amd64 os=linux pid=6 revision=ac8e767a version=12.6.0 Running in system-mode. Please enter the gitlab-ci coordinator URL (e.g. https://gitlab.com/): https://code.xingshulin.com Please enter the gitlab-ci token for this runner: 4tutaeWWL3srNEcmHs1s Please enter the gitlab-ci description for this runner: [00e4f023b5ae]: devops-service-runner Please enter the gitlab-ci tags for this runner (comma separated): build Registering runner... succeeded runner=4tutaeWW Please enter the executor: parallels, virtualbox, docker-ssh+machine, kubernetes, docker+machine, custom, docker, docker-ssh, shell, ssh: shell Runner registered successfully. Feel free to start it, but if it\u0026#39;s running already the config should be automatically reloaded!    ç›´æ¥æ³¨å†Œ  1 2 3 4 5 6 7 8 9 10  docker run -itd --rm -v ~/data/gitlab-runner/config:/etc/gitlab-runner gitlab/gitlab-runner:v12.6.0 register \\  --non-interactive \\  --executor \u0026#34;shell\u0026#34; \\  --url \u0026#34;https://code.xingshulin.com\u0026#34; \\  --registration-token \u0026#34;JRzzw2j1Ji6aBjwvkxAv\u0026#34; \\  --description \u0026#34;devops-runner\u0026#34; \\  --tag-list \u0026#34;build,deploy\u0026#34; \\  --run-untagged=\u0026#34;true\u0026#34; \\  --locked=\u0026#34;false\u0026#34; \\  --access-level=\u0026#34;not_protected\u0026#34;   2.2.2 gitlab runner é€‰é¡¹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17  -c value, --config value æŒ‡å®šé…ç½®æ–‡ä»¶ --template-config value æŒ‡å®šæ¨¡æ¿é…ç½®æ–‡ä»¶ --tag-list value æŒ‡å®šrunnerçš„æ ‡ç­¾åˆ—è¡¨ï¼Œé€—å·åˆ†éš” -n, --non-interactive æ— äº¤äº’è¿›è¡Œrunneræ³¨å†Œ --leave-runner å¦‚æœæ³¨å†Œå¤±è´¥ï¼Œä¸ç”¨åˆ é™¤runner -r value, --registration-token value runnerçš„æ³¨å†Œtoken --run-untagged æ³¨å†Œè¿è¡ŒæœªåŠ æ ‡ç­¾çš„æ„å»ºï¼Œé»˜è®¤å½“æ ‡ç­¾åˆ—è¡¨ä¸ºç©ºæ—¶å€¼ä¸ºtrue --locked é”å®šrunner é»˜è®¤true --access-level value è®¾ç½®è®¿é—®ç­‰çº§ not_protected or ref_protected; é»˜è®¤ not_protected --maximum-timeout value ä¸ºä½œä¸šè®¾ç½®æœ€å¤§è¿è¡Œè¶…æ—¶æ—¶é—´ é»˜è®¤é›¶ å•ä½ç§’ --paused è®¾ç½®runnerä¸º paused,é»˜è®¤ \u0026#39;false\u0026#39; --name value, --description value Runner åç§° --limit value ç¨‹åºå¤„ç†çš„æœ€å¤§æ„å»ºæ•°é‡default: \u0026#34;0\u0026#34; --output-limit value æœ€å¤§çš„æ„å»ºå¤§å°å•ä½kb default: \u0026#34;0\u0026#34; --request-concurrency value ä½œä¸šè¯·æ±‚çš„æœ€å¤§å¹¶å‘æ•° default: \u0026#34;0\u0026#34; -u value, --url value GitlabCIæœåŠ¡å™¨åœ°å€ -t value, --token value GitlabCIæœåŠ¡å™¨token   2.2.3 gitlab runner ç±»å‹  stuck: è¡¨ç¤ºå½“å‰çš„ pipeline æ²¡æœ‰é€‚é…åˆ°åˆé€‚çš„ Tags çš„ Runner\n  shared ï¼š è¿è¡Œæ•´ä¸ªå¹³å°é¡¹ç›®çš„ä½œä¸šï¼ˆgitlabï¼‰ groupï¼š è¿è¡Œç‰¹å®š group ä¸‹çš„æ‰€æœ‰é¡¹ç›®çš„ä½œä¸šï¼ˆgroupï¼‰ specific: è¿è¡ŒæŒ‡å®šçš„é¡¹ç›®ä½œä¸šï¼ˆprojectï¼‰ lockedï¼š æ— æ³•è¿è¡Œé¡¹ç›®ä½œä¸š pausedï¼š ä¸ä¼šè¿è¡Œä½œä¸š  3. GitLab Runner Pipeline 3.1 job åœ¨æ¯ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨åä¸º.gitlab-ci.ymlçš„ YAML æ–‡ä»¶é…ç½® GitLab CI / CD ç®¡é“ã€‚\nè¿™é‡Œåœ¨ pipeline ä¸­å®šä¹‰äº†ä¸¤ä¸ªä½œä¸šï¼Œæ¯ä¸ªä½œä¸šè¿è¡Œä¸åŒçš„å‘½ä»¤ã€‚å‘½ä»¤å¯ä»¥æ˜¯ shell æˆ–è„šæœ¬ã€‚\njob1: script: \u0026quot;execute-script-for-job1\u0026quot; job2: script: \u0026quot;execute-script-for-job2\u0026quot;  å¯ä»¥å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªä½œä¸š(job)ã€‚ æ¯ä¸ªä½œä¸šå¿…é¡»å…·æœ‰å”¯ä¸€çš„åç§°ï¼ˆä¸èƒ½ä½¿ç”¨å…³é”®å­—ï¼‰ã€‚ æ¯ä¸ªä½œä¸šæ˜¯ç‹¬ç«‹æ‰§è¡Œçš„ã€‚ æ¯ä¸ªä½œä¸šè‡³å°‘è¦åŒ…å«ä¸€ä¸ª scriptã€‚  3.2 script job: script: - uname -a - bundle exec rspec **æ³¨æ„ï¼š**æœ‰æ—¶ï¼Œ scriptå‘½ä»¤å°†éœ€è¦ç”¨å•å¼•å·æˆ–åŒå¼•å·å¼•èµ·æ¥. ä¾‹å¦‚ï¼ŒåŒ…å«å†’å·å‘½ä»¤ï¼ˆ : ï¼‰éœ€è¦åŠ å¼•å·ï¼Œä»¥ä¾¿è¢«åŒ…è£¹çš„ YAML è§£æå™¨çŸ¥é“æ¥è§£é‡Šæ•´ä¸ªäº‹æƒ…ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªâ€é”®ï¼šå€¼â€å¯¹. ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦æ—¶è¦å°å¿ƒï¼š : ï¼Œ { ï¼Œ } ï¼Œ [ ï¼Œ ] ï¼Œ , ï¼Œ \u0026amp; ï¼Œ * ï¼Œ # ï¼Œ ? ï¼Œ | ï¼Œ - ï¼Œ \u0026lt; ï¼Œ \u0026gt; ï¼Œ = ! ï¼Œ % ï¼Œ @ .\n3.3 before_script ç”¨äºå®šä¹‰ä¸€ä¸ªå‘½ä»¤ï¼Œè¯¥å‘½ä»¤åœ¨æ¯ä¸ªä½œä¸šä¹‹å‰è¿è¡Œã€‚å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æŒ‡å®šçš„scriptä¸ä¸»è„šæœ¬ä¸­æŒ‡å®šçš„ä»»ä½•è„šæœ¬ä¸²è”åœ¨ä¸€èµ·ï¼Œå¹¶åœ¨å•ä¸ª shell ä¸­ä¸€èµ·æ‰§è¡Œã€‚\n3.4 after_script ç”¨äºå®šä¹‰å°†åœ¨æ¯ä¸ªä½œä¸šï¼ˆåŒ…æ‹¬å¤±è´¥çš„ä½œä¸šï¼‰ä¹‹åè¿è¡Œçš„å‘½ä»¤ã€‚è¿™å¿…é¡»æ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æŒ‡å®šçš„è„šæœ¬åœ¨æ–°çš„ shell ä¸­æ‰§è¡Œï¼Œä¸ä»»ä½•before_scriptæˆ–scriptè„šæœ¬åˆ†å¼€ã€‚\nå¯ä»¥åœ¨å…¨å±€å®šä¹‰ï¼Œä¹Ÿå¯ä»¥åœ¨ job ä¸­å®šä¹‰ã€‚åœ¨ job ä¸­å®šä¹‰ä¼šè¦†ç›–å…¨å±€ã€‚\nbefore_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com stages: - build - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build script: - echo \u0026quot;mvn clean \u0026quot; - echo \u0026quot;mvn install\u0026quot; after_script: - echo \u0026quot;after script in job\u0026quot; deploy: stage: deploy script: - echo \u0026quot;hello deploy\u0026quot; after_script: - echo \u0026quot;after-script\u0026quot; after_script å¤±è´¥ä¸ä¼šå½±å“ä½œä¸šå¤±è´¥ã€‚\n\nbefore_script å¤±è´¥å¯¼è‡´æ•´ä¸ªä½œä¸šå¤±è´¥ï¼Œå…¶ä»–ä½œä¸šå°†ä¸å†æ‰§è¡Œã€‚ä½œä¸šå¤±è´¥ä¸ä¼šå½±å“ after_script è¿è¡Œã€‚\n\n3.5 stages ç”¨äºå®šä¹‰ä½œä¸šå¯ä»¥ä½¿ç”¨çš„é˜¶æ®µï¼Œå¹¶ä¸”æ˜¯å…¨å±€å®šä¹‰çš„ã€‚åŒä¸€é˜¶æ®µçš„ä½œä¸šå¹¶è¡Œè¿è¡Œï¼Œä¸åŒé˜¶æ®µæŒ‰é¡ºåºæ‰§è¡Œã€‚\nstagesï¼š - build - test - deploy è¿™é‡Œå®šä¹‰äº†ä¸‰ä¸ªé˜¶æ®µï¼Œé¦–å…ˆ build é˜¶æ®µå¹¶è¡Œè¿è¡Œï¼Œç„¶å test é˜¶æ®µå¹¶è¡Œè¿è¡Œï¼Œæœ€å deploy é˜¶æ®µå¹¶è¡Œè¿è¡Œã€‚deploy é˜¶æ®µè¿è¡ŒæˆåŠŸåå°†æäº¤çŠ¶æ€æ ‡è®°ä¸º passed çŠ¶æ€ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªé˜¶æ®µè¿è¡Œå¤±è´¥ï¼Œæœ€åæäº¤çŠ¶æ€ä¸º failedã€‚\n æœªå®šä¹‰ stages\n å…¨å±€å®šä¹‰çš„ stages æ˜¯æ¥è‡ªäºæ¯ä¸ª jobã€‚å¦‚æœ job æ²¡æœ‰å®šä¹‰ stage åˆ™é»˜è®¤æ˜¯ test é˜¶æ®µã€‚å¦‚æœå…¨å±€æœªå®šä¹‰ stages,åˆ™æŒ‰é¡ºåºè¿è¡Œ build,test,deployã€‚\n\nå¦‚æœä½œä¸šä¸­å®šä¹‰äº†å…¶ä»–é˜¶æ®µï¼Œä¾‹å¦‚â€codescanâ€åˆ™ä¼šå‡ºç°é”™è¯¯ã€‚åŸå› æ˜¯å› ä¸ºé™¤äº† build test deploy é˜¶æ®µå¤–çš„å…¶ä»–é˜¶æ®µä½œä¸º.pre è¿è¡Œï¼ˆä¹Ÿå°±æ˜¯ä½œä¸ºç¬¬ä¸€ä¸ªé˜¶æ®µè¿è¡Œï¼Œéœ€è¦å°†æ­¤ä½œä¸šçš„ stage æŒ‡å®šä¸º.preï¼‰ã€‚\n\ncodescan: stage: .pre script: - echo \u0026quot;codescan\u0026quot; å®šä¹‰ stages æ§åˆ¶ stage è¿è¡Œé¡ºåº\nä¸€ä¸ªæ ‡å‡†çš„ yaml æ–‡ä»¶ä¸­æ˜¯éœ€è¦å®šä¹‰ stagesï¼Œå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¯¹æ¯ä¸ª stage è¿›è¡Œæ’åºã€‚\nstages: - build - test - codescan - deploy \n3.6 .pre \u0026amp; .post .pre å§‹ç»ˆæ˜¯æ•´ä¸ªç®¡é“çš„ç¬¬ä¸€ä¸ªè¿è¡Œé˜¶æ®µï¼Œ.post å§‹ç»ˆæ˜¯æ•´ä¸ªç®¡é“çš„æœ€åä¸€ä¸ªè¿è¡Œé˜¶æ®µã€‚ ç”¨æˆ·å®šä¹‰çš„é˜¶æ®µéƒ½åœ¨ä¸¤è€…ä¹‹é—´è¿è¡Œã€‚.preå’Œ.postçš„é¡ºåºæ— æ³•æ›´æ”¹ã€‚å¦‚æœç®¡é“ä»…åŒ…å«.preæˆ–.posté˜¶æ®µçš„ä½œä¸šï¼Œåˆ™ä¸ä¼šåˆ›å»ºç®¡é“ã€‚\n\n3.7 stage æ˜¯æŒ‰ JOB å®šä¹‰çš„ï¼Œå¹¶ä¸”ä¾èµ–äºå…¨å±€å®šä¹‰çš„stages ã€‚ å®ƒå…è®¸å°†ä½œä¸šåˆ†ä¸ºä¸åŒçš„é˜¶æ®µï¼Œå¹¶ä¸”åŒä¸€stageä½œä¸šå¯ä»¥å¹¶è¡Œæ‰§è¡Œï¼ˆå–å†³äºç‰¹å®šæ¡ä»¶ ï¼‰ã€‚\nunittest: stage: test script: - echo \u0026quot;run test\u0026quot; interfacetest: stage: test script: - echo \u0026quot;run test\u0026quot; \nå¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼š é˜¶æ®µå¹¶æ²¡æœ‰å¹¶è¡Œè¿è¡Œã€‚\nåœ¨è¿™é‡Œæˆ‘æŠŠè¿™ä¸¤ä¸ªé˜¶æ®µåœ¨åŒä¸€ä¸ª runner è¿è¡Œäº†ï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹ runner æ¯æ¬¡è¿è¡Œçš„ä½œä¸šæ•°é‡ã€‚é»˜è®¤æ˜¯ 1ï¼Œæ”¹ä¸º 10.\n\nvim /etc/gitlab-runner/config.toml æ›´æ”¹åè‡ªåŠ¨åŠ è½½æ— éœ€é‡å¯ã€‚\nconcurrent = 10 3.8 variables å®šä¹‰å˜é‡ï¼Œpipeline å˜é‡ã€job å˜é‡ã€Runner å˜é‡ã€‚job å˜é‡ä¼˜å…ˆçº§æœ€å¤§ã€‚\n3.9 ç»¼åˆå®ä¾‹ ç»¼åˆå®ä¾‹:\nbefore_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com stages: - build - test - codescan - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build script: - echo \u0026quot;mvn clean \u0026quot; - echo \u0026quot;mvn install\u0026quot; - echo \u0026quot;$DOMAIN\u0026quot; after_script: - echo \u0026quot;after script in buildjob\u0026quot; unittest: stage: test script: - echo \u0026quot;run test\u0026quot; deploy: stage: deploy script: - echo \u0026quot;hello deploy\u0026quot; - sleep 2; codescan: stage: codescan script: - echo \u0026quot;codescan\u0026quot; - sleep 5; after_script: - echo \u0026quot;after-script\u0026quot; - ech å®éªŒæ•ˆæœ\n\nå¯èƒ½é‡åˆ°çš„é—®é¢˜ï¼š pipeline å¡ä¸»,ä¸ºé™ä½å¤æ‚æ€§ç›®å‰æ²¡æœ‰å­¦ä¹  tagsï¼Œæ‰€ä»¥æµæ°´çº¿æ˜¯åœ¨å…±äº«çš„ runner ä¸­è¿è¡Œçš„ã€‚éœ€è¦è®¾ç½®å…±äº«çš„ runner è¿è¡Œæ²¡æœ‰ tag çš„ä½œä¸šã€‚\n\n3.10 tags ç”¨äºä»å…è®¸è¿è¡Œè¯¥é¡¹ç›®çš„æ‰€æœ‰ Runner åˆ—è¡¨ä¸­é€‰æ‹©ç‰¹å®šçš„ Runner,åœ¨ Runner æ³¨å†ŒæœŸé—´ï¼Œæ‚¨å¯ä»¥æŒ‡å®š Runner çš„æ ‡ç­¾ã€‚\ntagså¯è®©æ‚¨ä½¿ç”¨æŒ‡å®šäº†æ ‡ç­¾çš„ runner æ¥è¿è¡Œä½œä¸š,æ­¤ runner å…·æœ‰ ruby å’Œ postgres æ ‡ç­¾ã€‚\njob: tags: - ruby - postgres ç»™å®šå¸¦æœ‰osxæ ‡ç­¾çš„ OS X Runner å’Œå¸¦æœ‰windowsæ ‡ç­¾çš„ Windows Runnerï¼Œä»¥ä¸‹ä½œä¸šå°†åœ¨å„è‡ªçš„å¹³å°ä¸Šè¿è¡Œã€‚\nwindows job: stage: - build tags: - windows script: - echo Hello, %USERNAME%! osx job: stage: - build tags: - osx script: - echo \u0026quot;Hello, $USER!\u0026quot; \n3.11 allow_failure allow_failureå…è®¸ä½œä¸šå¤±è´¥ï¼Œé»˜è®¤å€¼ä¸ºfalse ã€‚å¯ç”¨åï¼Œå¦‚æœä½œä¸šå¤±è´¥ï¼Œè¯¥ä½œä¸šå°†åœ¨ç”¨æˆ·ç•Œé¢ä¸­æ˜¾ç¤ºæ©™è‰²è­¦å‘Š. ä½†æ˜¯ï¼Œç®¡é“çš„é€»è¾‘æµç¨‹å°†è®¤ä¸ºä½œä¸šæˆåŠŸ/é€šè¿‡ï¼Œå¹¶ä¸”ä¸ä¼šè¢«é˜»å¡ã€‚ å‡è®¾æ‰€æœ‰å…¶ä»–ä½œä¸šå‡æˆåŠŸï¼Œåˆ™è¯¥ä½œä¸šçš„é˜¶æ®µåŠå…¶ç®¡é“å°†æ˜¾ç¤ºç›¸åŒçš„æ©™è‰²è­¦å‘Šã€‚ä½†æ˜¯ï¼Œå…³è”çš„æäº¤å°†è¢«æ ‡è®°ä¸ºâ€é€šè¿‡â€ï¼Œè€Œä¸ä¼šå‘å‡ºè­¦å‘Šã€‚\njob1: stage: test script: - execute_script_that_will_fail allow_failure: true \n3.12 when on_successå‰é¢é˜¶æ®µä¸­çš„æ‰€æœ‰ä½œä¸šéƒ½æˆåŠŸï¼ˆæˆ–ç”±äºæ ‡è®°ä¸ºallow_failureè€Œè¢«è§†ä¸ºæˆåŠŸï¼‰æ—¶æ‰æ‰§è¡Œä½œä¸šã€‚ è¿™æ˜¯é»˜è®¤å€¼ã€‚\non_failureå½“å‰é¢é˜¶æ®µå‡ºç°å¤±è´¥åˆ™æ‰§è¡Œã€‚\nalways -æ‰§è¡Œä½œä¸šï¼Œè€Œä¸ç®¡å…ˆå‰é˜¶æ®µçš„ä½œä¸šçŠ¶æ€å¦‚ä½•ï¼Œæ”¾åˆ°æœ€åæ‰§è¡Œã€‚æ€»æ˜¯æ‰§è¡Œã€‚\n3.13 manual æ‰‹åŠ¨ manual -æ‰‹åŠ¨æ‰§è¡Œä½œä¸š,ä¸ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œéœ€è¦ç”±ç”¨æˆ·æ˜¾å¼å¯åŠ¨. æ‰‹åŠ¨æ“ä½œçš„ç¤ºä¾‹ç”¨æ³•æ˜¯éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ. å¯ä»¥ä»ç®¡é“ï¼Œä½œä¸šï¼Œç¯å¢ƒå’Œéƒ¨ç½²è§†å›¾å¼€å§‹æ‰‹åŠ¨æ“ä½œã€‚\næ­¤æ—¶åœ¨ deploy é˜¶æ®µæ·»åŠ  manualï¼Œåˆ™æµæ°´çº¿è¿è¡Œåˆ° deploy é˜¶æ®µä¸ºé”å®šçŠ¶æ€ï¼Œéœ€è¦æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®æ‰èƒ½è¿è¡Œ deploy é˜¶æ®µã€‚\n\n3.14 delayed å»¶è¿Ÿ delayed å»¶è¿Ÿä¸€å®šæ—¶é—´åæ‰§è¡Œä½œä¸šï¼ˆåœ¨ GitLab 11.14 ä¸­å·²æ·»åŠ ï¼‰ã€‚\næœ‰æ•ˆå€¼'5',10 seconds,30 minutes, 1 day, 1 week ã€‚\n\nå®éªŒ demo\nbefore_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com stages: - build - test - codescan - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build script: - echo \u0026quot;mvn clean \u0026quot; - echo \u0026quot;mvn install\u0026quot; - echo \u0026quot;$DOMAIN\u0026quot; after_script: - echo \u0026quot;after script in buildjob\u0026quot; unittest: stage: test script: - ech \u0026quot;run test\u0026quot; when: delayed start_in: '30' allow_failure: true deploy: stage: deploy script: - echo \u0026quot;hello deploy\u0026quot; - sleep 2; when: manual codescan: stage: codescan script: - echo \u0026quot;codescan\u0026quot; - sleep 5; when: on_success after_script: - echo \u0026quot;after-script\u0026quot; - ech 3.15 retry é…ç½®åœ¨å¤±è´¥çš„æƒ…å†µä¸‹é‡è¯•ä½œä¸šçš„æ¬¡æ•°ã€‚\nå½“ä½œä¸šå¤±è´¥å¹¶é…ç½®äº†retry ï¼Œå°†å†æ¬¡å¤„ç†è¯¥ä½œä¸šï¼Œç›´åˆ°è¾¾åˆ°retryå…³é”®å­—æŒ‡å®šçš„æ¬¡æ•°ã€‚å¦‚æœretryè®¾ç½®ä¸º 2ï¼Œå¹¶ä¸”ä½œä¸šåœ¨ç¬¬äºŒæ¬¡è¿è¡ŒæˆåŠŸï¼ˆç¬¬ä¸€æ¬¡é‡è¯•ï¼‰ï¼Œåˆ™ä¸ä¼šå†æ¬¡é‡è¯•. retryå€¼å¿…é¡»æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œç­‰äºæˆ–å¤§äº 0ï¼Œä½†å°äºæˆ–ç­‰äº 2ï¼ˆæœ€å¤šä¸¤æ¬¡é‡è¯•ï¼Œæ€»å…±è¿è¡Œ 3 æ¬¡ï¼‰.\nunittest: stage: test retry: 2 script: - ech \u0026quot;run test\u0026quot; \né»˜è®¤æƒ…å†µä¸‹ï¼Œå°†åœ¨æ‰€æœ‰å¤±è´¥æƒ…å†µä¸‹é‡è¯•ä½œä¸šã€‚ä¸ºäº†æ›´å¥½åœ°æ§åˆ¶retryå“ªäº›å¤±è´¥ï¼Œå¯ä»¥æ˜¯å…·æœ‰ä»¥ä¸‹é”®çš„å“ˆå¸Œå€¼ï¼š\n max ï¼šæœ€å¤§é‡è¯•æ¬¡æ•°. when ï¼šé‡è¯•å¤±è´¥çš„æ¡ˆä¾‹.  æ ¹æ®é”™è¯¯åŸå› è®¾ç½®é‡è¯•çš„æ¬¡æ•°ã€‚\nalways ï¼šåœ¨å‘ç”Ÿä»»ä½•æ•…éšœæ—¶é‡è¯•ï¼ˆé»˜è®¤ï¼‰. unknown_failure ï¼šå½“å¤±è´¥åŸå› æœªçŸ¥æ—¶ã€‚ script_failure ï¼šè„šæœ¬å¤±è´¥æ—¶é‡è¯•ã€‚ api_failure ï¼šAPIå¤±è´¥é‡è¯•ã€‚ stuck_or_timeout_failure ï¼šä½œä¸šå¡ä½æˆ–è¶…æ—¶æ—¶ã€‚ runner_system_failure ï¼šè¿è¡Œç³»ç»Ÿå‘ç”Ÿæ•…éšœã€‚ missing_dependency_failure: å¦‚æœä¾èµ–ä¸¢å¤±ã€‚ runner_unsupported ï¼šRunnerä¸å—æ”¯æŒã€‚ stale_schedule ï¼šæ— æ³•æ‰§è¡Œå»¶è¿Ÿçš„ä½œä¸šã€‚ job_execution_timeout ï¼šè„šæœ¬è¶…å‡ºäº†ä¸ºä½œä¸šè®¾ç½®çš„æœ€å¤§æ‰§è¡Œæ—¶é—´ã€‚ archived_failure ï¼šä½œä¸šå·²å­˜æ¡£ä¸”æ— æ³•è¿è¡Œã€‚ unmet_prerequisites ï¼šä½œä¸šæœªèƒ½å®Œæˆå…ˆå†³æ¡ä»¶ä»»åŠ¡ã€‚ scheduler_failure ï¼šè°ƒåº¦ç¨‹åºæœªèƒ½å°†ä½œä¸šåˆ†é…ç»™è¿è¡Œscheduler_failureã€‚ data_integrity_failure ï¼šæ£€æµ‹åˆ°ç»“æ„å®Œæ•´æ€§é—®é¢˜ã€‚ 3.16 å®éªŒ å®šä¹‰å½“å‡ºç°è„šæœ¬é”™è¯¯é‡è¯•ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯ä¼šè¿è¡Œä¸‰æ¬¡ã€‚\nunittest: stage: test tags: - build only: - master script: - ech \u0026quot;run test\u0026quot; retry: max: 2 when: - script_failure æ•ˆæœ\n\n3.17 timeout è¶…æ—¶  job é…ç½®è¶…æ—¶æ—¶é—´  ç‰¹å®šä½œä¸šé…ç½®è¶…æ—¶ï¼Œä½œä¸šçº§åˆ«çš„è¶…æ—¶å¯ä»¥è¶…è¿‡é¡¹ç›®çº§åˆ«çš„è¶…æ—¶ï¼Œä½†ä¸èƒ½è¶…è¿‡ Runner ç‰¹å®šçš„è¶…æ—¶ã€‚\nbuild: script: build.sh timeout: 3 hours 30 minutes test: script: rspec timeout: 3h 30m  é¡¹ç›®è®¾ç½®æµæ°´çº¿è¶…æ—¶æ—¶é—´  è¶…æ—¶å®šä¹‰äº†ä½œä¸šå¯ä»¥è¿è¡Œçš„æœ€é•¿æ—¶é—´ï¼ˆä»¥åˆ†é’Ÿä¸ºå•ä½ï¼‰ã€‚ è¿™å¯ä»¥åœ¨é¡¹ç›®çš„**â€œè®¾ç½®â€\u0026gt;â€ CI / CDâ€\u0026gt;â€œå¸¸è§„ç®¡é“â€è®¾ç½®ä¸‹è¿›è¡Œé…ç½®** ã€‚ é»˜è®¤å€¼ä¸º 60 åˆ†é’Ÿã€‚\n\n runner è¶…æ—¶æ—¶é—´  æ­¤ç±»è¶…æ—¶ï¼ˆå¦‚æœå°äºé¡¹ç›®å®šä¹‰çš„è¶…æ—¶ ï¼‰å°†å…·æœ‰ä¼˜å…ˆæƒã€‚æ­¤åŠŸèƒ½å¯ç”¨äºé€šè¿‡è®¾ç½®å¤§è¶…æ—¶ï¼ˆä¾‹å¦‚ä¸€ä¸ªæ˜ŸæœŸï¼‰æ¥é˜²æ­¢ Shared Runner è¢«é¡¹ç›®å ç”¨ã€‚æœªé…ç½®æ—¶ï¼ŒRunner å°†ä¸ä¼šè¦†ç›–é¡¹ç›®è¶…æ—¶ã€‚\n\næ­¤åŠŸèƒ½å¦‚ä½•å·¥ä½œï¼š\nç¤ºä¾‹ 1-è¿è¡Œç¨‹åºè¶…æ—¶å¤§äºé¡¹ç›®è¶…æ—¶\nrunner è¶…æ—¶è®¾ç½®ä¸º 24 å°æ—¶ï¼Œé¡¹ç›®çš„ CI / CD è¶…æ—¶è®¾ç½®ä¸º 2 å°æ—¶ã€‚è¯¥å·¥ä½œå°†åœ¨ 2 å°æ—¶åè¶…æ—¶ã€‚\nç¤ºä¾‹ 2-æœªé…ç½®è¿è¡Œç¨‹åºè¶…æ—¶\nrunner ä¸è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œé¡¹ç›®çš„ CI / CD è¶…æ—¶è®¾ç½®ä¸º 2 å°æ—¶ã€‚è¯¥å·¥ä½œå°†åœ¨ 2 å°æ—¶åè¶…æ—¶ã€‚\nç¤ºä¾‹ 3-è¿è¡Œç¨‹åºè¶…æ—¶å°äºé¡¹ç›®è¶…æ—¶\nrunner è¶…æ—¶è®¾ç½®ä¸º 30 åˆ†é’Ÿï¼Œé¡¹ç›®çš„ CI / CD è¶…æ—¶è®¾ç½®ä¸º 2 å°æ—¶ã€‚å·¥ä½œåœ¨ 30 åˆ†é’Ÿåå°†è¶…æ—¶\n3.18 parallel é…ç½®è¦å¹¶è¡Œè¿è¡Œçš„ä½œä¸šå®ä¾‹æ•°,æ­¤å€¼å¿…é¡»å¤§äºæˆ–ç­‰äº 2 å¹¶ä¸”å°äºæˆ–ç­‰äº 50ã€‚\nè¿™å°†åˆ›å»º N ä¸ªå¹¶è¡Œè¿è¡Œçš„åŒä¸€ä½œä¸šå®ä¾‹. å®ƒä»¬ä»job_name 1/Nåˆ°job_name N/Nä¾æ¬¡å‘½åã€‚\ncodescan: stage: codescan tags: - build only: - master script: - echo \u0026quot;codescan\u0026quot; - sleep 5; parallel: 5 \n3.19 ç»¼åˆå®ä¾‹ before_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com stages: - build - test - codescan - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build script: - echo \u0026quot;mvn clean \u0026quot; - echo \u0026quot;mvn install\u0026quot; - echo \u0026quot;$DOMAIN\u0026quot; after_script: - echo \u0026quot;after script in buildjob\u0026quot; unittest: stage: test script: - ech \u0026quot;run test\u0026quot; when: delayed start_in: '5' allow_failure: true retry: max: 1 when: - script_failure timeout: 1 hours 10 minutes deploy: stage: deploy script: - echo \u0026quot;hello deploy\u0026quot; - sleep 2; when: manual codescan: stage: codescan script: - echo \u0026quot;codescan\u0026quot; - sleep 5; when: on_success parallel: 5 after_script: - echo \u0026quot;after-script\u0026quot; - ech 3.20 only \u0026amp; except only å’Œ except æ˜¯ä¸¤ä¸ªå‚æ•°ç”¨åˆ†æ”¯ç­–ç•¥æ¥é™åˆ¶ jobs æ„å»ºï¼š\n  onlyå®šä¹‰å“ªäº›åˆ†æ”¯å’Œæ ‡ç­¾çš„ git é¡¹ç›®å°†ä¼šè¢« job æ‰§è¡Œã€‚\n  exceptå®šä¹‰å“ªäº›åˆ†æ”¯å’Œæ ‡ç­¾çš„ git é¡¹ç›®å°†ä¸ä¼šè¢« job æ‰§è¡Œã€‚\njob: # use regexp only: - /^issue-.*$/ # use special keyword except: - branches   3.21 rules ruleså…è®¸æŒ‰é¡ºåºè¯„ä¼°å•ä¸ªè§„åˆ™å¯¹è±¡çš„åˆ—è¡¨ï¼Œç›´åˆ°ä¸€ä¸ªåŒ¹é…å¹¶ä¸ºä½œä¸šåŠ¨æ€æä¾›å±æ€§. è¯·æ³¨æ„ï¼Œ rulesä¸èƒ½ä¸only/exceptç»„åˆä½¿ç”¨ã€‚\nå¯ç”¨çš„è§„åˆ™æ¡æ¬¾åŒ…æ‹¬ï¼š\n if ï¼ˆç±»ä¼¼äºonly:variables ï¼‰ changes ï¼ˆ only:changesç›¸åŒï¼‰ exists  3.21.1 rules:if å¦‚æœDOMAINçš„å€¼åŒ¹é…ï¼Œåˆ™éœ€è¦æ‰‹åŠ¨è¿è¡Œã€‚ä¸åŒ¹é…on_successã€‚ æ¡ä»¶åˆ¤æ–­ä»ä¸Šåˆ°ä¸‹ï¼ŒåŒ¹é…å³åœæ­¢ã€‚å¤šæ¡ä»¶åŒ¹é…å¯ä»¥ä½¿ç”¨\u0026amp;\u0026amp; ||\nvariables: DOMAIN: example.com codescan: stage: codescan tags: - build script: - echo \u0026quot;codescan\u0026quot; - sleep 5; #parallel: 5 rules: - if: '$DOMAIN == \u0026quot;example.com\u0026quot;' when: manual - when: on_success 3.21.2 rules:changes æ¥å—æ–‡ä»¶è·¯å¾„æ•°ç»„ã€‚ å¦‚æœæäº¤ä¸­Jenkinsfileæ–‡ä»¶å‘ç”Ÿçš„å˜åŒ–åˆ™ä¸º trueã€‚\ncodescan: stage: codescan tags: - build script: - echo \u0026quot;codescan\u0026quot; - sleep 5; #parallel: 5 rules: - changes: - Jenkinsfile when: manual - if: '$DOMAIN == \u0026quot;example.com\u0026quot;' when: manual - when: on_success 3.21.3 rules:exists æ¥å—æ–‡ä»¶è·¯å¾„æ•°ç»„ã€‚å½“ä»“åº“ä¸­å­˜åœ¨æŒ‡å®šçš„æ–‡ä»¶æ—¶æ“ä½œã€‚\ncodescan: stage: codescan tags: - build script: - echo \u0026quot;codescan\u0026quot; - sleep 5; #parallel: 5 rules: - exists: - Jenkinsfile when: manual - changes: - Jenkinsfile when: on_success - if: '$DOMAIN == \u0026quot;example.com\u0026quot;' when: on_success - when: on_success 3.21.4 rules:allow_failure ä½¿ç”¨allow_failure: true rules:åœ¨ä¸åœæ­¢ç®¡é“æœ¬èº«çš„æƒ…å†µä¸‹å…è®¸ä½œä¸šå¤±è´¥æˆ–æ‰‹åŠ¨ä½œä¸šç­‰å¾…æ“ä½œ.\njob: script: \u0026quot;echo Hello, Rules!\u0026quot; rules: - if: '$CI_MERGE_REQUEST_TARGET_BRANCH_NAME == \u0026quot;master\u0026quot;' when: manual allow_failure: true åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œå¦‚æœç¬¬ä¸€ä¸ªè§„åˆ™åŒ¹é…ï¼Œåˆ™ä½œä¸šå°†å…·æœ‰ä»¥ä¸‹when: manualå’Œallow_failure: trueã€‚\n3.22 workflow:rules é¡¶çº§workflow:å…³é”®å­—é€‚ç”¨äºæ•´ä¸ªç®¡é“ï¼Œå¹¶å°†ç¡®å®šæ˜¯å¦åˆ›å»ºç®¡é“ã€‚when ï¼šå¯ä»¥è®¾ç½®ä¸ºalwaysæˆ–never . å¦‚æœæœªæä¾›ï¼Œåˆ™é»˜è®¤å€¼alwaysã€‚\nvariables: DOMAIN: example.com workflow: rules: - if: '$DOMAIN == \u0026quot;example.com\u0026quot;' - when: always 3.23 ç»¼åˆå®ä¾‹ before_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com workflow: rules: - if: '$DOMAIN == \u0026quot;example.com\u0026quot;' when: always - when: never stages: - build - test - codescan - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build script: - echo \u0026quot;mvn clean \u0026quot; - echo \u0026quot;mvn install\u0026quot; - ech \u0026quot;$DOMAIN\u0026quot; after_script: - echo \u0026quot;after script in buildjob\u0026quot; rules: - exists: - Dockerfile when: on_success allow_failure: true - changes: - Dockerfile when: manual - when: on_failure unittest: stage: test script: - ech \u0026quot;run test\u0026quot; when: delayed start_in: '5' allow_failure: true retry: max: 1 when: - script_failure timeout: 1 hours 10 minutes deploy: stage: deploy script: - echo \u0026quot;hello deploy\u0026quot; - sleep 2; rules: - if: '$DOMAIN == \u0026quot;example.com\u0026quot;' when: manual - if: '$DOMAIN == \u0026quot;aexample.com\u0026quot;' when: delayed start_in: '5' - when: on_failure codescan: stage: codescan script: - echo \u0026quot;codescan\u0026quot; - sleep 5; when: on_success parallel: 5 after_script: - echo \u0026quot;after-script\u0026quot; - ech 3.24 cache ç¼“å­˜ ç”¨æ¥æŒ‡å®šéœ€è¦åœ¨ job ä¹‹é—´ç¼“å­˜çš„æ–‡ä»¶æˆ–ç›®å½•ã€‚åªèƒ½ä½¿ç”¨è¯¥é¡¹ç›®å·¥ä½œç©ºé—´å†…çš„è·¯å¾„ã€‚ä¸è¦ä½¿ç”¨ç¼“å­˜åœ¨é˜¶æ®µä¹‹é—´ä¼ é€’å·¥ä»¶ï¼Œå› ä¸ºç¼“å­˜æ—¨åœ¨å­˜å‚¨ç¼–è¯‘é¡¹ç›®æ‰€éœ€çš„è¿è¡Œæ—¶ä¾èµ–é¡¹ã€‚\nå¦‚æœåœ¨ job èŒƒå›´ä¹‹å¤–å®šä¹‰äº†cache ï¼Œåˆ™æ„å‘³ç€å®ƒæ˜¯å…¨å±€è®¾ç½®ï¼Œæ‰€æœ‰ job éƒ½å°†ä½¿ç”¨è¯¥å®šä¹‰ã€‚å¦‚æœæœªå…¨å±€å®šä¹‰æˆ–æœªæŒ‰ job å®šä¹‰åˆ™ç¦ç”¨è¯¥åŠŸèƒ½ã€‚\n3.24.1 cache:paths ä½¿ç”¨pathsæŒ‡ä»¤é€‰æ‹©è¦ç¼“å­˜çš„æ–‡ä»¶æˆ–ç›®å½•ï¼Œè·¯å¾„æ˜¯ç›¸å¯¹äºé¡¹ç›®ç›®å½•ï¼Œä¸èƒ½ç›´æ¥é“¾æ¥åˆ°é¡¹ç›®ç›®å½•ä¹‹å¤–ã€‚\n$CI_PROJECT_DIR é¡¹ç›®ç›®å½•\nåœ¨ job build ä¸­å®šä¹‰ç¼“å­˜ï¼Œå°†ä¼šç¼“å­˜ target ç›®å½•ä¸‹çš„æ‰€æœ‰.jar æ–‡ä»¶ã€‚\nbuild: script: test cache: paths: - target/*.jar å½“åœ¨å…¨å±€å®šä¹‰äº† cache:paths ä¼šè¢« job ä¸­è¦†ç›–ã€‚ä»¥ä¸‹å®ä¾‹å°†ç¼“å­˜ binaries ç›®å½•ã€‚\ncache: paths: - my/files build: script: echo \u0026quot;hello\u0026quot; cache: key: build paths: - target/ ç”±äºç¼“å­˜æ˜¯åœ¨ job ä¹‹é—´å…±äº«çš„ï¼Œå¦‚æœä¸åŒçš„ job ä½¿ç”¨ä¸åŒçš„è·¯å¾„å°±å‡ºç°äº†ç¼“å­˜è¦†ç›–çš„é—®é¢˜ã€‚å¦‚ä½•è®©ä¸åŒçš„ job ç¼“å­˜ä¸åŒçš„ cache å‘¢ï¼Ÿè®¾ç½®ä¸åŒçš„cache:keyã€‚\n3.24.2 cache:key ç¼“å­˜æ ‡è®° ä¸ºç¼“å­˜åšä¸ªæ ‡è®°ï¼Œå¯ä»¥é…ç½® jobã€åˆ†æ”¯ä¸º key æ¥å®ç°åˆ†æ”¯ã€ä½œä¸šç‰¹å®šçš„ç¼“å­˜ã€‚ä¸ºä¸åŒ job å®šä¹‰äº†ä¸åŒçš„ cache:key æ—¶ï¼Œ ä¼šä¸ºæ¯ä¸ª job åˆ†é…ä¸€ä¸ªç‹¬ç«‹çš„ cacheã€‚cache:keyå˜é‡å¯ä»¥ä½¿ç”¨ä»»ä½•é¢„å®šä¹‰å˜é‡ï¼Œé»˜è®¤default ï¼Œä» GitLab 9.0 å¼€å§‹ï¼Œé»˜è®¤æƒ…å†µä¸‹æ‰€æœ‰å†…å®¹éƒ½åœ¨ç®¡é“å’Œä½œä¸šä¹‹é—´å…±äº«ã€‚\næŒ‰ç…§åˆ†æ”¯è®¾ç½®ç¼“å­˜\ncache: key: ${CI_COMMIT_REF_SLUG} filesï¼š æ–‡ä»¶å‘ç”Ÿå˜åŒ–è‡ªåŠ¨é‡æ–°ç”Ÿæˆç¼“å­˜(files æœ€å¤šæŒ‡å®šä¸¤ä¸ªæ–‡ä»¶)ï¼Œæäº¤çš„æ—¶å€™æ£€æŸ¥æŒ‡å®šçš„æ–‡ä»¶ã€‚\næ ¹æ®æŒ‡å®šçš„æ–‡ä»¶ç”Ÿæˆå¯†é’¥è®¡ç®— SHA æ ¡éªŒå’Œï¼Œå¦‚æœæ–‡ä»¶æœªæ”¹å˜å€¼ä¸º defaultã€‚\ncache: key: files: - Gemfile.lock - package.json paths: - vendor/ruby - node_modules prefix: å…è®¸ç»™å®š prefix çš„å€¼ä¸æŒ‡å®šæ–‡ä»¶ç”Ÿæˆçš„ç§˜é’¥ç»„åˆã€‚\nåœ¨è¿™é‡Œå®šä¹‰äº†å…¨å±€çš„ cacheï¼Œå¦‚æœæ–‡ä»¶å‘ç”Ÿå˜åŒ–åˆ™å€¼ä¸º rspec-xxx111111111222222 ï¼Œæœªå‘ç”Ÿå˜åŒ–ä¸º rspec-defaultã€‚\ncache: key: files: - Gemfile.lock prefix: ${CI_JOB_NAME} paths: - vendor/ruby rspec: script: - bundle exec rspec ä¾‹å¦‚ï¼Œæ·»åŠ $CI_JOB_NAME prefixå°†ä½¿å¯†é’¥çœ‹èµ·æ¥åƒï¼š rspec-feef9576d21ee9b6a32e30c5c79d0a0ceb68d1e5 ï¼Œå¹¶ä¸”ä½œä¸šç¼“å­˜åœ¨ä¸åŒåˆ†æ”¯ä¹‹é—´å…±äº«ï¼Œå¦‚æœåˆ†æ”¯æ›´æ”¹äº†Gemfile.lock ï¼Œåˆ™è¯¥åˆ†æ”¯å°†ä¸ºcacheğŸ”‘fileså…·æœ‰æ–°çš„ SHA æ ¡éªŒå’Œ. å°†ç”Ÿæˆä¸€ä¸ªæ–°çš„ç¼“å­˜å¯†é’¥ï¼Œå¹¶ä¸ºè¯¥å¯†é’¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç¼“å­˜. å¦‚æœGemfile.lockæœªå‘ç”Ÿå˜åŒ– ï¼Œåˆ™å°†å‰ç¼€æ·»åŠ default ï¼Œå› æ­¤ç¤ºä¾‹ä¸­çš„é”®ä¸ºrspec-default ã€‚\n3.24.3 cache:policy ç­–ç•¥ é»˜è®¤ï¼šåœ¨æ‰§è¡Œå¼€å§‹æ—¶ä¸‹è½½æ–‡ä»¶ï¼Œå¹¶åœ¨ç»“æŸæ—¶é‡æ–°ä¸Šä¼ æ–‡ä»¶ã€‚ç§°ä¸ºâ€ pull-pushç¼“å­˜ç­–ç•¥.\npolicy: pull è·³è¿‡ä¸‹è½½æ­¥éª¤\npolicy: push è·³è¿‡ä¸Šä¼ æ­¥éª¤\nstages: - setup - test prepare: stage: setup cache: key: gems paths: - vendor/bundle script: - bundle install --deployment rspec: stage: test cache: key: gems paths: - vendor/bundle policy: pull script: - bundle exec rspec ... 3.25 ç»¼åˆå®ä¾‹(ä¸€) å…¨å±€ç¼“å­˜ before_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com cache: paths: - target/ stages: - build - test - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build tags: - build only: - master script: - ls - id - mvn clean package -DskipTests - ls target - echo \u0026quot;$DOMAIN\u0026quot; - false \u0026amp;\u0026amp; true ; exit_code=$? - if [ $exit_code -ne 0 ]; then echo \u0026quot;Previous command failed\u0026quot;; fi; - sleep 2; after_script: - echo \u0026quot;after script in job\u0026quot; unittest: stage: test tags: - build only: - master script: - echo \u0026quot;run test\u0026quot; - echo 'test' \u0026gt;\u0026gt; target/a.txt - ls target retry: max: 2 when: - script_failure deploy: stage: deploy tags: - build only: - master script: - echo \u0026quot;run deploy\u0026quot; - ls target retry: max: 2 when: - script_failure after_script: - echo \u0026quot;after-script\u0026quot; Pipeline æ—¥å¿—åˆ†æ\nbuild ä½œä¸šè¿è¡Œæ—¶ä¼šå¯¹é¡¹ç›®ä»£ç æ‰“åŒ…ï¼Œç„¶åç”Ÿæˆ target ç›®å½•ã€‚ä½œä¸šç»“æŸåˆ›å»ºç¼“å­˜ã€‚\n\nå¼€å§‹ç¬¬äºŒä¸ªä½œä¸š testï¼Œæ­¤æ—¶ä¼šæŠŠå½“å‰ç›®å½•ä¸­çš„ target ç›®å½•åˆ é™¤æ‰ï¼ˆå› ä¸ºåšäº† git å¯¹æ¯”ï¼‰ã€‚\n\nè·å–åˆ°ç¬¬ä¸€ä¸ªä½œä¸šç”Ÿæˆçš„ç¼“å­˜ target ç›®å½•ã€‚\n\nå¼€å§‹ç¬¬ä¸‰ä¸ªä½œä¸šï¼ŒåŒæ ·å…ˆåˆ é™¤äº† target ç›®å½•ï¼Œç„¶åè·å–äº†ç¬¬äºŒä¸ªä½œä¸šçš„ç¼“å­˜ã€‚æœ€åç”Ÿæˆäº†å½“å‰çš„ç¼“å­˜ã€‚\n\nRunner ç¼“å­˜\nåœ¨åšæœ¬æ¬¡å®éªŒçš„æ—¶å€™æˆ‘ç°åœ¨æœ¬åœ° runner æ¸…é™¤äº†é¡¹ç›®çš„å·¥ä½œç›®å½•å’Œå†å²ç¼“å­˜ã€‚\n[root@zeyang-nuc-service ~]# cd /home/gitlab-runner/builds/1Cxihk7-/0/demo/demo-maven-service/ [root@zeyang-nuc-service demo-maven-service]# ls Jenkinsfile README.md aaaaa jenkins pom.xml src target [root@zeyang-nuc-service demo-maven-service]# cd .. [root@zeyang-nuc-service demo]# ls demo-maven-service demo-maven-service.tmp [root@zeyang-nuc-service demo]# rm -fr demo-maven-service [root@zeyang-nuc-service demo]# rm -fr demo-maven-service.tmp/ [root@zeyang-nuc-service demo]# cd [root@zeyang-nuc-service ~]# cd /home/gitlab-runner/cache/ [root@zeyang-nuc-service cache]# ls demo [root@zeyang-nuc-service cache]# rm -rf * é¡¹ç›®ä»£ç é»˜è®¤ä¸ä¼šåˆ é™¤ï¼Œå¯ä»¥å‘ç°æ˜¯ç¬¬äºŒæ¬¡ä½œä¸šçš„ç¼“å­˜ã€‚ï¼ˆå› ä¸ºä¸Šé¢çš„ä¾‹å­ä¸­ç¬¬ä¸‰æ¬¡ä½œä¸šå¹¶æ²¡æœ‰ä¿®æ”¹ç¼“å­˜å†…å®¹ï¼‰\n[root@zeyang-nuc-service cache]# cd /home/gitlab-runner/builds/1Cxihk7-/0/demo/demo-maven-service/ [root@zeyang-nuc-service demo-maven-service]# ls Jenkinsfile README.md aaaaa jenkins pom.xml src target [root@zeyang-nuc-service demo-maven-service]# cd .. [root@zeyang-nuc-service demo]# ls demo-maven-service demo-maven-service.tmp [root@zeyang-nuc-service demo]# rm -fr * [root@zeyang-nuc-service demo]# ls [root@zeyang-nuc-service demo]# ls demo-maven-service demo-maven-service.tmp [root@zeyang-nuc-service demo]# cd demo-maven-service [root@zeyang-nuc-service demo-maven-service]# ls Jenkinsfile README.md aaaaa jenkins pom.xml src target [root@zeyang-nuc-service demo-maven-service]# cat target/a.txt test è¿›å…¥ runner ç¼“å­˜ç›®å½•ä¸­æŸ¥çœ‹ç¼“å­˜ã€‚\n[root@zeyang-nuc-service ~]# cd /home/gitlab-runner/cache/demo/demo-maven-service/default/ [root@zeyang-nuc-service default]# ls cache.zip [root@zeyang-nuc-service default]# unzip cache.zip Archive: cache.zip creating: target/ inflating: target/a.txt creating: target/classes/ creating: target/classes/com/ creating: target/classes/com/mycompany/ creating: target/classes/com/mycompany/app/ inflating: target/classes/com/mycompany/app/App.class creating: target/maven-archiver/ inflating: target/maven-archiver/pom.properties creating: target/maven-status/ creating: target/maven-status/maven-compiler-plugin/ creating: target/maven-status/maven-compiler-plugin/compile/ creating: target/maven-status/maven-compiler-plugin/compile/default-compile/ inflating: target/maven-status/maven-compiler-plugin/compile/default-compile/createdFiles.lst inflating: target/maven-status/maven-compiler-plugin/compile/default-compile/inputFiles.lst creating: target/maven-status/maven-compiler-plugin/testCompile/ creating: target/maven-status/maven-compiler-plugin/testCompile/default-testCompile/ inflating: target/maven-status/maven-compiler-plugin/testCompile/default-testCompile/createdFiles.lst inflating: target/maven-status/maven-compiler-plugin/testCompile/default-testCompile/inputFiles.lst inflating: target/my-app-1.1-SNAPSHOT.jar creating: target/test-classes/ creating: target/test-classes/com/ creating: target/test-classes/com/mycompany/ creating: target/test-classes/com/mycompany/app/ inflating: target/test-classes/com/mycompany/app/AppTest.class [root@zeyang-nuc-service default]# ls cache.zip target [root@zeyang-nuc-service default]# cd target/ [root@zeyang-nuc-service target]# ls a.txt classes maven-archiver maven-status my-app-1.1-SNAPSHOT.jar test-classes [root@zeyang-nuc-service target]# cat a.txt test æ­¤æ—¶æ­¤åˆ»å†æ¬¡è¿è¡Œæµæ°´çº¿ä½œä¸šï¼Œç¬¬ä¸€ä¸ªä½œä¸šç”¨çš„æ˜¯ä¸Šä¸ªä½œä¸šæœ€åç”Ÿæˆçš„ç¼“å­˜ã€‚\n\nè¿›å…¥ runner ç¼“å­˜ç›®å½•æŸ¥çœ‹,cache.zip æ—¶é—´å·²ç»å‘ç”Ÿçš„å˜åŒ–ã€‚\n[root@zeyang-nuc-service default]# ll total 12 -rw------- 1 gitlab-runner gitlab-runner 9172 Apr 29 10:27 cache.zip drwxrwxr-x 6 root root 127 Apr 29 10:05 target ç»“è®ºï¼š å…¨å±€ç¼“å­˜ç”Ÿæ•ˆäºæœªåœ¨ä½œä¸šä¸­å®šä¹‰ç¼“å­˜çš„æ‰€æœ‰ä½œä¸šï¼Œè¿™ç§æƒ…å†µå¦‚æœæ¯ä¸ªä½œä¸šéƒ½å¯¹ç¼“å­˜ç›®å½•åšäº†æ›´æ”¹ï¼Œä¼šå‡ºç°ç¼“å­˜è¢«è¦†ç›–çš„åœºæ™¯ã€‚\n3.25 ç»¼åˆå®ä¾‹ï¼ˆäºŒï¼‰ æ§åˆ¶ç¼“å­˜ç­–ç•¥\nä¾‹å¦‚ build é˜¶æ®µæˆ‘ä»¬éœ€è¦ç”Ÿæˆæ–°çš„ target ç›®å½•å†…å®¹ï¼Œå¯ä»¥ä¼˜åŒ–è®¾ç½® job è¿è¡Œæ—¶ä¸ä¸‹è½½ç¼“å­˜ã€‚\n\nbefore_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com cache: paths: - target/ stages: - build - test - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build tags: - build only: - master script: - ls - id - cat target/a.txt - mvn clean package -DskipTests - ls target - echo \u0026quot;$DOMAIN\u0026quot; - false \u0026amp;\u0026amp; true ; exit_code=$? - if [ $exit_code -ne 0 ]; then echo \u0026quot;Previous command failed\u0026quot;; fi; - sleep 2; after_script: - echo \u0026quot;after script in job\u0026quot; cache: policy: pull #ä¸ä¸‹è½½ç¼“å­˜ unittest: stage: test tags: - build only: - master script: - echo \u0026quot;run test\u0026quot; - echo 'test' \u0026gt;\u0026gt; target/a.txt - ls target - cat target/a.txt retry: max: 2 when: - script_failure deploy: stage: deploy tags: - build only: - master script: - cat target/a.txt - echo \u0026quot;run deploy\u0026quot; - ls target - echo \u0026quot;deploy\u0026quot; \u0026gt;\u0026gt; target/a.txt retry: max: 2 when: - script_failure after_script: - echo \u0026quot;after-script\u0026quot; 3.26 artifacts ç”¨äºæŒ‡å®šåœ¨ä½œä¸šæˆåŠŸæˆ–è€…å¤±è´¥æ—¶åº”é™„åŠ åˆ°ä½œä¸šçš„æ–‡ä»¶æˆ–ç›®å½•çš„åˆ—è¡¨ã€‚ä½œä¸šå®Œæˆåï¼Œå·¥ä»¶å°†è¢«å‘é€åˆ° GitLabï¼Œå¹¶å¯åœ¨ GitLab UI ä¸­ä¸‹è½½ã€‚\n3.26.1 artifacts:paths è·¯å¾„æ˜¯ç›¸å¯¹äºé¡¹ç›®ç›®å½•çš„ï¼Œä¸èƒ½ç›´æ¥é“¾æ¥åˆ°é¡¹ç›®ç›®å½•ä¹‹å¤–ã€‚\nå°†åˆ¶å“ç›®å½•è®¾ç½®ä¸º target ç›®å½•\nartifacts: paths: - target/ \nç¦ç”¨å·¥ä»¶ä¼ é€’\njob: stage: build script: make build dependencies: [] æ‚¨å¯èƒ½åªæƒ³ä¸ºæ ‡è®°çš„å‘è¡Œç‰ˆåˆ›å»ºæ„ä»¶ï¼Œä»¥é¿å…ç”¨ä¸´æ—¶æ„å»ºæ„ä»¶å¡«å……æ„å»ºæœåŠ¡å™¨å­˜å‚¨ã€‚ä»…ä¸ºæ ‡ç­¾åˆ›å»ºå·¥ä»¶ï¼ˆ default-jobä¸ä¼šåˆ›å»ºå·¥ä»¶ï¼‰ï¼š\ndefault-job: script: - mvn test -U except: - tags release-job: script: - mvn package -U artifacts: paths: - target/*.war only: - tags 3.26.2 artifacts:expose_as å…³é”®å­—expose_aså¯ç”¨äºåœ¨åˆå¹¶è¯·æ±‚ UI ä¸­å…¬å¼€ job çš„åˆ¶å“æ–‡ä»¶ã€‚\nä¾‹å¦‚ï¼Œè¦åŒ¹é…å•ä¸ªæ–‡ä»¶ï¼š\n1 2 3 4 5 6 7  test:script:- echo1artifacts:expose_as:\u0026#34;artifact 1\u0026#34;paths:- path/to/file.txt  ä½¿ç”¨æ­¤é…ç½®ï¼ŒGitLab å°†åœ¨æŒ‡å‘çš„ç›¸å…³åˆå¹¶è¯·æ±‚ä¸­æ·»åŠ é“¾æ¥file1.txtã€‚\n\næŸ¥çœ‹åˆ¶å“æ–‡ä»¶\n\nè¯·æ³¨æ„ä»¥ä¸‹å‡ ç‚¹ï¼š\n æ¯ä¸ªåˆå¹¶è¯·æ±‚æœ€å¤šå¯ä»¥å…¬å¼€ 10 ä¸ªä½œä¸šå·¥ä»¶ã€‚ å¦‚æœæŒ‡å®šäº†ç›®å½•ï¼Œé‚£ä¹ˆå¦‚æœç›®å½•ä¸­æœ‰å¤šä¸ªæ–‡ä»¶ï¼Œåˆ™è¯¥é“¾æ¥å°†æŒ‡å‘æŒ‡å‘ä½œä¸šå·¥ä»¶æµè§ˆå™¨ã€‚ å¦‚æœå¼€å¯ GitlabPages å¯ä»¥å¯¹.html .htm .txt .json .log æ‰©å±•åå•ä¸ªæ–‡ä»¶å·¥ä»¶æ¸²æŸ“å·¥ä»¶ã€‚  3.26.3 artifacts:name é€šè¿‡nameæŒ‡ä»¤å®šä¹‰æ‰€åˆ›å»ºçš„å·¥ä»¶å­˜æ¡£çš„åç§°ã€‚å¯ä»¥ä¸ºæ¯ä¸ªå½’æ¡£ä½¿ç”¨å”¯ä¸€çš„åç§°ã€‚ artifacts:nameå˜é‡å¯ä»¥ä½¿ç”¨ä»»ä½•é¢„å®šä¹‰å˜é‡ã€‚é»˜è®¤åç§°æ˜¯artifactsï¼Œä¸‹è½½artifactsæ”¹ä¸ºartifacts.zipã€‚\nä½¿ç”¨å½“å‰ä½œä¸šçš„åç§°åˆ›å»ºæ¡£æ¡ˆ\njob: artifacts: name: \u0026quot;$CI_JOB_NAME\u0026quot; paths: - binaries/ ä½¿ç”¨å†…éƒ¨åˆ†æ”¯æˆ–æ ‡è®°çš„åç§°ï¼ˆä»…åŒ…æ‹¬ binaries ç›®å½•ï¼‰åˆ›å»º artifactsï¼Œ\njob: artifacts: name: \u0026quot;$CI_COMMIT_REF_NAME\u0026quot; paths: - binaries/ ä½¿ç”¨å½“å‰ä½œä¸šçš„åç§°å’Œå½“å‰åˆ†æ”¯æˆ–æ ‡è®°ï¼ˆä»…åŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶ç›®å½•ï¼‰åˆ›å»º artifacts\njob: artifacts: name: \u0026quot;$CI_JOB_NAME-$CI_COMMIT_REF_NAME\u0026quot; paths: - binaries/ è¦åˆ›å»ºä¸€ä¸ªå…·æœ‰å½“å‰é˜¶æ®µåç§°å’Œåˆ†æ”¯åç§°çš„ artifacts\njob: artifacts: name: \u0026quot;$CI_JOB_STAGE-$CI_COMMIT_REF_NAME\u0026quot; paths: - binaries/ 3.26.4 artifacts:when ç”¨äºåœ¨ä½œä¸šå¤±è´¥æ—¶æˆ–å°½ç®¡å¤±è´¥è€Œä¸Šä¼ å·¥ä»¶ã€‚on_success ä»…åœ¨ä½œä¸šæˆåŠŸæ—¶ä¸Šè½½å·¥ä»¶ã€‚è¿™æ˜¯é»˜è®¤å€¼ã€‚on_failure ä»…åœ¨ä½œä¸šå¤±è´¥æ—¶ä¸Šè½½å·¥ä»¶ã€‚always ä¸Šè½½å·¥ä»¶ï¼Œæ— è®ºä½œä¸šçŠ¶æ€å¦‚ä½•ã€‚\nè¦ä»…åœ¨ä½œä¸šå¤±è´¥æ—¶ä¸Šä¼ å·¥ä»¶ï¼š\njob: artifacts: when: on_failure 3.26.5 artifacts:expire_in åˆ¶å“çš„æœ‰æ•ˆæœŸï¼Œä»ä¸Šä¼ å’Œå­˜å‚¨åˆ° GitLab çš„æ—¶é—´å¼€å§‹ç®—èµ·ã€‚å¦‚æœæœªå®šä¹‰è¿‡æœŸæ—¶é—´ï¼Œåˆ™é»˜è®¤ä¸º 30 å¤©ã€‚\nexpire_inçš„å€¼ä»¥ç§’ä¸ºå•ä½çš„ç»è¿‡æ—¶é—´ï¼Œé™¤éæä¾›äº†å•ä½ã€‚å¯è§£æå€¼çš„ç¤ºä¾‹ï¼š\nâ€˜42â€™ â€˜3 mins 4 secâ€™ â€˜2 hrs 20 minâ€™ â€˜2h20minâ€™ â€˜6 mos 1 dayâ€™ â€˜47 yrs 6 mos and 4dâ€™ â€˜3 weeks and 2 daysâ€™ ä¸€å‘¨åè¿‡æœŸ\njob: artifacts: expire_in: 1 week 3.26.6 artifacts:reports ç”¨äºä»ä½œä¸šä¸­æ”¶é›†æµ‹è¯•æŠ¥å‘Šï¼Œä»£ç è´¨é‡æŠ¥å‘Šå’Œå®‰å…¨æŠ¥å‘Š. åœ¨ GitLab çš„ UI ä¸­æ˜¾ç¤ºè¿™äº›æŠ¥å‘Šã€‚\n**æ³¨æ„ï¼š**æ— è®ºä½œä¸šç»“æœï¼ˆæˆåŠŸæˆ–å¤±è´¥ï¼‰ï¼Œéƒ½å°†æ”¶é›†æµ‹è¯•æŠ¥å‘Šã€‚\n artifacts:reports:junit  æ”¶é›† junit å•å…ƒæµ‹è¯•æŠ¥å‘Šï¼Œæ”¶é›†çš„ JUnit æŠ¥å‘Šå°†ä½œä¸ºå·¥ä»¶ä¸Šä¼ åˆ° GitLabï¼Œå¹¶å°†è‡ªåŠ¨æ˜¾ç¤ºåœ¨åˆå¹¶è¯·æ±‚ä¸­ã€‚\nbuild: stage: build tags: - build only: - master script: - mvn test - mvn cobertura:cobertura - ls target artifacts: name: \u0026quot;$CI_JOB_NAME-$CI_COMMIT_REF_NAME\u0026quot; when: on_success expose_as: 'artifact 1' paths: - target/*.jar reports: junit: target/surefire-reports/TEST-*.xml **æ³¨æ„ï¼š**å¦‚æœæ‚¨ä½¿ç”¨çš„ JUnit å·¥å…·å¯¼å‡ºåˆ°å¤šä¸ª XML æ–‡ä»¶ï¼Œåˆ™å¯ä»¥åœ¨ä¸€ä¸ªä½œä¸šä¸­æŒ‡å®šå¤šä¸ªæµ‹è¯•æŠ¥å‘Šè·¯å¾„ï¼Œå®ƒä»¬å°†è¢«è‡ªåŠ¨ä¸²è”åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­. ä½¿ç”¨æ–‡ä»¶åæ¨¡å¼ï¼ˆ junit: rspec-*.xml ï¼‰ï¼Œæ–‡ä»¶åæ•°ç»„ï¼ˆ junit: [rspec-1.xml, rspec-2.xml, rspec-3.xml] ï¼‰æˆ–å…¶ç»„åˆï¼ˆ junit: [rspec.xml, test-results/TEST-*.xml] ï¼‰ã€‚\n\n\nå¦‚æœæ— æ³•æ˜¾ç¤ºæ­¤é¡µé¢ï¼Œéœ€è¦æ›´æ”¹ç³»ç»Ÿè®¾ç½®ã€‚æ­¤é€‰é¡¹å¯èƒ½ä¼šåŠ å¤§èµ„æºå ç”¨ï¼Œé»˜è®¤ç¦ç”¨äº†éœ€è¦å¯ç”¨ã€‚\nç™»å½•gitlab su - git $ gitlab-rails console -------------------------------------------------------------------------------- GitLab: 12.9.0 (9a382ff2c82) FOSS GitLab Shell: 12.0.0 PostgreSQL: 10.12 -------------------------------------------------------------------------------- Feature.enable(:junit_pipeline_view)Loading production environment (Rails 6.0.2) irb(main):001:0\u0026gt; irb(main):002:0\u0026gt; irb(main):003:0\u0026gt; Feature.enable(:junit_pipeline_view) =\u0026gt; true irb(main):004:0\u0026gt; å‚è€ƒé“¾æ¥ï¼šhttps://docs.gitlab.com/ee/ci/junit_test_reports.html\n artifacts:reports:cobertura  æ”¶é›†çš„ Cobertura è¦†ç›–ç‡æŠ¥å‘Šå°†ä½œä¸ºå·¥ä»¶ä¸Šä¼ åˆ° GitLabï¼Œå¹¶åœ¨åˆå¹¶è¯·æ±‚ä¸­è‡ªåŠ¨æ˜¾ç¤ºã€‚\nbuild: stage: build tags: - build only: - master script: - mvn test - mvn cobertura:cobertura - ls target artifacts: name: \u0026quot;$CI_JOB_NAME-$CI_COMMIT_REF_NAME\u0026quot; when: on_success expose_as: 'artifact 1' paths: - target/*.jar reports: junit: target/surefire-reports/TEST-*.xml cobertura: target/site/cobertura/coverage.xml $ gitlab-rails console -------------------------------------------------------------------------------- GitLab: 12.9.0 (9a382ff2c82) FOSS GitLab Shell: 12.0.0 PostgreSQL: 10.12 -------------------------------------------------------------------------------- Loading production environment (Rails 6.0.2) irb(main):001:0\u0026gt; irb(main):002:0\u0026gt; irb(main):003:0\u0026gt; Feature.enable(:coverage_report_view) =\u0026gt; true  maven é›†æˆ cobertura æ’ä»¶  \u0026lt;plugins\u0026gt; \u0026lt;!-- cobertura plugin start --\u0026gt; \u0026lt;plugin\u0026gt; \u0026lt;groupId\u0026gt;org.codehaus.mojo\u0026lt;/groupId\u0026gt; \u0026lt;artifactId\u0026gt;cobertura-maven-plugin\u0026lt;/artifactId\u0026gt; \u0026lt;version\u0026gt;2.7\u0026lt;/version\u0026gt; \u0026lt;configuration\u0026gt; \u0026lt;formats\u0026gt; \u0026lt;format\u0026gt;html\u0026lt;/format\u0026gt; \u0026lt;format\u0026gt;xml\u0026lt;/format\u0026gt; \u0026lt;/formats\u0026gt; \u0026lt;/configuration\u0026gt; \u0026lt;/plugin\u0026gt; \u0026lt;!-- cobertura plugin end --\u0026gt; \u0026lt;/plugins\u0026gt; æ‰§è¡Œ mvn cobertura:cobertura è¿è¡Œæµ‹è¯•å¹¶äº§ç”Ÿ Cobertura è¦†ç›–ç‡æŠ¥å‘Šã€‚\nå‚è€ƒé“¾æ¥ï¼šhttps://docs.gitlab.com/12.9/ee/user/project/merge_requests/test_coverage_visualization.html\nå¤‡æ³¨: å®éªŒæœªåšå‡ºæ•ˆæœï¼Œå…·ä½“é—®é¢˜å¾…æ’æŸ¥ã€‚\n\n3.27 dependencies å®šä¹‰è¦è·å–å·¥ä»¶çš„ä½œä¸šåˆ—è¡¨ï¼Œåªèƒ½ä»å½“å‰é˜¶æ®µä¹‹å‰æ‰§è¡Œçš„é˜¶æ®µå®šä¹‰ä½œä¸šã€‚å®šä¹‰ä¸€ä¸ªç©ºæ•°ç»„å°†è·³è¿‡ä¸‹è½½è¯¥ä½œä¸šçš„ä»»ä½•å·¥ä»¶ä¸ä¼šè€ƒè™‘å…ˆå‰ä½œä¸šçš„çŠ¶æ€ï¼Œå› æ­¤ï¼Œå¦‚æœå®ƒå¤±è´¥æˆ–æ˜¯æœªè¿è¡Œçš„æ‰‹åŠ¨ä½œä¸šï¼Œåˆ™ä¸ä¼šå‘ç”Ÿé”™è¯¯ã€‚\n\nå¦‚æœè®¾ç½®ä¸ºä¾èµ–é¡¹çš„ä½œä¸šçš„å·¥ä»¶å·²è¿‡æœŸæˆ–åˆ é™¤ï¼Œé‚£ä¹ˆä¾èµ–é¡¹ä½œä¸šå°†å¤±è´¥ã€‚\n3.28 ç»¼åˆå®ä¾‹ before_script: - echo \u0026quot;before-script!!\u0026quot; variables: DOMAIN: example.com cache: paths: - target/ stages: - build - test - deploy build: before_script: - echo \u0026quot;before-script in job\u0026quot; stage: build tags: - build only: - master script: - ls - id - mvn test - mvn cobertura:cobertura - ls target - echo \u0026quot;$DOMAIN\u0026quot; - false \u0026amp;\u0026amp; true ; exit_code=$? - if [ $exit_code -ne 0 ]; then echo \u0026quot;Previous command failed\u0026quot;; fi; - sleep 2; after_script: - echo \u0026quot;after script in job\u0026quot; artifacts: name: \u0026quot;$CI_JOB_NAME-$CI_COMMIT_REF_NAME\u0026quot; when: on_success #expose_as: 'artifact 1' paths: - target/*.jar #- target/surefire-reports/TEST*.xml reports: junit: target/surefire-reports/TEST-*.xml cobertura: target/site/cobertura/coverage.xml coverage: '/Code coverage: \\d+\\.\\d+/' unittest: dependencies: - build stage: test tags: - build only: - master script: - echo \u0026quot;run test\u0026quot; - echo 'test' \u0026gt;\u0026gt; target/a.txt - ls target retry: max: 2 when: - script_failure deploy: stage: deploy tags: - build only: - master script: - echo \u0026quot;run deploy\u0026quot; - ls target retry: max: 2 when: - script_failure after_script: - echo \u0026quot;after-script\u0026quot; 3.29 needs å¹¶è¡Œé˜¶æ®µ å¯æ— åºæ‰§è¡Œä½œä¸šï¼Œæ— éœ€æŒ‰ç…§ stages é¡ºåºè¿è¡ŒæŸäº› jobsï¼Œå¯ä»¥è®©å¤šä¸ª stage åŒæ—¶è¿è¡Œã€‚\nstages: - build - test - deploy module-a-build: stage: build script: - echo \u0026quot;hello3a\u0026quot; - sleep 10 module-b-build: stage: build script: - echo \u0026quot;hello3b\u0026quot; - sleep 10 module-a-test: stage: test script: - echo \u0026quot;hello3a\u0026quot; - sleep 10 needs: [\u0026quot;module-a-build\u0026quot;] module-b-test: stage: test script: - echo \u0026quot;hello3b\u0026quot; - sleep 10 needs: [\u0026quot;module-b-build\u0026quot;] \nå¦‚æœneeds:è®¾ç½®ä¸ºæŒ‡å‘å› only/exceptè§„åˆ™è€Œæœªå®ä¾‹åŒ–çš„ä½œä¸šï¼Œæˆ–è€…ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºç®¡é“æ—¶ä¼šå‡ºç° YAML é”™è¯¯ã€‚\næš‚æ—¶é™åˆ¶äº†ä½œä¸šåœ¨needs:å¯èƒ½éœ€è¦çš„æœ€å¤§ä½œä¸šæ•°åˆ†é…,ci_dag_limit_needsåŠŸèƒ½æ ‡å¿—å·²å¯ç”¨ï¼ˆé»˜è®¤ï¼‰åˆ†é… 10 ä¸ªï¼Œå¦‚æœåŠŸèƒ½è¢«ç¦ç”¨ä¸º 50ã€‚\nFeature::disable(:ci_dag_limit_needs) # 50 Feature::enable(:ci_dag_limit_needs) #10 3.30 åˆ¶å“ä¸‹è½½ åœ¨ä½¿ç”¨needsï¼Œå¯é€šè¿‡artifacts: trueæˆ–artifacts: falseæ¥æ§åˆ¶å·¥ä»¶ä¸‹è½½ã€‚ é»˜è®¤ä¸æŒ‡å®šä¸º trueã€‚\nmodule-a-test: stage: test script: - echo \u0026quot;hello3a\u0026quot; - sleep 10 needs: - job: \u0026quot;module-a-build\u0026quot; artifacts: true ç›¸åŒé¡¹ç›®ä¸­çš„ç®¡é“åˆ¶å“ä¸‹è½½,é€šè¿‡å°†projectå…³é”®å­—è®¾ç½®ä¸ºå½“å‰é¡¹ç›®çš„åç§°ï¼Œå¹¶æŒ‡å®šå¼•ç”¨ï¼Œå¯ä»¥ä½¿ç”¨needsä»å½“å‰é¡¹ç›®çš„ä¸åŒç®¡é“ä¸­ä¸‹è½½å·¥ä»¶ã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œbuild_jobå°†ä½¿ç”¨other-refref ä¸‹è½½æœ€æ–°æˆåŠŸçš„build-1ä½œä¸šçš„å·¥ä»¶ï¼š\nbuild_job: stage: build script: - ls -lhR needs: - project: group/same-project-name job: build-1 ref: other-ref artifacts: true ä¸æ”¯æŒä»parallel:è¿è¡Œçš„ä½œä¸šä¸­ä¸‹è½½å·¥ä»¶ã€‚\n3.31 include https://gitlab.com/gitlab-org/gitlab/-/tree/master/lib/gitlab/ci/templates\nå¯ä»¥å…è®¸å¼•å…¥å¤–éƒ¨ YAML æ–‡ä»¶ï¼Œæ–‡ä»¶å…·æœ‰æ‰©å±•å.ymlæˆ–.yaml ã€‚ä½¿ç”¨åˆå¹¶åŠŸèƒ½å¯ä»¥è‡ªå®šä¹‰å’Œè¦†ç›–åŒ…å«æœ¬åœ°å®šä¹‰çš„ CI / CD é…ç½®ã€‚ç›¸åŒçš„ job ä¼šåˆå¹¶ï¼Œå‚æ•°å€¼ä»¥æºæ–‡ä»¶ä¸ºå‡†ã€‚\n3.32 local å¼•å…¥åŒä¸€å­˜å‚¨åº“ä¸­çš„æ–‡ä»¶ï¼Œä½¿ç”¨ç›¸å¯¹äºæ ¹ç›®å½•çš„å®Œæ•´è·¯å¾„è¿›è¡Œå¼•ç”¨ï¼Œä¸é…ç½®æ–‡ä»¶åœ¨åŒä¸€åˆ†æ”¯ä¸Šä½¿ç”¨ã€‚\nci/localci.yml: å®šä¹‰ä¸€ä¸ªä½œä¸šç”¨äºå‘å¸ƒã€‚\nstages: - deploy deployjob: stage: deploy script: - echo 'deploy' .gitlab-ci.yml å¼•å…¥æœ¬åœ°çš„ CI æ–‡ä»¶â€™ci/localci.ymlâ€™ã€‚\ninclude: local: 'ci/localci.yml' stages: - build - test - deploy buildjob: stage: build script: ls testjob: stage: test script: ls æ•ˆæœ\n\n3.33 file åŒ…å«æ¥è‡ªå¦ä¸€ä¸ªé¡¹ç›®çš„æ–‡ä»¶\ninclude: - project: demo/demo-java-service ref: master file: '.gitlab-ci.yml' 3.34 template åªèƒ½ä½¿ç”¨å®˜æ–¹æä¾›çš„æ¨¡æ¿ https://gitlab.com/gitlab-org/gitlab/tree/master/lib/gitlab/ci/templates\ninclude: - template: Auto-DevOps.gitlab-ci.yml 3.35 remote ç”¨äºé€šè¿‡ HTTP / HTTPS åŒ…å«æ¥è‡ªå…¶ä»–ä½ç½®çš„æ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨å®Œæ•´ URL è¿›è¡Œå¼•ç”¨. è¿œç¨‹æ–‡ä»¶å¿…é¡»å¯ä»¥é€šè¿‡ç®€å•çš„ GET è¯·æ±‚å…¬å¼€è®¿é—®ï¼Œå› ä¸ºä¸æ”¯æŒè¿œç¨‹ URL ä¸­çš„èº«ä»½éªŒè¯æ¶æ„ã€‚\ninclude: - remote: 'https://gitlab.com/awesome-project/raw/master/.gitlab-ci-template.yml' 3.36 extends ç»§æ‰¿æ¨¡æ¿ jobs\nstages: - test variables: RSPEC: 'test' .tests: script: echo \u0026quot;mvn test\u0026quot; stage: test only: refs: - branches testjob: extends: .tests script: echo \u0026quot;mvn clean test\u0026quot; only: variables: - $RSPEC åˆå¹¶å\ntestjob: stage: test script: mvn clean test only: variables: - $RSPEC refs: - branches 3.37 extends \u0026amp; include aa.yml\n#stages: # - deploy deployjob: stage: deploy script: - echo 'deploy' only: - dev .template: stage: build script: - echo \u0026quot;build\u0026quot; only: - master include: local: 'ci/localci.yml' stages: - test - build - deploy variables: RSPEC: 'test' .tests: script: echo \u0026quot;mvn test\u0026quot; stage: test only: refs: - branches testjob: extends: .tests script: echo \u0026quot;mvn clean test\u0026quot; only: variables: - $RSPEC newbuildjob: script: - echo \u0026quot;123\u0026quot; extends: .template è¿™å°†è¿è¡Œåä¸ºuseTemplateçš„ä½œä¸šï¼Œè¯¥ä½œä¸šè¿è¡Œecho Hello! å¦‚.templateä½œä¸šä¸­æ‰€å®šä¹‰ï¼Œå¹¶ä½¿ç”¨æœ¬åœ°ä½œä¸šä¸­æ‰€å®šä¹‰çš„alpine Docker æ˜ åƒ.\n3.38 trigger ç®¡é“è§¦å‘ å½“ GitLab ä»triggerå®šä¹‰åˆ›å»ºçš„ä½œä¸šå¯åŠ¨æ—¶ï¼Œå°†åˆ›å»ºä¸€ä¸ªä¸‹æ¸¸ç®¡é“ã€‚å…è®¸åˆ›å»ºå¤šé¡¹ç›®ç®¡é“å’Œå­ç®¡é“ã€‚å°†triggerä¸when:manualä¸€èµ·ä½¿ç”¨ä¼šå¯¼è‡´é”™è¯¯ã€‚\n  å¤šé¡¹ç›®ç®¡é“ï¼š è·¨å¤šä¸ªé¡¹ç›®è®¾ç½®æµæ°´çº¿ï¼Œä»¥ä¾¿ä¸€ä¸ªé¡¹ç›®ä¸­çš„ç®¡é“å¯ä»¥è§¦å‘å¦ä¸€ä¸ªé¡¹ç›®ä¸­çš„ç®¡é“ã€‚[å¾®æœåŠ¡æ¶æ„]\n  çˆ¶å­ç®¡é“: åœ¨åŒä¸€é¡¹ç›®ä¸­ç®¡é“å¯ä»¥è§¦å‘ä¸€ç»„åŒæ—¶è¿è¡Œçš„å­ç®¡é“,å­ç®¡é“ä»ç„¶æŒ‰ç…§é˜¶æ®µé¡ºåºæ‰§è¡Œå…¶æ¯ä¸ªä½œä¸šï¼Œä½†æ˜¯å¯ä»¥è‡ªç”±åœ°ç»§ç»­æ‰§è¡Œå„ä¸ªé˜¶æ®µï¼Œè€Œä¸å¿…ç­‰å¾…çˆ¶ç®¡é“ä¸­æ— å…³çš„ä½œä¸šå®Œæˆã€‚\n  3.39 å¤šé¡¹ç›®ç®¡é“ å½“å‰é¢é˜¶æ®µè¿è¡Œå®Œæˆåï¼Œè§¦å‘ demo/demo-java-service é¡¹ç›® master æµæ°´çº¿ã€‚åˆ›å»ºä¸Šæ¸¸ç®¡é“çš„ç”¨æˆ·éœ€è¦å…·æœ‰å¯¹ä¸‹æ¸¸é¡¹ç›®çš„è®¿é—®æƒé™ã€‚å¦‚æœå‘ç°ä¸‹æ¸¸é¡¹ç›®ç”¨æˆ·æ²¡æœ‰è®¿é—®æƒé™ä»¥åœ¨å…¶ä¸­åˆ›å»ºç®¡é“ï¼Œåˆ™stagingä½œä¸šå°†è¢«æ ‡è®°ä¸ºå¤±è´¥ã€‚\nstaging: variables: ENVIRONMENT: staging stage: deploy trigger: project: demo/demo-java-service branch: master strategy: depend projectå…³é”®å­—ï¼Œç”¨äºæŒ‡å®šä¸‹æ¸¸é¡¹ç›®çš„å®Œæ•´è·¯å¾„ã€‚è¯¥branchå…³é”®å­—æŒ‡å®šç”±æŒ‡å®šçš„é¡¹ç›®åˆ†æ”¯çš„åç§°ã€‚ä½¿ç”¨variableså…³é”®å­—å°†å˜é‡ä¼ é€’åˆ°ä¸‹æ¸¸ç®¡é“ã€‚ å…¨å±€å˜é‡ä¹Ÿä¼šä¼ é€’ç»™ä¸‹æ¸¸é¡¹ç›®ã€‚ä¸Šæ¸¸ç®¡é“ä¼˜å…ˆäºä¸‹æ¸¸ç®¡é“ã€‚å¦‚æœåœ¨ä¸Šæ¸¸å’Œä¸‹æ¸¸é¡¹ç›®ä¸­å®šä¹‰äº†ä¸¤ä¸ªå…·æœ‰ç›¸åŒåç§°çš„å˜é‡ï¼Œåˆ™åœ¨ä¸Šæ¸¸é¡¹ç›®ä¸­å®šä¹‰çš„å˜é‡å°†ä¼˜å…ˆã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€æ—¦åˆ›å»ºä¸‹æ¸¸ç®¡é“ï¼Œtriggerä½œä¸šå°±ä¼šä»¥successçŠ¶æ€å®Œæˆã€‚strategy: dependå°†è‡ªèº«çŠ¶æ€ä»è§¦å‘çš„ç®¡é“åˆå¹¶åˆ°æºä½œä¸šã€‚\n\nåœ¨ä¸‹æ¸¸é¡¹ç›®ä¸­æŸ¥çœ‹ç®¡é“ä¿¡æ¯\n\nåœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œä¸€æ—¦åˆ›å»ºäº†ä¸‹æ¸¸ç®¡é“ï¼Œè¯¥stagingå°†è¢«æ ‡è®°ä¸ºæˆåŠŸã€‚\n3.40 çˆ¶å­ç®¡é“ åˆ›å»ºå­ç®¡é“ ci/child01.yml\nstages: - build child-a-build: stage: build script: - echo \u0026quot;hello3a\u0026quot; - sleep 10 åœ¨çˆ¶ç®¡é“è§¦å‘å­ç®¡é“\nstaging2: variables: ENVIRONMENT: staging stage: deploy trigger: include: ci/child01.yml strategy: depend \nå‡†å¤‡å·¥ä½œæ³¨å†Œ docker ç±»å‹çš„ runner\ngitlab-runner register \\ --non-interactive \\ --executor \u0026quot;docker\u0026quot; \\ --docker-image alpine:latest \\ --url \u0026quot;http://192.168.1.200:30088/\u0026quot; \\ --registration-token \u0026quot;JRzzw2j1Ji6aBjwvkxAv\u0026quot; \\ --description \u0026quot;docker-runner\u0026quot; \\ --tag-list \u0026quot;newdocker\u0026quot; \\ --run-untagged=\u0026quot;true\u0026quot; \\ --locked=\u0026quot;false\u0026quot; \\ --docker-privileged \\ --access-level=\u0026quot;not_protected\u0026quot; [[runners]] name = \u0026quot;docker-runner\u0026quot; url = \u0026quot;http://192.168.1.200:30088/\u0026quot; token = \u0026quot;xuaLZD7xUVviTsyeJAWh\u0026quot; executor = \u0026quot;docker\u0026quot; [runners.custom_build_dir] [runners.cache] [runners.cache.s3] [runners.cache.gcs] [runners.docker] pull_policy = \u0026quot;if-not-present\u0026quot; tls_verify = false image = \u0026quot;alpine:latest\u0026quot; privileged = true disable_entrypoint_overwrite = false oom_kill_disable = false disable_cache = false volumes = [\u0026quot;/cache\u0026quot;] shm_size = 0 3.41 image é»˜è®¤åœ¨æ³¨å†Œ runner çš„æ—¶å€™éœ€è¦å¡«å†™ä¸€ä¸ªåŸºç¡€çš„é•œåƒï¼Œè¯·è®°ä½ä¸€ç‚¹åªè¦ä½¿ç”¨æ‰§è¡Œå™¨ä¸º docker ç±»å‹çš„ runner æ‰€æœ‰çš„æ“ä½œè¿è¡Œéƒ½ä¼šåœ¨å®¹å™¨ä¸­è¿è¡Œã€‚ å¦‚æœå…¨å±€æŒ‡å®šäº† images åˆ™æ‰€æœ‰ä½œä¸šä½¿ç”¨æ­¤ image åˆ›å»ºå®¹å™¨å¹¶åœ¨å…¶ä¸­è¿è¡Œã€‚ å…¨å±€æœªæŒ‡å®š imageï¼Œå†æ¬¡æŸ¥çœ‹ job ä¸­æ˜¯å¦æœ‰æŒ‡å®šï¼Œå¦‚æœæœ‰æ­¤ job æŒ‰ç…§æŒ‡å®šé•œåƒåˆ›å»ºå®¹å™¨å¹¶è¿è¡Œï¼Œæ²¡æœ‰åˆ™ä½¿ç”¨æ³¨å†Œ runner æ—¶æŒ‡å®šçš„é»˜è®¤é•œåƒã€‚\n#image: maven:3.6.3-jdk-8 before_script: - ls build: image: maven:3.6.3-jdk-8 stage: build tags: - newdocker script: - ls - sleep 2 - echo \u0026quot;mvn clean \u0026quot; - sleep 10 deploy: stage: deploy tags: - newdocker script: - echo \u0026quot;deploy\u0026quot; 3.42 services å·¥ä½œæœŸé—´è¿è¡Œçš„å¦ä¸€ä¸ª Docker æ˜ åƒï¼Œå¹¶ link åˆ°imageå…³é”®å­—å®šä¹‰çš„ Docker æ˜ åƒã€‚è¿™æ ·ï¼Œæ‚¨å°±å¯ä»¥åœ¨æ„å»ºæœŸé—´è®¿é—®æœåŠ¡æ˜ åƒ.\næœåŠ¡æ˜ åƒå¯ä»¥è¿è¡Œä»»ä½•åº”ç”¨ç¨‹åºï¼Œä½†æ˜¯æœ€å¸¸è§çš„ç”¨ä¾‹æ˜¯è¿è¡Œæ•°æ®åº“å®¹å™¨ï¼Œä¾‹å¦‚mysql ã€‚ä¸æ¯æ¬¡å®‰è£…é¡¹ç›®æ—¶éƒ½å®‰è£…mysqlç›¸æ¯”ï¼Œä½¿ç”¨ç°æœ‰æ˜ åƒå¹¶å°†å…¶ä½œä¸ºé™„åŠ å®¹å™¨è¿è¡Œæ›´å®¹æ˜“ï¼Œæ›´å¿«æ·ã€‚\nservices: - name: mysql:latest alias: mysql-1 3.43 environment deploy to production: stage: deploy script: git push production HEAD:master environment: name: production url: https://prod.example.com 3.44 inherit ä½¿ç”¨æˆ–ç¦ç”¨å…¨å±€å®šä¹‰çš„ç¯å¢ƒå˜é‡ï¼ˆvariablesï¼‰æˆ–é»˜è®¤å€¼(default)ã€‚\nä½¿ç”¨ trueã€false å†³å®šæ˜¯å¦ä½¿ç”¨ï¼Œé»˜è®¤ä¸º true\ninherit: default: false variables: false ç»§æ‰¿å…¶ä¸­çš„ä¸€éƒ¨åˆ†å˜é‡æˆ–é»˜è®¤å€¼ä½¿ç”¨ list\ninherit: default: - parameter1 - parameter2 variables: - VARIABLE1 - VARIABLE2 4 æ¨¡æ¿åº“è®¾è®¡ ä¸ºäº†å®ç°æ¨¡æ¿å¤ç”¨ï¼Œå‡å°‘é‡å¤ä»£ç ã€‚æœ¬æ¬¡è¯¾ç¨‹å¼€å§‹æˆ‘ä»¬å°†ä½¿ç”¨æ¨¡æ¿åº“æ¥å®Œæˆæµæ°´çº¿ã€‚å¼€å§‹ä¹‹å‰è¿˜æ˜¯è¦æŠŠè¯­æ³•å­¦å¥½ä¾¿äºè¿›ä¸€æ­¥å®æ–½ã€‚\nåˆ›å»ºä¸€ä¸ª git ä»“åº“ç”¨äºå­˜æ”¾æ¨¡æ¿demo/demo-gitlabci-service ï¼Œç„¶ååˆ›å»ºä¸€ä¸ª template ç›®å½•å­˜æ”¾æ‰€æœ‰ pipeline çš„æ¨¡æ¿ï¼Œåˆ›å»ºä¸€ä¸ª jobs ç›®å½•å­˜æ”¾ job æ¨¡æ¿ã€‚\nè¿™æ ·æˆ‘ä»¬å¯ä»¥å°†ä¸€äº› mavenã€antã€gradleã€npm å·¥å…·é€šè¿‡ä¸€ä¸ª job æ¨¡æ¿å’Œä¸åŒçš„æ„å»ºå‘½ä»¤å®ç°ã€‚templates çš„å¥½å¤„æ˜¯æˆ‘ä»¬åœ¨å…¶ä¸­å®šä¹‰äº†æ¨¡æ¿æµæ°´çº¿ï¼Œè¿™äº›æµæ°´çº¿å¯ä»¥ç›´æ¥è®©é¡¹ç›®ä½¿ç”¨ã€‚å½“é‡åˆ°ä¸ªæ€§åŒ–é¡¹ç›®çš„æ—¶å€™å°±å¯ä»¥åœ¨å½“å‰é¡¹ç›®åˆ›å»º.gitlab-ci.yml æ–‡ä»¶æ¥å¼•ç”¨æ¨¡æ¿æ–‡ä»¶ï¼Œå†è¿›ä¸€æ­¥å®ç°ä¸ªæ€§åŒ–éœ€è¦ã€‚\n4.1 æ¨¡æ¿åº“ä¿¡æ¯ github : https://github.com/zeyangli/gitlabci-templates\n4.2 é¡¹ç›®ä¿¡æ¯    è§†é¢‘ä¸­ä»“åº“åœ°å€ github ä»“åº“åœ°å€ å¤‡æ³¨     demo/demo-maven-service zeyangli/gitlabci-demo-maven-service æµ‹è¯• ci è¯­æ³•é¡¹ç›®   cidevops-java-service zeyangli/gitlabci-cidevops-java-service æ„å»ºå·¥å…·é›†æˆé¡¹ç›®   cidevops-npm-service zeyangli/gitlabci-cidevops-npm-service npm é›†æˆé¡¹ç›®   cidevops-interfacetest-service zeyangli/gitlabci-cidevops-interfacetest-service è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆ   cidevops-gitlabci-service zeyangli/gitlabci-templates æ¨¡æ¿åº“é¡¹ç›®    4.3 é›†æˆæ„å»ºå·¥å…· æ„å»ºå·¥å…·æ˜¯ç”¨æ¥å°†ä»£ç ç¼–è¯‘æ‰“åŒ…æˆåˆ¶å“çš„å·¥å…·ã€‚ä¾‹å¦‚å‰ç«¯é¡¹ç›®æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ npm è¿›è¡Œæ‰“åŒ…ï¼Œåç«¯ java é¡¹ç›®æˆ‘ä»¬ä¸€èˆ¬ä½¿ç”¨ mavenã€gradle è¿›è¡Œæ‰“åŒ…ã€‚æ„å»ºå·¥å…·å¾ˆå¤šå¾ˆå¤šï¼Œä½†æ˜¯é›†æˆåˆ° gitlab ä¸­æ˜¯ä¸€æ ·çš„ã€‚æ‰€ä»¥è¿™é‡Œç®€å•ä»‹ç»ä½¿ç”¨ gitlabCI é›†æˆ npm/maven å®Œæˆå‰åç«¯é¡¹ç›®çš„æ„å»ºã€‚\n4.4 è½¯ä»¶åŒ…ä¸‹è½½  maven è½¯ä»¶åŒ…ä¸‹è½½ gradle è½¯ä»¶åŒ…ä¸‹è½½ ant è½¯ä»¶åŒ…ä¸‹è½½ node è½¯ä»¶åŒ…ä¸‹è½½  4.5 ç¯å¢ƒé…ç½® é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨ runner æœºå™¨ä¸­å®‰è£…é…ç½®å¥½ apache-mavenã€‚\n#è§£å‹ tar zxf apache-maven-xxxx.tar.gz -C /usr/local tar zxf gradle-xxxx.tar.gz -C /usr/local tar zxf node-xxxxx.tar.gz -C /usr/local tar zxf apache-ant-xxxx.tar.gz -C /usr/local #æ·»åŠ ç¯å¢ƒå˜é‡ vim /etc/profile export MAVEN_HOME=/usr/local/apache-maven-3.6.0 export ANT_HOME=/usr/local/apache-ant-1.10.5 export GRADLE_HOME=/usr/local/gradle-5.3 export NODE_HOME=/usr/local/node-v10.15.3-linux-x64 export JAVA_HOME=/usr/local/jdk1.8.0_201 export PATH=$PATH:$MAVEN_HOME/bin:$ANT_HOME/bin:$GRADLE_HOME/bin:$NODE_HOME/bin export PATH=$PATH:$JAVA_HOME/bin # ç”Ÿæ•ˆå…¨å±€ç¯å¢ƒå˜é‡ source /etc/profile 4.6 maven é›†æˆæ¨¡æ¿åº“é…ç½® æˆ‘ä»¬é¦–å…ˆåœ¨ jobs ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ª build.ymlï¼Œç„¶ååœ¨é‡Œé¢ç¼–å†™ build ä½œä¸šæ¨¡æ¿ã€‚\n.build: stage: build tags: - build script: - $BUILD_SHELL - ls æˆ‘ä»¬è®¡åˆ’å°†æµ‹è¯•ç›¸å…³çš„ job éƒ½å®šä¹‰åœ¨ jobs/test.yml ä¸­ï¼Œæˆ‘ä»¬å¼€å§‹åˆ›å»ºå¹¶ç¼–å†™ test ä½œä¸šã€‚è¿è¡Œæµ‹è¯• shell å¹¶æ”¶é›†å•å…ƒæµ‹è¯•æŠ¥å‘Šã€‚\n#å•å…ƒæµ‹è¯• .test: stage: test tags: - build script: - $TEST_SHELL - ls artifacts: reports: junit: ${JUNIT_REPORT_PATH} ç„¶åæˆ‘ä»¬åœ¨ template ç›®å½•ä¸­åˆ›å»º maven æµæ°´çº¿æ¨¡æ¿ã€‚ templates/java-pipeline.yml\ninclude: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/build.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/test.yml' variables: BUILD_SHELL: 'mvn clean package -DskipTests' ##æ„å»ºå‘½ä»¤ CACHE_DIR: 'target/' TEST_SHELL : 'mvn test' ##æµ‹è¯•å‘½ä»¤ JUNIT_REPORT_PATH: 'target/surefire-reports/TEST-*.xml' ##å•å…ƒæµ‹è¯•æŠ¥å‘Š cache: paths: - ${CACHE_DIR} stages: - build - test build: stage: build extends: .build test: stage: test extends: .test æœ€åæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­æ·»åŠ .gitlab-ci.yml æ¥å¼•ç”¨æ¨¡æ¿æ„å»ºæµæ°´çº¿ã€‚\ninclude: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'templates/java-pipeline.yml' variables: BUILD_SHELL: 'mvn clean package -DskipTests' TEST_SHELL: 'mvn test' CACHE_DIR: 'target/' \nå¥½çš„ï¼Œä¸Šé¢æˆ‘ä»¬å·²ç»å®ç°äº†æ„å»ºï¼Œä½†æ˜¯ä¸€èˆ¬è¿˜å›è¿è¡Œå•å…ƒæµ‹è¯•ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å®ç°ã€‚\n4.7 npm é›†æˆæ¨¡æ¿é…ç½® template/web-pipeline.yml\ninclude: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/build.yml' variables: BUILD_SHELL: 'npm run build' ##æ„å»ºå‘½ä»¤ CACHE_DIR : \u0026quot;dist/\u0026quot; ##æ„å»ºç¼“å­˜ cache: paths: - ${CACHE_DIR} - node_modules/ stages: - install - build install: stage: install script: - 'npm install' build: stage: build extends: .build 4.8 é›†æˆä»£ç è´¨é‡ sonarqube 4.8.1 å†…å®¹  SonarQube åŸºç¡€ç®€ä»‹ é…ç½® GitLabCI ä»£ç æ‰«æ é…ç½® GitLabCI åˆå¹¶æ‰«æ  4.8.2 å‡†å¤‡å·¥ä½œ å‚è€ƒé“¾æ¥ï¼šhttps://docs.sonarqube.org/latest/analysis/gitlab-cicd/\næ‰©å±•æ’ä»¶ï¼š https://github.com/mc1arke/sonarqube-community-branch-plugin/releases\nå‚è€ƒæ–‡ç« ï¼šå‚è€ƒæ–‡ç« é“¾æ¥\nGitlab å†…ç½®ç¯å¢ƒå˜é‡ï¼š http://192.168.1.200:30088/help/ci/variables/README#variables\nåœ¨ SonarQube ä¸­åˆ›å»ºé¡¹ç›®ç»„æ·»åŠ ç”¨æˆ·ï¼Œä¸ºç”¨æˆ·åˆ†é…æƒé™ã€‚ä½¿ç”¨ç”¨æˆ· token åˆ†ææ‰«æé¡¹ç›®ã€‚\n4.8.3 å‡†å¤‡ç”¨æˆ· \n4.8.4 åˆ›å»ºç¾¤ç»„ \n4.8.5 åˆ›å»ºæƒé™æ¨¡æ¿ \n4.8.6 åˆ†é…æƒé™ ä¸€èˆ¬ç»™è¿™ä¸ªç»„ä¸­çš„æˆå‘˜ç®¡ç†å‘˜æƒé™\n\n4.8.7 ä¸ºé¡¹ç›®æˆæƒæƒé™æ¨¡æ¿ \n4.8.8 æ·»åŠ  token \n4.8.9 æ‰«æåˆ†æ jobs/codeanalysis.yml\n.codeanalysis-java: stage: code_analysis tags: - build script: - echo $CI_MERGE_REQUEST_IID $CI_MERGE_REQUEST_SOURCE_BRANCH_NAME $CI_MERGE_REQUEST_TARGET_BRANCH_NAME - \u0026quot;$SCANNER_HOME/bin/sonar-scanner -Dsonar.projectKey=${CI_PROJECT_NAME} \\ -Dsonar.projectName=${CI_PROJECT_NAME} \\ -Dsonar.projectVersion=${CI_COMMIT_REF_NAME} \\ -Dsonar.ws.timeout=30 \\ -Dsonar.projectDescription=${CI_PROJECT_TITLE} \\ -Dsonar.links.homepage=${CI_PROJECT_URL} \\ -Dsonar.sources=${SCAN_DIR} \\ -Dsonar.sourceEncoding=UTF-8 \\ -Dsonar.java.binaries=target/classes \\ -Dsonar.java.test.binaries=target/test-classes \\ -Dsonar.java.surefire.report=target/surefire-reports \\ -Dsonar.branch.name=${CI_COMMIT_REF_NAME}\u0026quot; artifacts: paths: - \u0026quot;$ARTIFACT_PATH\u0026quot; template/java-pipeline.yml\ninclude: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/build.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/test.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/codeanalysis.yml' variables: BUILD_SHELL: 'mvn clean package -DskipTests' ##æ„å»ºå‘½ä»¤ CACHE_DIR: 'target/' TEST_SHELL : 'mvn test' ##æµ‹è¯•å‘½ä»¤ JUNIT_REPORT_PATH: 'target/surefire-reports/TEST-*.xml' ##å•å…ƒæµ‹è¯•æŠ¥å‘Š # ä»£ç æ‰«æ SCANNER_HOME : \u0026quot;/usr/local/buildtools/sonar-scanner-3.2.0.1227-linux\u0026quot; SCAN_DIR : \u0026quot;src\u0026quot; ARTIFACT_PATH : 'target/*.jar' ##åˆ¶å“ç›®å½• cache: paths: - ${CACHE_DIR} stages: - build - test - code_analysis build: stage: build extends: .build rules: - when: on_success test: stage: test extends: .test rules: - when: on_success code_analysis: stage: code_analysis extends: .codeanalysis-java å®ç°æ•ˆæœ\n\n4.8.10 Pull request é›†æˆ é…ç½® SonarQubeï¼Œæ·»åŠ  gitlabtoken å’ŒæœåŠ¡ä¿¡æ¯ã€‚ç³»ç»Ÿè®¾ç½® -\u0026gt; pull requestã€‚\næ³¨æ„ä¸‹é¢çš„é…ç½®åœ¨é…ç½®æ–‡ä»¶ä¸­å®šä¹‰ä¸ç”Ÿæ•ˆå“¦ï¼Œå¯èƒ½æ˜¯å› ä¸ºç‰ˆæœ¬çš„é—®é¢˜å¯¼è‡´çš„ã€‚æš‚ä¸”å¿½ç•¥ã€‚\ncom.github.mc1arke.sonarqube.plugin.branch.pullrequest.gitlab.token=b8Gs1quX5GSeHwyuMWyY com.github.mc1arke.sonarqube.plugin.branch.pullrequest.gitlab.url=http://192.168.1.200:30088 sonar.pullrequest.provider=GitlabServer å¦‚æœä½ æƒ³é€šè¿‡ API æ“ä½œå¯ä»¥å‚è€ƒï¼š\ncurl -u \u0026quot;$SONAR_API_TOKEN\u0026quot; -X POST \u0026quot;http://sonarqube.example.com/api/settings/set?key=sonar.pullrequest.provider\u0026amp;value=GitlabServer\u0026quot; curl -u \u0026quot;$SONAR_API_TOKEN\u0026quot; -X POST \u0026quot;http://sonarqube.example.com/api/settings/set?key=com.github.mc1arke.sonarqube.plugin.branch.pullrequest.gitlab.url\u0026amp;value=http://gitlab.example.com\u0026quot; curl -u \u0026quot;$SONAR_API_TOKEN\u0026quot; -X POST \u0026quot;http://sonarqube.example.com/api/settings/set?key=com.github.mc1arke.sonarqube.plugin.branch.pullrequest.gitlab.token\u0026amp;value= $ GITLAB_TOKEN\u0026quot; \næ·»åŠ æ‰«æä½œä¸šï¼Œä¸»è¦æ˜¯åˆ†æå‚æ•°ã€‚\n.codeanalysis-mr: stage: code_analysis only: - merge_requests tags: - build script: - \u0026quot;$SCANNER_HOME/bin/sonar-scanner -Dsonar.projectKey=${CI_PROJECT_NAME} \\ -Dsonar.projectName=${CI_PROJECT_NAME} \\ -Dsonar.projectVersion=${CI_COMMIT_REF_NAME} \\ -Dsonar.ws.timeout=30 \\ -Dsonar.projectDescription=${CI_PROJECT_TITLE} \\ -Dsonar.links.homepage=${CI_PROJECT_URL} \\ -Dsonar.sources=${SCAN_DIR} \\ -Dsonar.sourceEncoding=UTF-8 \\ -Dsonar.java.binaries=target/classes \\ -Dsonar.java.test.binaries=target/test-classes \\ -Dsonar.java.surefire.report=target/surefire-reports \\ -Dsonar.pullrequest.key=${CI_MERGE_REQUEST_IID} \\ -Dsonar.pullrequest.branch=${CI_MERGE_REQUEST_SOURCE_BRANCH_NAME} \\ -Dsonar.pullrequest.base=${CI_MERGE_REQUEST_TARGET_BRANCH_NAME} \\ -Dsonar.gitlab.ref_name=${CI_COMMIT_REF_NAME} \\ -Dsonar.gitlab.commit_sha=${CI_COMMIT_SHA} \\ -Dsonar.gitlab.project_id=${CI_PROJECT_PATH} \\ -Dsonar.pullrequest.gitlab.repositorySlug=$CI_PROJECT_ID \u0026quot; #-Dsonar.branch.name=${CI_COMMIT_REF_NAME} -X \u0026quot; templates/java-pipeline.yml\ninclude: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/build.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/test.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/codeanalysis.yml' variables: BUILD_SHELL: 'mvn clean package -DskipTests' ##æ„å»ºå‘½ä»¤ CACHE_DIR: 'target/' TEST_SHELL : 'mvn test' ##æµ‹è¯•å‘½ä»¤ JUNIT_REPORT_PATH: 'target/surefire-reports/TEST-*.xml' ##å•å…ƒæµ‹è¯•æŠ¥å‘Š # ä»£ç æ‰«æ SCANNER_HOME : \u0026quot;/usr/local/buildtools/sonar-scanner-3.2.0.1227-linux\u0026quot; SCAN_DIR : \u0026quot;src\u0026quot; ARTIFACT_PATH : 'target/*.jar' ##åˆ¶å“ç›®å½• cache: paths: - ${CACHE_DIR} stages: - build - test - code_analysis build: stage: build extends: .build rules: - when: on_success test: stage: test extends: .test rules: - when: on_success code_analysis: stage: code_analysis extends: .codeanalysis-java codeanalysis_mr: stage: code_analysis extends: .codeanalysis-mr åˆ›å»ºåˆå¹¶è¯·æ±‚è¿è¡Œæµæ°´çº¿ï¼Œæœ€ç»ˆæ•ˆæœã€‚\n\n4.9 åˆ¶å“åº“é›†æˆ 4.9.1 artifactory .build: stage: build tags: - build script: - $BUILD_SHELL - ls .deploy-artifact: stage: deploy-artifact tags: - build script: - curl -u${ARTIFACT_USER}:${ARTIFACT_PASSWD} -T ${ARTIFACT_PATH} \u0026quot;$ARTIFACTORY_URL/$ARTIFACTORY_NAME/$TARGET_FILE_PATH/$TARGET_ARTIFACT_NAME\u0026quot; 4.9.2 å®šä¹‰å˜é‡ \ntemplate\ninclude: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/build.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/test.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/codeanalysis.yml' variables: BUILD_SHELL: 'mvn clean package -DskipTests' ##æ„å»ºå‘½ä»¤ CACHE_DIR: 'target/' TEST_SHELL : 'mvn test' ##æµ‹è¯•å‘½ä»¤ JUNIT_REPORT_PATH: 'target/surefire-reports/TEST-*.xml' ##å•å…ƒæµ‹è¯•æŠ¥å‘Š # ä»£ç æ‰«æ SCANNER_HOME : \u0026quot;/usr/local/buildtools/sonar-scanner-3.2.0.1227-linux\u0026quot; SCAN_DIR : \u0026quot;src\u0026quot; ARTIFACT_PATH : 'target/*.jar' ##åˆ¶å“ç›®å½• #ä¸Šä¼ åˆ¶å“åº“ ARTIFACTORY_URL: \u0026quot;http://192.168.1.200:30082/artifactory\u0026quot; ARTIFACTORY_NAME: \u0026quot;cidevops\u0026quot; TARGET_FILE_PATH: \u0026quot;$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME/$CI_COMMIT_REF_NAME-$CI_COMMIT_SHORT_SHA-$CI_PIPELINE_ID\u0026quot; TARGET_ARTIFACT_NAME: \u0026quot;$CI_PROJECT_NAME-$CI_COMMIT_REF_NAME-$CI_COMMIT_SHORT_SHA-$CI_PIPELINE_ID.jar\u0026quot; cache: paths: - ${CACHE_DIR} stages: - build - test - parallel01 build: stage: build extends: .build rules: - when: on_success test: stage: test extends: .test rules: - when: on_success code_analysis: stage: parallel01 extends: .codeanalysis-java codeanalysis_mr: stage: parallel01 extends: .codeanalysis-mr deploy_artifact: stage: parallel01 extends: .deploy-artifact \n\n4.9.3 ä¸‹è½½åˆ¶å“ .down-artifact: stage: down-artifact tags: - build script: - curl -u${ARTIFACT_USER}:${ARTIFACT_PASSWD} -O \u0026quot;$ARTIFACTORY_URL/$ARTIFACTORY_NAME/$TARGET_FILE_PATH/$TARGET_ARTIFACT_NAME\u0026quot; - ls template\ndown_artifact: stage: down_artifact extends: .down-artifact \n\n4.9.4 é•œåƒä»“åº“ https://cr.console.aliyun.com/cn-beijing/instances/repositories\n\n.build-docker: stage: buildimage tags: - build script: - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWD $CI_REGISTRY - docker build -t ${IMAGE_NAME} -f ${DOCKER_FILE_PATH} . - docker push ${IMAGE_NAME} - docker rmi ${IMAGE_NAME} include: - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/build.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/test.yml' - project: 'cidevops/cidevops-gitlabci-service' ref: master file: 'jobs/codeanalysis.yml' variables: BUILD_SHELL: 'mvn clean package -DskipTests' ##æ„å»ºå‘½ä»¤ CACHE_DIR: 'target/' TEST_SHELL : 'mvn test' ##æµ‹è¯•å‘½ä»¤ JUNIT_REPORT_PATH: 'target/surefire-reports/TEST-*.xml' ##å•å…ƒæµ‹è¯•æŠ¥å‘Š # ä»£ç æ‰«æ SCANNER_HOME : \u0026quot;/usr/local/buildtools/sonar-scanner-3.2.0.1227-linux\u0026quot; SCAN_DIR : \u0026quot;src\u0026quot; ARTIFACT_PATH : 'target/*.jar' ##åˆ¶å“ç›®å½• #ä¸Šä¼ åˆ¶å“åº“ ARTIFACTORY_URL: \u0026quot;http://192.168.1.200:30082/artifactory\u0026quot; ARTIFACTORY_NAME: \u0026quot;cidevops\u0026quot; TARGET_FILE_PATH: \u0026quot;$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME/$CI_COMMIT_REF_NAME-$CI_COMMIT_SHORT_SHA-$CI_PIPELINE_ID\u0026quot; TARGET_ARTIFACT_NAME: \u0026quot;$CI_PROJECT_NAME-$CI_COMMIT_REF_NAME-$CI_COMMIT_SHORT_SHA-$CI_PIPELINE_ID.jar\u0026quot; #æ„å»ºé•œåƒ CI_REGISTRY: 'registry.cn-beijing.aliyuncs.com' CI_REGISTRY_USER: '610556220zy' #CI_REGISTRY_PASSWD: 'xxxxxxxx.' IMAGE_NAME: \u0026quot;$CI_REGISTRY/$CI_PROJECT_PATH:$CI_COMMIT_REF_NAME-$CI_COMMIT_SHORT_SHA-$CI_PIPELINE_ID\u0026quot; DOCKER_FILE_PATH: \u0026quot;./Dockerfile\u0026quot; cache: paths: - ${CACHE_DIR} stages: - build - test - parallel01 - down_artifact build: stage: build extends: .build rules: - when: on_success test: stage: test extends: .test rules: - when: on_success code_analysis: stage: parallel01 extends: .codeanalysis-java codeanalysis_mr: stage: parallel01 extends: .codeanalysis-mr deploy_artifact: stage: parallel01 extends: .deploy-artifact down_artifact: stage: down_artifact extends: .down-artifact build_image: stage: parallel01 extends: .build-docker \n\n4.10 è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆ 4.10.1 å¼€å¯ gitlab pages root# vim /etc/gitlab/gitlab.rb ##! Define to enable GitLab Pages pages_external_url \u0026quot;http://pages.gitlab.com/\u0026quot; gitlab_pages['enable'] = true gitlab_pages['inplace_chroot'] = true gitlab-ctl reconfigure æ›´æ–° gitlab.yml æ–‡ä»¶\ncontainers: - name: gitlab image: gitlab/gitlab-ce:12.9.0-ce.0 imagePullPolicy: IfNotPresent ports: - containerPort: 30088 name: web protocol: TCP - containerPort: 22 name: agent protocol: TCP - containerPort: 80 name: page protocol: TCP å¼€æ”¾ 80 ç«¯å£\nkind: Service apiVersion: v1 metadata: labels: k8s-app: gitlab name: gitlab namespace: devops spec: type: NodePort ports: - name: web port: 30088 targetPort: 30088 nodePort: 30088 - name: slave port: 22 targetPort: 22 nodePort: 30022 - name: page port: 80 targetPort: 80 nodePort: 80 selector: k8s-app: gitlab \nå®Œæ•´çš„ yaml å‚è€ƒ github ä¸­ã€‚\nFAQï¼šæœªå¼€å¯ chroot\nhttps://gitlab.com/gitlab-org/gitlab-pages/-/issues/129\n\u0026quot;Failed to bind mount /var/opt/gitlab/gitlab-rails/shared/pages on /tmp/gitlab-pages-1524473513642136363/pages. operation not permitted 4.10.2 è¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯• åœ¨è¿™é‡Œå®šä¹‰äº†ä¸¤ä¸ª stageï¼Œinterface_test ä½œä¸šç”¨äºè¿è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•ï¼Œæ­¤æ—¶è‡ªåŠ¨åŒ–æµ‹è¯•å·²ç»é…ç½®å¥½ ant+jmeter é›†æˆæ‰€ä»¥ç›´æ¥è¿è¡Œ ant å‘½ä»¤å³å¯ã€‚è€ƒè™‘åˆ°æ¯ä¸ªäººå®‰è£…çš„ jmeter ç¯å¢ƒç›®å½•ä¸ä¸€è‡´æ‰€ä»¥å¯ä»¥é€šè¿‡-D é€‰é¡¹æŒ‡å®š jmeterhomeã€‚è¿è¡Œå®Œæˆæ¥å£æµ‹è¯•åï¼Œæµ‹è¯•æŠ¥å‘Šåœ¨é¡¹ç›®å½“å‰ç›®å½•çš„result/htmlfileä¸­ã€‚åœ¨æ­¤å°†æµ‹è¯•æŠ¥å‘Šæ•´ç†æˆåˆ¶å“å­˜æ”¾ã€‚\npages ä½œä¸šç”¨äºå°†æµ‹è¯•æŠ¥å‘Šä¸­çš„ html æ–‡ä»¶é€šè¿‡ pages åŠŸèƒ½å±•ç¤ºã€‚é¦–å…ˆè·å– interface_test ä½œä¸šçš„åˆ¶å“ï¼Œç„¶åå°†æµ‹è¯•æŠ¥å‘Šç§»åŠ¨åˆ° public ç›®å½•ä¸­ã€‚æœ€åå°† public ç›®å½•ä½œä¸ºåˆ¶å“æ”¶é›†ï¼Œæœ‰æ•ˆæœŸ 30 å¤©ã€‚\njmeter å®‰è£…å¥½äº†ï¼Œä¹‹åéœ€è¦å°†/usr/local/apache-jmeter-5.1.1/extras ç›®å½•ä¸­çš„ ant-jmeter-1.1.1.jar å¤åˆ¶åˆ° ant å®‰è£…ç›®å½•ä¸‹çš„ lib ä¸­ã€‚\nstages: - tests - deploy interface_test: stage: tests tags: - build script: - ant -Djmeter.home=/usr/local/buildtools/apache-jmeter-5.2.1 artifacts: paths: - result/htmlfile/ pages: stage: deploy dependencies: - interface_test script: - mv result/htmlfile/ public/ artifacts: paths: - public expire_in: 30 days only: - master æ•ˆæœï¼š\n\n4.10.3 ä¸Šä¸‹æ¸¸é¡¹ç›®è§¦å‘è‡ªåŠ¨åŒ–æµ‹è¯• jobs/test.yml\n.interfacetest: stage: interface_test trigger: project: cidevops/cidevops-interfacetest-service branch: master strategy: depend templates.yml\ninterfact_test: stage: interface_test extends: .interfacetest \n4.11 Kubernetes é›†æˆ 4.11.1 åŸºäº kubernetes éƒ¨ç½² runner 4.11.1.1 å®‰è£… helm3 https://github.com/helm/helm/releases tar -zxvf helm-v3.0.0-linux-amd64.tar.gz mv linux-amd64/helm /usr/local/bin/helm 4.11.1.2 é…ç½® chart å­˜å‚¨åº“ ## æ·»åŠ chartå­˜å‚¨åº“ helm repo add gitlab https://charts.gitlab.io ## éªŒè¯æº helm repo list ##æŸ¥è¯¢å¯ä»¥å®‰è£…çš„gitlab-runner chart helm search repo -l gitlab/gitlab-runner 4.11.1.3 æ›´æ–°é…ç½®ä¿¡æ¯ ## è·å–ç›¸å…³ç‰ˆæœ¬çš„chartåŒ… helm fetch gitlab/gitlab-runner --version=0.15.0 [root@zeyang-nuc-service ~]# ls Desktop es Documents gitlab-runner-0.15.0.tgz values.yml\n## GitLab Runner Image ## ## By default it's using gitlab/gitlab-runner:alpine-v{VERSION} ## where {VERSION} is taken from Chart.yaml from appVersion field ## ## ref: https://hub.docker.com/r/gitlab/gitlab-runner/tags/ ## image: gitlab/gitlab-runner:alpine-v12.9.0 ## é•œåƒä¸‹è½½ç­–ç•¥ imagePullPolicy: IfNotPresent ## GitlabæœåŠ¡å™¨åœ°å€ gitlabUrl: http://192.168.1.200:30088/ ## runneræ³¨å†Œtoken runnerRegistrationToken: \u0026quot;JRzzw2j1Ji6aBjwvkxAv\u0026quot; ## ç»ˆæ­¢ä¹‹å‰æ³¨é”€æ‰€æœ‰è·‘æ­¥è€… unregisterRunners: true ## å½“åœæ­¢ç®¡é“æ—¶ç­‰å¾…å…¶ä½œä¸šç»ˆæ­¢æ—¶é—´ terminationGracePeriodSeconds: 3600 ## Set the certsSecretName in order to pass custom certficates for GitLab Runner to use ## Provide resource name for a Kubernetes Secret Object in the same namespace, ## this is used to populate the /home/gitlab-runner/.gitlab-runner/certs/ directory ## ref: https://docs.gitlab.com/runner/configuration/tls-self-signed.html#supported-options-for-self-signed-certificates ## # certsSecretName: ## é…ç½®æœ€å¤§å¹¶å‘ä½œä¸šæ•° concurrent: 10 ## æ–°ä½œä¸šæ£€æŸ¥é—´éš” checkInterval: 30 ## GitlabRunneræ—¥å¿—çº§åˆ« debug, info, warn, error, fatal, panic logLevel: info ## Configure GitLab Runner's logging format. Available values are: runner, text, json ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-global-section ## # logFormat: ## For RBAC support: rbac: create: true ## Define specific rbac permissions. resources: [\u0026quot;pods\u0026quot;, \u0026quot;pods/exec\u0026quot;, \u0026quot;secrets\u0026quot;] verbs: [\u0026quot;get\u0026quot;, \u0026quot;list\u0026quot;, \u0026quot;watch\u0026quot;, \u0026quot;create\u0026quot;, \u0026quot;patch\u0026quot;, \u0026quot;delete\u0026quot;] ## Run the gitlab-bastion container with the ability to deploy/manage containers of jobs ## cluster-wide or only within namespace clusterWideAccess: false ## Use the following Kubernetes Service Account name if RBAC is disabled in this Helm chart (see rbac.create) ## # serviceAccountName: default ## Specify annotations for Service Accounts, useful for annotations such as eks.amazonaws.com/role-arn ## ## ref: https://docs.aws.amazon.com/eks/latest/userguide/specify-service-account-role.html ## # serviceAccountAnnotations: {} ## Configure integrated Prometheus metrics exporter ## ref: https://docs.gitlab.com/runner/monitoring/#configuration-of-the-metrics-http-server metrics: enabled: true ## Configuration for the Pods that that the runner launches for each new job ## runners: ## Default container image to use for builds when none is specified ## image: ubuntu:16.04 ## Specify one or more imagePullSecrets ## ## ref: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/ ## # imagePullSecrets: [] ## Specify the image pull policy: never, if-not-present, always. The cluster default will be used if not set. ## imagePullPolicy: \u0026quot;if-not-present\u0026quot; ## Defines number of concurrent requests for new job from GitLab ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section ## é™åˆ¶æ¥è‡ªGitLabçš„å¯¹æ–°ä½œä¸šçš„å¹¶å‘è¯·æ±‚æ•° requestConcurrency: 1 ## Specify whether the runner should be locked to a specific project: true, false. Defaults to true. ## locked: false ## Specify the tags associated with the runner. Comma-separated list of tags. ## ## ref: https://docs.gitlab.com/ce/ci/runners/#using-tags ## tags: \u0026quot;kubernetes-runner,k8s\u0026quot; ## Specify if jobs without tags should be run. ## If not specified, Runner will default to true if no tags were specified. In other case it will ## default to false. ## ## ref: https://docs.gitlab.com/ce/ci/runners/#allowing-runners-with-tags-to-pick-jobs-without-tags ## runUntagged: true ## Specify whether the runner should only run protected branches. ## Defaults to False. ## ## ref: https://docs.gitlab.com/ee/ci/runners/#protected-runners ## protected: false ## Run all containers with the privileged flag enabled ## This will allow the docker:dind image to run if you need to run Docker ## commands. Please read the docs before turning this on: ## ref: https://docs.gitlab.com/runner/executors/kubernetes.html#using-docker-dind ## privileged: true ## The name of the secret containing runner-token and runner-registration-token # secret: gitlab-runner ## Namespace to run Kubernetes jobs in (defaults to the same namespace of this release) ## # namespace: ## The amount of time, in seconds, that needs to pass before the runner will ## timeout attempting to connect to the container it has just created. ## ref: https://docs.gitlab.com/runner/executors/kubernetes.html pollTimeout: 180 ## Set maximum build log size in kilobytes, by default set to 4096 (4MB) ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-section outputLimit: 4096 ## Distributed runners caching ## ref: https://gitlab.com/gitlab-org/gitlab-runner/blob/master/docs/configuration/autoscale.md#distributed-runners-caching ## ## If you want to use s3 based distributing caching: ## First of all you need to uncomment General settings and S3 settings sections. ## ## Create a secret 's3access' containing 'accesskey' \u0026amp; 'secretkey' ## ref: https://aws.amazon.com/blogs/security/wheres-my-secret-access-key/ ## ## $ kubectl create secret generic s3access \\ ## --from-literal=accesskey=\u0026quot;YourAccessKey\u0026quot; \\ ## --from-literal=secretkey=\u0026quot;YourSecretKey\u0026quot; ## ref: https://kubernetes.io/docs/concepts/configuration/secret/ ## ## If you want to use gcs based distributing caching: ## First of all you need to uncomment General settings and GCS settings sections. ## ## Access using credentials file: ## Create a secret 'google-application-credentials' containing your application credentials file. ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runnerscachegcs-section ## You could configure ## $ kubectl create secret generic google-application-credentials \\ ## --from-file=gcs-application-credentials-file=./path-to-your-google-application-credentials-file.json ## ref: https://kubernetes.io/docs/concepts/configuration/secret/ ## ## Access using access-id and private-key: ## Create a secret 'gcsaccess' containing 'gcs-access-id' \u0026amp; 'gcs-private-key'. ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html#the-runners-cache-gcs-section ## You could configure ## $ kubectl create secret generic gcsaccess \\ ## --from-literal=gcs-access-id=\u0026quot;YourAccessID\u0026quot; \\ ## --from-literal=gcs-private-key=\u0026quot;YourPrivateKey\u0026quot; ## ref: https://kubernetes.io/docs/concepts/configuration/secret/ cache: {} ## General settings # cacheType: s3 # cachePath: \u0026quot;gitlab_runner\u0026quot; # cacheShared: true ## S3 settings # s3ServerAddress: s3.amazonaws.com # s3BucketName: # s3BucketLocation: # s3CacheInsecure: false # secretName: s3access ## GCS settings # gcsBucketName: ## Use this line for access using access-id and private-key # secretName: gcsaccess ## Use this line for access using google-application-credentials file # secretName: google-application-credentials ## Build Container specific configuration ## builds: {} # cpuLimit: 200m # memoryLimit: 256Mi # cpuRequests: 100m # memoryRequests: 128Mi ## Service Container specific configuration ## services: {} # cpuLimit: 200m # memoryLimit: 256Mi # cpuRequests: 100m # memoryRequests: 128Mi ## Helper Container specific configuration ## helpers: {} # cpuLimit: 200m # memoryLimit: 256Mi # cpuRequests: 100m # memoryRequests: 128Mi # image: gitlab/gitlab-runner-helper:x86_64-latest ## Service Account to be used for runners ## # serviceAccountName: ## If Gitlab is not reachable through $CI_SERVER_URL ## # cloneUrl: ## Specify node labels for CI job pods assignment ## ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/ ## # nodeSelector: {} ## Specify pod labels for CI job pods ## # podLabels: {} ## Specify annotations for job pods, useful for annotations such as iam.amazonaws.com/role # podAnnotations: {} ## Configure environment variables that will be injected to the pods that are created while ## the build is running. These variables are passed as parameters, i.e. `--env \u0026quot;NAME=VALUE\u0026quot;`, ## to `gitlab-runner register` command. ## ## Note that `envVars` (see below) are only present in the runner pod, not the pods that are ## created for each build. ## ## ref: https://docs.gitlab.com/runner/commands/#gitlab-runner-register ## # env: # NAME: VALUE ## Configure securitycontext ## ref: http://kubernetes.io/docs/user-guide/security-context/ ## securityContext: fsGroup: 65533 runAsUser: 100 ## Configure resource requests and limits ## ref: http://kubernetes.io/docs/user-guide/compute-resources/ ## resources: {} # limits: # memory: 256Mi # cpu: 200m # requests: # memory: 128Mi # cpu: 100m ## Affinity for pod assignment ## Ref: https://kubernetes.io/docs/concepts/configuration/assign-pod-node/#affinity-and-anti-affinity ## affinity: {} ## Node labels for pod assignment ## Ref: https://kubernetes.io/docs/user-guide/node-selection/ ## nodeSelector: {} # Example: The gitlab runner manager should not run on spot instances so you can assign # them to the regular worker nodes only. # node-role.kubernetes.io/worker: \u0026quot;true\u0026quot; ## List of node taints to tolerate (requires Kubernetes \u0026gt;= 1.6) ## Ref: https://kubernetes.io/docs/concepts/configuration/taint-and-toleration/ ## tolerations: [] # Example: Regular worker nodes may have a taint, thus you need to tolerate the taint # when you assign the gitlab runner manager with nodeSelector or affinity to the nodes. # - key: \u0026quot;node-role.kubernetes.io/worker\u0026quot; # operator: \u0026quot;Exists\u0026quot; ## Configure environment variables that will be present when the registration command runs ## This provides further control over the registration process and the config.toml file ## ref: `gitlab-runner register --help` ## ref: https://docs.gitlab.com/runner/configuration/advanced-configuration.html ## # envVars: # - name: RUNNER_EXECUTOR # value: kubernetes ## list of hosts and IPs that will be injected into the pod's hosts file hostAliases: [] # Example: # - ip: \u0026quot;127.0.0.1\u0026quot; # hostnames: # - \u0026quot;foo.local\u0026quot; # - \u0026quot;bar.local\u0026quot; # - ip: \u0026quot;10.1.2.3\u0026quot; # hostnames: # - \u0026quot;foo.remote\u0026quot; # - \u0026quot;bar.remote\u0026quot; ## Annotations to be added to manager pod ## podAnnotations: {} # Example: # iam.amazonaws.com/role: \u0026lt;my_role_arn\u0026gt; ## Labels to be added to manager pod ## podLabels: {} # Example: # owner.team: \u0026lt;my_cool_team\u0026gt; ## HPA support for custom metrics: ## This section enables runners to autoscale based on defined custom metrics. ## In order to use this functionality, Need to enable a custom metrics API server by ## implementing \u0026quot;custom.metrics.k8s.io\u0026quot; using supported third party adapter ## Example: https://github.com/directxman12/k8s-prometheus-adapter ## #hpa: {} # minReplicas: 1 # maxReplicas: 10 # metrics: # - type: Pods # pods: # metricName: gitlab_runner_jobs # targetAverageValue: 400m 4.11.1.4 éƒ¨ç½² chart ## åˆ›å»ºrunner kubectl create ns gitlab-runner helm install gitlab-runner --namespace gitlab-runner ./gitlab-runner ## æ›´æ–° helm upgrade gitlab-runner --namespace gitlab-runner ./gitlab-runner 4.11.1.5 æ•ˆæœ gitlab\n\nkubernetes\n\n4.11.1.6 è¿è¡Œæµæ°´çº¿æµ‹è¯• image: maven:3.6.3-jdk-8 before_script: - ls services: - name: mysql:latest alias: mysql-1 build: image: maven:3.6.3-jdk-8 stage: build tags: - k8s script: - ls - sleep 2 - echo \u0026quot;mvn clean \u0026quot; - sleep 10 deploy: stage: deploy tags: - k8s script: - echo \u0026quot;deploy\u0026quot; environment: name: production url: http://www.baidu.com æ•ˆæœ\n\n FAQ\n Q1 æœªåˆ›å»º rbac\nERROR: Job failed (system failure): pods is forbidden: User \u0026quot;system:serviceaccount:gitlab-runner:default\u0026quot; cannot create resource \u0026quot;pods\u0026quot; in API group \u0026quot;\u0026quot; in the namespace \u0026quot;gitlab-runner\u0026quot; 4.11.1.7 åº”ç”¨å‘å¸ƒé›†æˆ åˆ›å»ºåç§°ç©ºé—´\nkubectl create ns cidevops å‡†å¤‡é•œåƒå‡­æ®\nkubectl create secret docker-registry cidevops \\ --docker-server=registry.cn-beijing.aliyuncs.com \\ --docker-username=xxxx \\ --docker-password=xxxx \\ --docker-email=test@test.com -n cidevops 4.11.1.8 é…ç½®æ¨¡æ¿ jobs/deploy.yml\n.deploy-k8s: stage: deploy tags: - build script: - sed -i \u0026quot;s#__namespace__#${NAMESPACE}#g\u0026quot; deployment.yaml - sed -i \u0026quot;s#__appname__#${APP_NAME}#g\u0026quot; deployment.yaml - sed -i \u0026quot;s#__containerport__#${CONTAINER_PORT}#g\u0026quot; deployment.yaml - sed -i \u0026quot;s#__nodeport__#${NODE_PORT}#g\u0026quot; deployment.yaml - sed -i \u0026quot;s#__imagename__#${IMAGE_NAME}#g\u0026quot; deployment.yaml - kubectl apply -f deployment.yaml after_script: - sleep 10 - kubectl get pod -n $NAMESPACE template.yml\ndeploy_k8s: stage: deploy extends: .deploy-k8s rules: - if: \u0026quot; $RUN_DEPLOY == 'no' \u0026quot; when: never - if: \u0026quot; $MANUAL_BRANCH == 'master' \u0026quot; when: manual - when: always environment: name: $ENV_NAME url: $ENV_URL gitlab-ci.yml\n #éƒ¨ç½²k8s NAMESPACE: \u0026quot;$CI_PROJECT_NAMESPACE\u0026quot; APP_NAME: \u0026quot;$CI_PROJECT_NAME\u0026quot; CONTAINER_PORT: 8081 NODE_PORT: 30181 4.11.1.9 æœ€ç»ˆæ•ˆæœ \n\n5 Gitlab Variables Gitlab runnerçš„ç¯å¢ƒå˜é‡åˆ†ä¸ºï¼šgroup/subgroupå’Œproject å˜é‡ï¼Œå…¶ä¸­groupå˜é‡æ˜¯å¯è¿­ä»£ç»§æ‰¿çš„ï¼Œæœ€å¤šç»§æ‰¿20ä¸ªsubgroup\n5.1 Gitlab é¢„å®šå€¼çš„ç¯å¢ƒå˜é‡ 6. GitLab runner examples  CI/CD example gitlab project example  7. GitLab Runner Extends  gitlab schedule:https://docs.gitlab.com/ee/api/pipeline_schedules.html  10 ä¸å…¶å®ƒCICDå·¥å…·æ¯”è¾ƒ 10.1 GitLabCI VS Jenkins Jenkins æ˜¯ä¸€ä¸ªå¹¿æ³›ç”¨äºæŒç»­é›†æˆçš„å¯è§†åŒ– web è‡ªåŠ¨åŒ–å·¥å…·ï¼Œjenkins å¯ä»¥å¾ˆå¥½çš„æ”¯æŒå„ç§è¯­è¨€çš„é¡¹ç›®æ„å»ºï¼Œä¹Ÿå®Œå…¨å…¼å®¹antã€mavenã€gradleç­‰å¤šç§ç¬¬ä¸‰æ–¹æ„å»ºå·¥å…·ï¼ŒåŒæ—¶è·Ÿsvnã€gitèƒ½æ— ç¼é›†æˆï¼Œä¹Ÿæ”¯æŒç›´æ¥ä¸çŸ¥åæºä»£ç æ‰˜ç®¡ç½‘ç«™ï¼Œæ¯”å¦‚githubã€bitbucketç›´æ¥é›†æˆï¼Œè€Œä¸”æ’ä»¶ä¼—å¤šï¼Œåœ¨è¿™ä¹ˆå¤šå¹´çš„æŠ€æœ¯ç§¯ç´¯ä¹‹åï¼Œåœ¨å›½å†…å¤§éƒ¨åˆ†å…¬å¸éƒ½æœ‰ä½¿ç”¨Jenkinsã€‚\ngitlab-CIæ˜¯gitlab8.0ä¹‹åè‡ªå¸¦çš„ä¸€ä¸ªæŒç»­é›†æˆç³»ç»Ÿï¼Œä¸­å¿ƒæ€æƒ³æ˜¯å½“æ¯ä¸€æ¬¡pushåˆ°gitlabçš„æ—¶å€™ï¼Œéƒ½ä¼šè§¦å‘ä¸€æ¬¡è„šæœ¬æ‰§è¡Œï¼Œç„¶åè„šæœ¬çš„å†…å®¹åŒ…æ‹¬äº†æµ‹è¯•ï¼Œç¼–è¯‘ï¼Œéƒ¨ç½²ç­‰ä¸€ç³»åˆ—è‡ªå®šä¹‰çš„å†…å®¹ã€‚\ngitlab-CIçš„è„šæœ¬æ‰§è¡Œï¼Œéœ€è¦è‡ªå®šä¹‰å®‰è£…å¯¹åº”gitlab-runneræ¥æ‰§è¡Œï¼Œä»£ç pushä¹‹åï¼Œwebhookæ£€æµ‹åˆ°ä»£ç å˜åŒ–ï¼Œå°±ä¼šè§¦å‘gitlab-CIï¼Œåˆ†é…åˆ°å„ä¸ªRunneræ¥è¿è¡Œç›¸åº”çš„è„šæœ¬scriptã€‚è¿™äº›è„šæœ¬æœ‰çš„æ˜¯æµ‹è¯•é¡¹ç›®ç”¨çš„ï¼Œæœ‰çš„æ˜¯éƒ¨ç½²ç”¨çš„ã€‚\n10.1.1 å·®å¼‚ç‚¹å¯¹æ¯” åˆ†æ”¯çš„å¯é…ç½®æ€§\n ä½¿ç”¨GitLab CIï¼Œæ–°åˆ›å»ºçš„åˆ†æ”¯æ— éœ€ä»»ä½•è¿›ä¸€æ­¥é…ç½®å³å¯ç«‹å³ä½¿ç”¨CIç®¡é“ä¸­çš„å·²å®šä¹‰ä½œä¸šã€‚ Jenkins 2 åŸºäºgitlabçš„å¤šåˆ†æ”¯æµæ°´çº¿å¯ä»¥å®ç°ã€‚ç›¸å¯¹é…ç½®æ¥è¯´gitlabæ›´åŠ æ–¹ä¾¿ä¸€äº›ã€‚  å®šæ—¶æ‰§è¡Œæ„å»º\næœ‰æ—¶ï¼Œæ ¹æ®æ—¶é—´è§¦å‘ä½œä¸šæˆ–æ•´ä¸ªç®¡é“ä¼šæœ‰æ‰€å¸®åŠ©ã€‚ä¾‹å¦‚ï¼Œå¸¸è§„çš„å¤œé—´å®šæ—¶æ„å»ºã€‚\n ä½¿ç”¨Jenkins 2å¯ä»¥ç«‹å³ä½¿ç”¨ã€‚å¯ä»¥åœ¨åº”æ‰§è¡Œä½œä¸šæˆ–ç®¡é“çš„é‚£ä¸€åˆ»ä»¥cronå¼è¯­æ³•å®šä¹‰ã€‚ GitLab CIæ²¡æœ‰æ­¤åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œå¯ä»¥é€šè¿‡ä¸€ç§å˜é€šåŠæ³•æ¥å®ç°ï¼šé€šè¿‡WebAPIä½¿ç”¨åŒä¸€å°æˆ–å¦ä¸€å°æœåŠ¡å™¨ä¸Šçš„cronjobè§¦å‘ä½œä¸šå’Œç®¡é“ã€‚  å°½ç®¡ä½¿ç”¨GitLab CIæ— æ³•åšåˆ°è¿™ä¸€ç‚¹ï¼Œå…¶å®å¦‚æœé…ç½®äº†æäº¤ä»£ç å³è§¦å‘æµæ°´çº¿ï¼Œé‚£ä¹ˆæœ€åä¸€æ¬¡æäº¤çš„æ„å»ºåœ¨ä»€ä¹ˆæ—¶å€™æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼Œåè€Œå‡å°‘æœªæäº¤ä»£ç çš„å®šæ—¶æ„å»ºèµ„æºæµªè´¹ã€‚\næ‹‰å–è¯·æ±‚æ”¯æŒ\nå¦‚æœå¾ˆå¥½åœ°é›†æˆäº†å­˜å‚¨åº“ç®¡ç†å™¨å’ŒCI / CDå¹³å°ï¼Œæ‚¨å¯ä»¥çœ‹åˆ°è¯·æ±‚çš„å½“å‰æ„å»ºçŠ¶æ€ã€‚ä½¿ç”¨è¿™ç§åŠŸèƒ½ï¼Œå¯ä»¥é¿å…å°†ä»£ç åˆå¹¶åˆ°ä¸èµ·ä½œç”¨æˆ–æ— æ³•æ­£ç¡®æ„å»ºçš„ä¸»åˆ†æ”¯ä¸­ã€‚\n Jenkinsæ²¡æœ‰ä¸æºä»£ç ç®¡ç†ç³»ç»Ÿè¿›ä¸€æ­¥é›†æˆï¼Œéœ€è¦ç®¡ç†å‘˜è‡ªè¡Œå†™ä»£ç æˆ–è€…æ’ä»¶å®ç°ã€‚ GitLabä¸å…¶CIå¹³å°ç´§å¯†é›†æˆï¼Œå¯ä»¥æ–¹ä¾¿æŸ¥çœ‹æ¯ä¸ªæ‰“å¼€å’Œå…³é—­æ‹‰åŠ¨è¯·æ±‚çš„è¿è¡Œå’Œå®Œæˆç®¡é“ã€‚  æƒé™ç®¡ç†\nä»å­˜å‚¨åº“ç®¡ç†å™¨ç»§æ‰¿çš„æƒé™ç®¡ç†å¯¹äºä¸æƒ³ä¸ºæ¯ä¸ªæœåŠ¡åˆ†åˆ«è®¾ç½®æ¯ä¸ªç”¨æˆ·çš„æƒé™çš„å¤§å‹å¼€å‘äººå‘˜æˆ–ç»„ç»‡å›¢ä½“å¾ˆæœ‰ç”¨ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œä¸¤ç§æƒ…å†µä¸‹çš„æƒé™éƒ½æ˜¯ç›¸åŒçš„ï¼Œå› æ­¤é»˜è®¤æƒ…å†µä¸‹åº”å°†å®ƒä»¬é…ç½®åœ¨ä¸€ä¸ªä½ç½®ã€‚\n ç”±äºGitLabä¸GitLabCIçš„æ·±åº¦æ•´åˆï¼Œæƒé™å¯ä»¥ç»Ÿä¸€ç®¡ç†ã€‚ ç”±äºJenkins 2æ²¡æœ‰å†…ç½®çš„å­˜å‚¨åº“ç®¡ç†å™¨ï¼Œå› æ­¤å®ƒæ— æ³•ç›´æ¥åœ¨å­˜å‚¨åº“ç®¡ç†å™¨å’ŒCI / CDå¹³å°ä¹‹é—´åˆå¹¶æƒé™ã€‚  å­˜å‚¨åº“äº¤äº’\n GitLab CIæ˜¯Gitå­˜å‚¨åº“ç®¡ç†å™¨GitLabçš„å›ºå®šç»„ä»¶ï¼Œå› æ­¤åœ¨CI / CDæµç¨‹å’Œå­˜å‚¨åº“åŠŸèƒ½ä¹‹é—´æä¾›äº†è‰¯å¥½çš„äº¤äº’ã€‚ Jenkins 2ä¸å­˜å‚¨åº“ç®¡ç†å™¨éƒ½æ˜¯æ¾æ•£è€¦åˆçš„ï¼Œå› æ­¤åœ¨é€‰æ‹©ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿæ—¶å®ƒéå¸¸çµæ´»ã€‚æ­¤å¤–ï¼Œå°±åƒå…¶å‰èº«ä¸€æ ·ï¼ŒJenkins 2å¼ºè°ƒäº†å¯¹æ’ä»¶çš„æ”¯æŒï¼Œä»¥è¿›ä¸€æ­¥æ‰©å±•æˆ–æ”¹å–„è½¯ä»¶çš„ç°æœ‰åŠŸèƒ½ã€‚  æ’ä»¶ç®¡ç†\n æ‰©å±•Jenkinsçš„æœ¬æœºåŠŸèƒ½æ˜¯é€šè¿‡æ’ä»¶å®Œæˆçš„ã€‚æ’ä»¶çš„ç»´æŠ¤ï¼Œä¿æŠ¤å’Œå‡çº§æˆæœ¬å¾ˆé«˜ã€‚ GitLabæ˜¯å¼€æ”¾å¼çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥ç›´æ¥å‘ä»£ç åº“è´¡çŒ®æ›´æ”¹ï¼Œä¸€æ—¦åˆå¹¶ï¼Œå®ƒå°†è‡ªåŠ¨æµ‹è¯•å¹¶ç»´æŠ¤æ¯ä¸ªæ›´æ”¹ã€‚  10.1.2 ä¼˜åŠ¿ä¸åŠ£åŠ¿ GitLabCI\n è½»é‡çº§ï¼Œä¸éœ€è¦å¤æ‚çš„å®‰è£…æ‰‹æ®µã€‚ é…ç½®ç®€å•ï¼Œä¸gitlabå¯ç›´æ¥é€‚é…ã€‚ å®æ—¶æ„å»ºæ—¥å¿—ååˆ†æ¸…æ™°ï¼ŒUIäº¤äº’ä½“éªŒå¾ˆå¥½ ä½¿ç”¨ YAML è¿›è¡Œé…ç½®ï¼Œä»»ä½•äººéƒ½å¯ä»¥å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨ã€‚ æ²¡æœ‰ç»Ÿä¸€çš„ç®¡ç†ç•Œé¢ï¼Œæ— æ³•ç»Ÿç­¹ç®¡ç†æ‰€æœ‰é¡¹ç›® é…ç½®ä¾èµ–äºä»£ç ä»“åº“ï¼Œè€¦åˆåº¦æ²¡æœ‰Jenkinsä½  Jenkins\n ç¼–è¯‘æœåŠ¡å’Œä»£ç ä»“åº“åˆ†ç¦»ï¼Œè€¦åˆåº¦ä½ æ’ä»¶ä¸°å¯Œï¼Œæ”¯æŒè¯­è¨€ä¼—å¤šã€‚ æœ‰ç»Ÿä¸€çš„webç®¡ç†ç•Œé¢ã€‚ æ’ä»¶ä»¥åŠè‡ªèº«å®‰è£…è¾ƒä¸ºå¤æ‚ã€‚ ä½“é‡è¾ƒå¤§ï¼Œä¸æ˜¯å¾ˆé€‚åˆå°å‹å›¢é˜Ÿã€‚  10.1.3 å®é™…åº”ç”¨  GitLabCI æœ‰åŠ©äºDevOpsäººå‘˜ï¼Œä¾‹å¦‚æ•æ·å¼€å‘ä¸­ï¼Œå¼€å‘ä¸è¿ç»´æ˜¯åŒä¸€ä¸ªäººï¼Œæœ€ä¾¿æ·çš„å¼€å‘æ–¹å¼ã€‚ JenkinsCIé€‚åˆåœ¨å¤šè§’è‰²å›¢é˜Ÿä¸­ï¼ŒèŒè´£åˆ†æ˜ã€é…ç½®ä¸ä»£ç åˆ†ç¦»ã€æ’ä»¶ä¸°å¯Œã€‚  10.2 Gitlab VS Travis end  https://www.sitespeed.io/   ","description":"","id":44,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/gitlabcicd%E7%A0%94%E7%A9%B6%E8%AF%BE%E9%A2%98/"},{"content":"ä»Šå¤©å¼€å§‹å°†åœ¨192.168.99.129è¿™å°ä¸»æœºä¸Šé€šè¿‡Jenkins:2.241ç‰ˆæœ¬ä¸ºä¾‹è¿›è¡ŒJenkinsç³»åˆ—çš„æ·±å…¥å­¦ä¹ ä¸åˆ†äº«ã€‚è‡³äºJenkinsæ˜¯å¹²å•¥çš„ï¼Œè¿™äº›æ²¡ç”¨çš„è¯å°±ä¸è¯´äº†ï¼Œå¦‚æœä½ çœ‹åˆ°æˆ‘çš„ç¬”è®°äº†ï¼Œè¯æ˜ä½ è‡³å°‘æ˜¯éœ€è¦Jenkinsä¸ºä½ åŠ©åŠ›çš„ã€‚\né€šè¿‡WARåŒ…å®‰è£…Jenkins åœ¨jenkinså®˜ç½‘ä¸‹è½½åœ°å€ä¸‹è½½2.241ç‰ˆæœ¬çš„waråŒ…,ç„¶åä½¿ç”¨ä»¥ä¸‹æ–¹å¼å®‰è£…\n1 2  # å®‰è£… nohup java -jar jenkins.war \u0026amp;   å¦‚ä½•ä½ æƒ³æŸ¥çœ‹jenkins.warçš„é…ç½®é€‰é¡¹ï¼Œä½ å¯ä»¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  root@99-129:~# java -jar jenkins.war --help Running from: /root/jenkins.war webroot: $user.home/.jenkins Jenkins Automation Server Engine 2.241 Usage: java -jar jenkins.war [--option=value] [--option=value] Options: --webroot = folder where the WAR file is expanded into. Default is ${JENKINS_HOME}/war --pluginroot = folder where the plugin archives are expanded into. Default is ${JENKINS_HOME}/plugins (NOTE: this option does not change the directory where the plugin archives are stored) --extractedFilesFolder = folder where extracted files are to be located. Default is the temp folder --daemon = fork into background and run as daemon (Unix only) --logfile = redirect log messages to this file --enable-future-java = allows running with new Java versions which are not fully supported (class version 52 and above) --javaHome = Override the JAVA_HOME variable --toolsJar = The location of tools.jar. Default is JAVA_HOME/lib/tools.jar --config = load configuration properties from here. Default is ./winstone.properties --prefix = add this prefix to all URLs (eg http://localhost:8080/prefix/resource). Default is none --commonLibFolder = folder for additional jar files. Default is ./lib --extraLibFolder = folder for additional jar files to add to Jetty classloader --logThrowingLineNo = show the line no that logged the message (slow). Default is false --logThrowingThread = show the thread that logged the message. Default is false --debug = set the level of debug msgs (1-9). Default is 5 (INFO level) ... # æ­¤å¤„å› ä¸ºå†…å®¹å¤ªå¤šï¼Œçœç•¥   æ­¤æ—¶æ‰“å¼€æµè§ˆå™¨è¾“å…¥http://192.168.99.129:8080è®¿é—®jenkins\nåœ¨çº¢è‰²æ¡†å†…æ‰¾åˆ°ç®¡ç†å‘˜çš„åˆå§‹å¯†ç \n1 2  root@99-129:~# cat ./.jenkins/secrets/initialAdminPassword ae44c519786b49b19eaef942715d7991   ç™»å½•ä¹‹åï¼Œé€‰æ‹©æ’ä»¶è¿›è¡Œå®‰è£…ï¼Œè¿™é‡Œæ¨èå®‰è£…å»ºè®®å®‰è£…çš„æ’ä»¶ï¼Œå¦‚æœå‡ºç°æ’ä»¶å®‰è£…å¤±è´¥ï¼Œå»ºè®®è·³è¿‡å®‰è£…ï¼Œç­‰ç™»å½•ä¸Šå»ä¹‹åï¼Œåœ¨è¿›è¡Œå®‰è£…æ’ä»¶\nç„¶åå°±æ˜¯é…ç½®ä¸€ä¸ªç®¡ç†å‘˜è´¦å·ï¼Œç™»å½•ä¹‹åçš„ç•Œé¢å¦‚ä¸‹:\nè¿™æ ·é€šè¿‡waråŒ…å®‰è£…çš„Jenkinså°±å®Œæˆäº†ã€‚\nä½¿ç”¨Dockerå®‰è£…Jenkins 1 2 3  mkdir ~/workspace/ cd $_ docker run -d -p 8080:8080 -v $(PWD)/jenkins3:/var/jenkins_home -v /var/run/docker.sock:/var/run/docker.sock -v ~/.m2:/root/.m2 --name jenkins jenkins/jenkins:2.241   åœ¨å®‰è£…å®¹å™¨è¿è¡Œèµ·æ¥ä¹‹åï¼Œæˆ‘ä»¬é€šè¿‡ä»¥ä¸‹å‘½ä»¤è·å–Jenkinsåˆå§‹è´¦å·å¯†ç \n1 2  â˜¸ï¸ devclusterğŸ”¥ kube-ops ~/workspaces/jenkins-kubenetes-231 î‚° ğŸ³ ğŸ‘‰ cat jenkins3/secrets/initialAdminPassword 84a43f93a3494c8aa6dc30a82b2711ed   æ¥ä¸‹æ¥çš„æ­¥éª¤å¦‚ä¸Šç±»ä¼¼ï¼Œå®‰è£…æ’ä»¶ï¼Œé…ç½®ç”¨æˆ·ï¼Œç„¶åç™»å½•å³å¯ã€‚\nè®¾ç½®æ’ä»¶æº åœ¨å®‰è£…æˆåŠŸä¹‹åï¼Œæˆ‘ä»¬éœ€è¦ä¸‹è½½éƒ¨åˆ†çš„æ’ä»¶ï¼Œä½†æ˜¯æ’ä»¶åœ¨å›½å†…ä¸‹è½½ååˆ†æ…¢ï¼Œå› æ­¤æˆ‘ä»¬è¿™é‡Œå°†ä½¿ç”¨æ¸…åçš„æºæ›¿æ¢é»˜è®¤çš„æ’ä»¶æºï¼Œæé«˜ä¸‹è½½é€Ÿåº¦ï¼Œæˆ‘ä»¬æŒ‰ç…§ä»¥ä¸‹çš„æ­¥éª¤è¿›è¡Œé…ç½®ã€‚\n1  Manage Jenkins \u0026gt; Manage plugins \u0026gt; Advanced \u0026gt; Update Site   å°†æ–‡æœ¬æ¡†çš„å†…å®¹æ›¿æ¢ä¸º\n1  https://mirror.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json   è¿™æ ·å°±å®Œæˆäº†æ’ä»¶æºçš„æ›¿æ¢ï¼Œäº²æµ‹ä¸‹è½½pipelineæ’ä»¶ä»¥åŠå®ƒçš„ä¾èµ–æ’ä»¶å¤§æ¦‚ä¸€åˆ†é’Ÿçš„æ—¶é—´ï¼Œè¿˜å¯ä»¥æ¥å—ã€‚å¤§å®¶åœ¨å®‰è£…é‡åˆ°é—®é¢˜åå¯ä»¥æ‰¾æˆ‘å’¨è¯¢ã€‚å¾®ä¿¡devsecopser\n","description":"","id":45,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/jenkins-in-actions/01-jenkins%E5%AE%89%E8%A3%85%E7%AF%87/"},{"content":"æ˜¾ç¤ºæ­£åœ¨å¯åŠ¨,è¯·ç¨å\u0026hellip; åœ¨Jenkinsçš„å®‰è£…è¿‡ç¨‹ä¸­æˆ‘ä»¬ç»å¸¸ä¼šé‡åˆ°æ— æ³•æ­£å¸¸çš„è®¿é—®åˆ°Jenkinsæ’ä»¶æºé€ æˆJenkinsçš„å®‰è£…è¿‡ç¨‹ä¸€ç›´å¡ç€ï¼Œå¤„äºæ˜¾ç¤ºæ­£åœ¨å¯åŠ¨,è¯·ç¨å...æ­¤æ—¶æˆ‘ä»¬åªæœ‰æ›´æ¢ä¸€ä¸‹æ’ä»¶æºæ‰æœ‰å¸Œæœ›é¡ºåˆ©çš„è¿›å…¥å®‰è£…è¿‡ç¨‹ï¼Œåœ¨jenkins2.241ç‰ˆæœ¬ä¸­ï¼Œæ›´æ¢æ’ä»¶æºçš„æ–¹å¼ä¸º:\n1 2 3 4 5 6 7 8 9  vim ~/.jenkins/hudson.model.UpdateCenter.xml # å°†\u0026lt;url\u0026gt;æ ‡ç­¾ä¸­çš„åœ°å€æ›´æ¢ä¸º:http://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json,æ›´æ”¹åä¸º: cat ~/.jenkins/hudson.model.UpdateCenter.xml \u0026lt;?xml version=\u0026#39;1.1\u0026#39; encoding=\u0026#39;UTF-8\u0026#39;?\u0026gt; \u0026lt;sites\u0026gt; \u0026lt;site\u0026gt; \u0026lt;id\u0026gt;default\u0026lt;/id\u0026gt; \u0026lt;url\u0026gt;http://mirrors.tuna.tsinghua.edu.cn/jenkins/updates/update-center.json\u0026lt;/url\u0026gt; \u0026lt;/site\u0026gt;   è¿™æ ·é‡å¯Jenkinså³å¯è¿›å…¥æ’ä»¶çš„å®‰è£…ç¯èŠ‚ã€‚\ninstallation of 73 plugins in 1 hr 26 min åœ¨ç‰ˆæœ¬ä¸ºJenkins2.241çš„åˆå§‹åŒ–å®‰è£…æ—¶ï¼Œé€‰æ‹©å·²å‹¾é€‰çš„æ’ä»¶ï¼ŒåŒ…æ‹¬æ’ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ä¸€å…±æ˜¯å®‰è£…äº†73ä¸ªï¼Œå…±è€—æ—¶1h26minï¼Œä¾‹å¦‚ä»¥ä¸‹å®‰è£…æ’ä»¶çš„æ—¥å¿—ï¼š\n1  2020-06-26 10:53:22.921+0000 [id=67]\tINFO\th.m.UpdateCenter$CompleteBatchJob#run: Completed installation of 73 plugins in 1 hr 26 min   è¿™æ ·çš„äº‹æƒ…æˆ‘è§‰å¾—è¿˜æ˜¯ç»å†ä¸€æ¬¡å°±å¥½äº†ï¼Œä¸‹æ¬¡éœ€è¦å®‰è£…çš„æ—¶å€™è¯¥æ€ä¹ˆåŠï¼Ÿå»ºè®®å°†å…¶çš„æ’ä»¶ä¿å­˜ä¸€ä¸ªå‰¯æœ¬ï¼Œä¸‹æ¬¡åœ¨å®‰è£…çš„æ—¶å€™å°†å…¶pluginsç›®å½•æ”¾åœ¨éœ€è¦å®‰è£…çš„Jenkinsçš„æ•°æ®ç›®å½•ä¸‹ï¼Œå¦‚æœæ˜¯Dockerå®¹å™¨å®‰è£…çš„ä¹Ÿå¯ä»¥å°†å…¶æŒ‚è½½åˆ°å®¹å™¨ä¸­ï¼Œè¿™æ ·å®‰è£…è¿‡ç¨‹å˜å¾—å°±éå¸¸å¿«äº†ã€‚\nLocalization: Chinese (Simplified) ä¸ºäº†è§£å†³æ’ä»¶ä¸‹è½½ç¼“æ…¢çš„é—®é¢˜ï¼Œç›®å‰æœ‰å‡ ç§æŠ•æœºå–å·§çš„æ–¹æ³•ï¼š\næ‹·è´æ’ä»¶ è§£å†³åœºæ™¯æ˜¯é¿å…Jenkinsåœ¨å®‰è£…è¿‡ç¨‹ä¸­åŸºç¡€åŠŸèƒ½çš„æ’ä»¶ä¸‹æ…¢çš„é—®é¢˜ï¼Œå†ä¸€ä¸ªæ˜¯åœ¨Jenkinsçš„è¿ç§»æ—¶å€™ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨è¿™æ ·çš„æ–¹å¼è¿›è¡Œå®‰è£…ã€‚\næ›´æ¢æ’ä»¶æº ç½‘ä¸Šå¤§éƒ¨åˆ†äººæ¨èä½¿ç”¨æ¸…åçš„æ’ä»¶æºæ¥ä¸‹è½½æ’ä»¶ï¼Œä½†æ˜¯åœ¨æµ‹è¯•ä¹‹åå‘ç°è¿˜æ˜¯æœ‰äº›ç¼“æ…¢ï¼Œä½†æ˜¯ç¡®å®æ¯”é»˜è®¤çš„å·²ç»å¾ˆå¥½äº†ã€‚\nè§£å†³ä¸‹è½½çš„æœ€åä¸€å…¬é‡Œ 2019.11å·¦å³ï¼ŒJenkinsä¸­æ–‡ç¤¾åŒºçš„å›½å†…é•œåƒæºå‘å¸ƒäº†ï¼Œå…·ä½“çš„å¯ä»¥çœ‹Jenkinsä¸­æ–‡ç¤¾åŒºçš„åšå®¢ï¼Œæ›´å¤šçš„èƒŒæ™¯ä¿¡æ¯è¿™é‡Œå°±ä¸åœ¨è¯´æ˜äº†ï¼Œä½†æ˜¯ä¸‹è½½æ’ä»¶çš„é€Ÿåº¦ä¸å¾—ä¸è¯´åŸºæœ¬ä¸Šå¿«æ— æ„ŸçŸ¥äº†ï¼Œå½“é€‰æ‹©äº†æ’ä»¶è¿›è¡Œå®‰è£…ï¼Œåˆ·æ–°ä¸€ä¸‹æµè§ˆå™¨å°±æ˜¾ç¤ºå®‰è£…å®Œæˆäº†ã€‚é¦–å…ˆåœ¨æ’ä»¶å¯ç”¨åŒºæœç´¢ä»¥ä¸‹æ’ä»¶\nå®‰è£…å®Œæˆåä¼šåœ¨Jenkinsçš„é¦–é¡µçš„å·¦ä¸‹è§’æ˜¾ç¤ºä¸­æ–‡ç¤¾åŒºçš„å­—æ ·\nç‚¹å‡»è¿›å»ä¹‹åï¼Œå°±ä¼šçœ‹åˆ°ä¸­æ–‡ç¤¾åŒºçš„æ’ä»¶æºï¼Œç„¶åè®¾ç½®æ›´æ–°ä¸­å¿ƒåœ°å€å³å¯\næœ€åï¼Œæˆ‘ä»¬åœ¨è®¾ç½®ç©æ’ä»¶çš„åœ°å€ä¹‹åï¼Œé€šè¿‡ç‚¹å‡»ç«‹å³è·å–æŸ¥çœ‹æ˜¯å¦æ­£å¸¸\nè¿™æ ·åŸºæœ¬ä¸Šå°±è§£å†³äº†åç»­å› ä¸ºæ’ä»¶å®‰è£…å¸¦æ¥çš„å„ç§éº»çƒ¦ï¼Œå¦‚æœè¢«æ’ä»¶æŠ˜ç£¨çš„å¾ˆç—›è‹¦ï¼Œç°åœ¨å¯ä»¥äº²è‡ªå®è·µä¸€ä¸‹è¯•è¯•æ•ˆæœå•Šã€‚\n","description":"","id":46,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/jenkins-in-actions/02-jenkins%E5%AE%89%E8%A3%85%E7%96%91%E9%9A%BE%E6%9D%82%E7%97%87/"},{"content":"ç”¨æˆ·æƒé™ä¸ç®¡ç† è§£å†³ä¸åŒçš„èŒèƒ½éƒ¨é—¨çš„äººä½¿ç”¨é€šä¸€ä¸ªJenkinså®ä¾‹çš„æ—¶å€™æƒé™åˆ†é…çš„é—®é¢˜ï¼Œå®ç°é€šè¿‡é›†ä¸­è®¤è¯æœåŠ¡å™¨OpenLDAPè¿›è¡Œäººå‘˜è®¤è¯ï¼Œé€šè¿‡æƒé™åŒ¹é…å®ç°åªèƒ½è®¿é—®é‚£äº›é¡¹ç›®æˆ–è€…æ‰§è¡Œå“ªäº›ä»»åŠ¡ã€‚å…³äºOpenLDAPçš„æ­å»ºè¯·å‚è€ƒã€Šè½»ç›®å½•è®¿é—®åè®®çš„å¼€æºå®ç°LDAP2.4ã€‹\nç”¨æˆ·ç®¡ç† Jenkinsç”¨æˆ·ç®¡ç†ä½¿ç”¨è¾ƒä¸ºæ™®éçš„ä¸ºä¸¤ç§:\n Jenkinså†…ç½®çš„ä¸“æœ‰ç”¨æˆ·æ•°æ®åº“ LDAPæœåŠ¡è®¤è¯  é€šå¸¸ä½¿ç”¨å†…ç½®çš„ç”¨æˆ·æ•°æ®åº“éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨çš„æ·»åŠ ç”¨æˆ·ï¼Œåœ¨ç³»ç»Ÿç®¡ç†-\u0026gt;ç®¡ç†ç”¨æˆ·-\u0026gt;æ–°å»ºç”¨æˆ·å¤„æ·»åŠ \nå¦å¤–ä¸€ç§åˆ™æ˜¯é€šè¿‡è¿æ¥è¿œç¨‹çš„LDAPæœåŠ¡å™¨åšé›†ä¸­è®¤è¯ï¼Œåœ¨ç³»ç»Ÿç®¡ç†-\u0026gt;å…¨å±€å®‰å…¨é…ç½®-\u0026gt;å®‰å…¨åŸŸå¤„é€‰æ‹©LDAP,ç„¶åç‚¹å‡»é«˜çº§é…ç½®ç›¸å…³ä¿¡æ¯ï¼Œä»¥ä¸‹ä½œä¸ºå‚è€ƒ:\næœ€åé€šè¿‡TEST LDAP SETTINGæ£€æŸ¥æ˜¯å¦æ­£å¸¸\nç”¨æˆ·æƒé™ç®¡ç† ç”¨æˆ·çš„æƒé™ç®¡ç†å¯ä»¥åŸºäºä¸¤ç§æ–¹å¼ï¼Œä¸€ä¸ªæ˜¯ç”¨æˆ·çš„è§’è‰²ï¼Œä¸€ä¸ªæ˜¯åŸºäºæ–‡ä»¶å¤¹è¿›è¡Œæƒé™åˆ’åˆ†ï¼Œå¯¹åº”çš„æ’ä»¶åˆ†åˆ«æ˜¯ä¸‹å›¾ï¼š\nåœ¨å®‰è£…å®Œæˆä¹‹åï¼Œæ‰“å¼€ç³»ç»Ÿç®¡ç†-\u0026gt; å…¨å±€å®‰å…¨é…ç½®ä¼šå‘ç°æˆæƒç­–ç•¥å¤šäº†ä¸¤ç§ï¼Œåˆ†åˆ«ä¸º:\næˆ‘ä»¬é€‰æ‹©åŸºäºè§’è‰²çš„ç­–ç•¥çš„æ—¶å€™ï¼Œä¼šå‘ç°åœ¨ç³»ç»Ÿç®¡ç†é‡Œé¢å¤šå‡ºä¸€ä¸ªmanage and assign rolesçš„æœªåˆ†ç±»çš„åŠŸèƒ½æ¨¡å—ï¼Œåœ¨é‡Œé¢å¯ä»¥å®ŒæˆåŸºæœ¬çš„æƒé™åˆ†é…\nå®ç°æƒé™åˆ†é…  å°†æˆ‘ä»¬çš„é¡¹ç›®å¤åˆ¶æˆå¦‚ä¸‹ç”¨äºæµ‹è¯•ï¼š  æ–°å»º 3 ä¸ªæµ‹è¯•ç”¨æˆ·ï¼štest / develop / product  æ‰“å¼€ï¼šç³»ç»Ÿç®¡ç† \u0026ndash;\u0026gt; ç®¡ç†ç”¨æˆ·\næœ€ç»ˆç”¨æˆ·æ ¼å¼ï¼š\né…ç½®æƒé™ï¼š\næ‰“å¼€ï¼šç³»ç»Ÿç®¡ç† \u0026ndash;\u0026gt; Manage and Assign Roles\næˆ‘ä»¬ä¸»è¦ä½¿ç”¨ä¸Šé¢ä¸¤ç§ã€‚ä¸€ä¸ªç”¨æˆ·æƒ³è¦è¿›è¡Œæ“ä½œå¿…é¡»è¦æœ‰ä¸¤ç§è§’è‰²ï¼Œä¸€ç§æ˜¯å…¨å±€ï¼Œä¸€ç§æ˜¯ Projectï¼š\n åˆ›å»ºè§’è‰²ï¼šManage Roles  åˆ†é…è§’è‰²ï¼šAssign Roles  è¯´æ˜ï¼šæˆ‘ä»¬è¿™ä¸‰ä¸ªç”¨æˆ·å…¶å®ä»£è¡¨ç€ä¸‰ä¸ªä¸åŒçš„å±æ€§ï¼Œä¸ºäº†åŒºåˆ†æˆ‘ç»™ä»–å®šä¹‰äº†ä¸‰ç§ä¸åŒè§’è‰²ã€‚è¿™æ ·ä»¥åå°±å¯ä»¥ç»™æ¯ä¸ªè§’è‰²æˆæƒä¸ä¸€æ ·çš„æƒé™ã€‚\nå½“ç„¶ï¼Œæˆ‘ä»¬è¿™é‡Œå°±ç»™äº†ä¸€ä¸ªå…¨éƒ¨çš„åªè¯»æƒé™ï¼Œç”¨æˆ·å¯ä»¥ç™»å½•ï¼Œå¹¶ä¸”ä¿®æ”¹è‡ªå·±çš„ä¸œè¥¿ã€‚\nåˆ›å»ºé¡¹ç›®è§’è‰²ï¼šManage Roles  ç»™ç”¨æˆ·åˆ†é…é¡¹ç›®æƒé™ï¼šAssign Roles  è¯´æ˜ï¼šæˆ‘ä»¬ç»™ç”¨æˆ·åˆ†é…ä¸åŒçš„é¡¹ç›®å’Œæƒé™ï¼Œä¾¿äºæµ‹è¯•å¯¹æ¯”ã€‚\næŸ¥çœ‹æƒé™æ•ˆæœï¼š  test ç”¨æˆ·ç™»å½•åé¡¹ç›®ï¼š\ntest ç”¨æˆ·é¡¹ç›®æƒé™ï¼š\ntest ç”¨æˆ·æƒé™è¯´æ˜ï¼štest ç”¨æˆ·ç™»å½•åèƒ½çœ‹åˆ° TEST å¼€å¤´çš„é¡¹ç›®ï¼ŒåŒ…æ‹¬æ–‡ä»¶å¤¹ï¼Œä½†æ˜¯å¯¹äºé¡¹ç›®ï¼Œtest ç”¨æˆ·éƒ½åªå…·æœ‰æ‰§è¡Œæƒé™ï¼Œè€Œæ²¡æœ‰ä¿®æ”¹å’Œé…ç½®çš„æƒé™ã€‚\ndevelop ç”¨æˆ·ç™»å½•åé¡¹ç›®ï¼š\ndevelop ç”¨æˆ·é¡¹ç›®æƒé™ï¼š\ndevelop ç”¨æˆ·æƒé™è¯´æ˜ï¼šå¯ä»¥çœ‹åˆ°ï¼Œå› ä¸ºæˆ‘ä»¬å¤šé…ç½®äº† Config æƒé™çš„åŸå› ï¼Œdevelop ç›¸æ¯”äº test ç”¨æˆ·å¯¹äºåˆ†é…ç»™è‡ªå·±æƒé™çš„é¡¹ç›®å¤šäº†ä¿®æ”¹é…ç½®æƒé™ã€‚\nproduct ç”¨æˆ·ç™»å½•åé¡¹ç›®ï¼š\nproduct ç”¨æˆ·å¯¹äº TEST é¡¹ç›®æƒé™ï¼š\nproduct ç”¨æˆ·å¯¹äº PRODUCT é¡¹ç›®æƒé™ï¼š\nproduct ç”¨æˆ·æˆæƒè¯´æ˜ï¼šæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼ŒPROCUDT é¡¹ç›®ç”±äºæˆæƒäº† config æƒé™ï¼Œæ‰€ä»¥ç”¨æˆ·èƒ½å¤Ÿä¿®æ”¹ï¼ŒTEST é¡¹ç›®æ²¡ç”¨ config æƒé™ï¼Œè™½ç„¶åŒæ ·æ˜¯æˆæƒç»™äº† product ç”¨æˆ·ï¼Œä½†æ˜¯ä¹Ÿæ˜¯åªæœ‰æ‰§è¡Œæƒé™è€Œå·²ã€‚\nè‡³æ­¤ï¼ŒåŸºæœ¬çš„æƒé™ç®¡ç†å¤§è‡´å®Œæˆï¼\nç‰¹åˆ«æ³¨æ„\nåœ¨æˆ‘ä»¬è®¾ç½®ç”¨æˆ·æƒé™çš„æ—¶å€™ï¼Œé»˜è®¤å·²ç»åŒ…å«äº†ç®¡ç†å‘˜è§’è‰²ï¼š\nå¦‚æœæˆ‘ä»¬ä¸€ä¸å°å¿ƒæŠŠè¿™ä¸ªå‹¾å»æ‰äº†ï¼Œç„¶åå°±ç‚¸äº†ï¼\næœ€ç»ˆçš„è§£å†³åŠæ³•æ˜¯ï¼š\n  åœæ­¢ Jenkinsã€‚\n  å¤‡ä»½ /data/jenkins/jenkins-data/config.xml é…ç½®æ–‡ä»¶ã€‚\n  ä¿®æ”¹é…ç½®ï¼š\n  1 2 3 4  \u0026lt;useSecurity\u0026gt;true\u0026lt;/useSecurity\u0026gt; # æ”¹ä¸º \u0026lt;useSecurity\u0026gt;false\u0026lt;/useSecurity\u0026gt;   åˆ é™¤æƒé™é…ç½®ï¼šå»ºè®®æ–‡ä»¶æ‹¿æ¥äº†ä½¿ç”¨ nodepad++ ç±»ä¼¼çš„å·¥å…·ä¿®æ”¹  åˆ é™¤ï¼š æ ‡ç­¾åŠå…¶å†…éƒ¨å†…å®¹ã€‚\nåˆ é™¤ï¼š æ ‡ç­¾åŠå…¶å†…éƒ¨å†…å®¹ã€‚\nå¯åŠ¨ jenkinsï¼Œæ­¤æ—¶ä¸éœ€è¦ç”¨æˆ·åå¯†ç ï¼ŒæŸ¥çœ‹è®¾ç½®ï¼š  é»˜è®¤æ²¡æœ‰å¯åŠ¨å®‰å…¨ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°é…ç½®æˆ‘ä»¬ä¹‹å‰çš„ä¸œè¥¿ï¼\n","description":"","id":47,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/jenkins-in-actions/03-jenkins%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E4%B8%8E%E7%AE%A1%E7%90%86/"},{"content":"åœ¨jenkinsçš„æ„å»ºçŠ¶æ€æ ä¸­æ˜¾ç¤ºæ„å»ºçš„ç›¸å…³ä¿¡æ¯\n","description":"","id":48,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/jenkins-in-actions/jenkins%E6%98%BE%E7%A4%BA%E6%9E%84%E5%BB%BA%E6%8F%90%E4%BA%A4%E4%BF%A1%E6%81%AF/"},{"content":"kubernetesæ ¸å¿ƒç»„ä»¶\n  etcd\n  kube\n    ","description":"","id":49,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/kubernetes-in-actions/kubernetes-roadmaps/"},{"content":"kubernetesèƒŒæ™¯ Kubernetesï¼Œåˆç§°ä¸º k8sï¼ˆé¦–å­—æ¯ä¸º kã€é¦–å­—æ¯ä¸å°¾å­—æ¯ä¹‹é—´æœ‰ 8 ä¸ªå­—ç¬¦ã€å°¾å­—æ¯ä¸º sï¼Œæ‰€ä»¥ç®€ç§° k8sï¼‰æˆ–è€…ç®€ç§°ä¸º \u0026ldquo;kube\u0026rdquo; ï¼Œæ˜¯ä¸€ç§å¯è‡ªåŠ¨å®æ–½ Linux å®¹å™¨æ“ä½œçš„å¼€æºå¹³å°ã€‚å®ƒå¯ä»¥å¸®åŠ©ç”¨æˆ·çœå»åº”ç”¨å®¹å™¨åŒ–è¿‡ç¨‹çš„è®¸å¤šæ‰‹åŠ¨éƒ¨ç½²å’Œæ‰©å±•æ“ä½œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‚¨å¯ä»¥å°†è¿è¡Œ Linux å®¹å™¨çš„å¤šç»„ä¸»æœºèšé›†åœ¨ä¸€èµ·ï¼Œç”± Kubernetes å¸®åŠ©æ‚¨è½»æ¾é«˜æ•ˆåœ°ç®¡ç†è¿™äº›é›†ç¾¤ã€‚è€Œä¸”ï¼Œè¿™äº›é›†ç¾¤å¯è·¨å…¬å…±äº‘ã€ç§æœ‰äº‘æˆ–æ··åˆäº‘éƒ¨ç½²ä¸»æœºã€‚Kubernetes æ˜¯ç†æƒ³çš„æ‰˜ç®¡å¹³å°ã€‚\nKubernetes æœ€åˆç”± Google çš„å·¥ç¨‹å¸ˆå¼€å‘å’Œè®¾è®¡ã€‚Google æ˜¯æœ€æ—©ç ”å‘ Linux å®¹å™¨æŠ€æœ¯çš„ä¼ä¸šä¹‹ä¸€ï¼ˆç»„å»ºäº†cgroupsï¼‰ï¼Œæ›¾å…¬å¼€åˆ†äº«ä»‹ç»Google å¦‚ä½•å°†ä¸€åˆ‡éƒ½è¿è¡Œäºå®¹å™¨ä¹‹ä¸­ï¼ˆè¿™æ˜¯ Google äº‘æœåŠ¡èƒŒåçš„æŠ€æœ¯ï¼‰ã€‚Google æ¯å‘¨ä¼šå¯ç”¨è¶…è¿‡ 20 äº¿ä¸ªå®¹å™¨â€”â€”å…¨éƒ½ç”±å†…éƒ¨å¹³å° Borg æ”¯æ’‘ã€‚Borg æ˜¯ Kubernetes çš„å‰èº«ï¼Œå¤šå¹´æ¥å¼€å‘ Borg çš„ç»éªŒæ•™è®­æˆäº†å½±å“ Kubernetes ä¸­è®¸å¤šæŠ€æœ¯çš„ä¸»è¦å› ç´ ã€‚\nçº¢å¸½æ˜¯ç¬¬ä¸€æ‰¹ä¸ Google åˆä½œç ”å‘ Kubernetes çš„å…¬å¸ä¹‹ä¸€ï¼Œä½œä¸º Kubernetes ä¸Šæ¸¸é¡¹ç›®çš„ç¬¬äºŒå¤§è´¡çŒ®è€…ï¼Œæˆ‘ä»¬ç”šè‡³åœ¨è¿™ä¸ªé¡¹ç›®å¯åŠ¨ä¹‹å‰å°±å·²å‚ä¸å…¶ä¸­ã€‚2015 å¹´ï¼ŒGoogle å°† Kubernetes é¡¹ç›®æèµ ç»™æ–°æˆç«‹çš„äº‘åŸç”Ÿè®¡ç®—åŸºé‡‘ä¼šã€‚\nKuberneters(k8s)æ˜¯è°·æ­Œä½¿ç”¨äº†å°†è¿‘20å¹´çš„ä¸€ä¸ªäº‘äº§å“ï¼Œæ˜¯Borgçš„ä¸€ä¸ªå¼€æºç‰ˆæœ¬ã€‚Borgæ˜¯è°·æ­Œçš„ä¸€ä¸ªä¹…è´Ÿç››åçš„å†…éƒ¨ä½¿ç”¨çš„å¤§è§„æ¨¡é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œå®ƒåŸºäºå®¹å™¨æŠ€æœ¯ï¼Œç›®çš„æ˜¯å®ç°èµ„æºç®¡ç†çš„è‡ªåŠ¨åŒ–ï¼Œä»¥åŠè·¨å¤šä¸ªæ•°ä¸­å¿ƒçš„èµ„æºåˆ©ç”¨ç‡çš„æœ€å¤§åŒ–ã€‚åå‡ å¹´æ¥ï¼Œè°·æ­Œä¸€ç›´é€šè¿‡ Borg ç³»ç»Ÿç®¡ç†ç€æ•°é‡åºå¤§çš„åº”ç”¨ç¨‹åºé›†ç¾¤ã€‚ç”±äºè°·æ­Œå‘˜å·¥éƒ½ç­¾ç½²äº†ä¿å¯†åè®®ï¼Œå³ä¾¿ç¦»èŒä¹Ÿä¸èƒ½æ³„éœ²Borgçš„å†…éƒ¨è®¾è®¡ï¼Œæ‰€ä»¥å¤–ç•Œä¸€ç›´æ— æ³•äº†è§£å…³äºå®ƒçš„æ›´å¤šä¿¡æ¯ã€‚ç›´åˆ°2015å¹´4æœˆï¼Œä¼ é—»è®¸ä¹…çš„ Borg è®ºæ–‡ä¼´éš Kuberneters çš„é«˜è°ƒå®£ä¼ è¢«è°·æ­Œé¦–æ¬¡å…¬å¼€ï¼Œå¤§å®¶æ‰å¾—ä»¥äº†è§£å®ƒçš„æ›´å¤šå†…å¹•ã€‚æ­£æ˜¯ç”±äºç«™åœ¨ Borg è¿™ä¸ªå‰è¾ˆçš„è‚©è†€ä¸Šï¼Œå¸å–äº† Borg è¿‡å»åå¹´é—´çš„ç»éªŒä¸æ•™è®­ï¼Œæ‰€ä»¥ Kubernetes ä¸€ç»å¼€æºå°±ä¸€é¸£æƒŠäººï¼Œå¹¶è¿…é€Ÿç§°éœ¸äº†å®¹å™¨æŠ€æœ¯é¢†åŸŸã€‚\nKubernetes æ‹¥æœ‰ä¸€ä¸ªåºå¤§ä¸”å¿«é€Ÿå¢é•¿çš„ç”Ÿæ€ç³»ç»Ÿã€‚å› ä¸ºå®ƒæ˜¯ä¸€ä¸ªå¯ç§»æ¤çš„ã€å¯æ‰©å±•çš„å¼€æºå¹³å°ï¼Œç”¨äºç®¡ç†å®¹å™¨åŒ–çš„å·¥ä½œè´Ÿè½½å’ŒæœåŠ¡ï¼Œå¯ä¿ƒè¿›å£°æ˜å¼é…ç½®å’Œè‡ªåŠ¨åŒ–ã€‚Kubernetes çš„æœåŠ¡ã€æ”¯æŒå’Œå·¥å…·å¹¿æ³›å¯ç”¨ã€‚\nKubernetes æºäºå¸Œè…Šè¯­ï¼Œæ„ä¸º \u0026ldquo;èˆµæ‰‹\u0026rdquo; æˆ– \u0026ldquo;é£è¡Œå‘˜\u0026rdquo;ã€‚Google åœ¨ 2014 å¹´å¼€æºäº† Kubernetes é¡¹ç›®ã€‚Kubernetes å»ºç«‹åœ¨ Google åœ¨å¤§è§„æ¨¡è¿è¡Œç”Ÿäº§å·¥ä½œè´Ÿè½½æ–¹é¢æ‹¥æœ‰åå‡ å¹´çš„ç»éªŒçš„åŸºç¡€ä¸Šï¼Œç»“åˆäº†ç¤¾åŒºä¸­æœ€å¥½çš„æƒ³æ³•å’Œå®è·µã€‚\nkubernetesæ—¶ä»£ é€šè¿‡å¯¹æ¯”æ¥çœ‹ä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘ä»¬éœ€è¦kubernetesï¼Œä¸ºä»€ä¹ˆæ–°æ—¶ä»£éœ€è¦kubernetesï¼š\nä¼ ç»Ÿéƒ¨ç½²æ—¶ä»£ï¼š æ—©æœŸï¼Œå°†å•ä¸€çš„åº”ç”¨æœåŠ¡è¿è¡Œåœ¨ç‰©ç†æœåŠ¡å™¨ä¸Šï¼Œæ— æ³•ç»™æœåŠ¡å™¨çš„åº”ç”¨ç¨‹åºè¿›è¡Œèµ„æºçš„é™åˆ¶ï¼Œå¯¼è‡´ç‰©ç†æœåŠ¡å™¨ä¹‹é—´çš„èµ„æºè´Ÿè½½ä½¿ç”¨ä¸å‡è¡¡ï¼Œå°±å¯¼è‡´äº†æœåŠ¡å™¨ä¸Šçš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½ä¸‹é™ï¼Œç‰©ç†æœåŠ¡å™¨çš„ç»´æŠ¤æˆæœ¬å˜å¾—å¾ˆé«˜ã€‚\nè™šæ‹ŸåŒ–éƒ¨ç½²æ—¶ä»£ï¼š ä½œä¸ºè§£å†³æ–¹æ¡ˆï¼Œå¼•å…¥äº†è™šæ‹ŸåŒ–åŠŸèƒ½ï¼Œå®ƒå…è®¸æ‚¨åœ¨å•ä¸ªç‰©ç†æœåŠ¡å™¨çš„ CPU ä¸Šè¿è¡Œå¤šä¸ªè™šæ‹ŸæœºVMã€‚è™šæ‹ŸåŒ–åŠŸèƒ½å…è®¸åº”ç”¨ç¨‹åºåœ¨ VM ä¹‹é—´éš”ç¦»ï¼Œå¹¶æä¾›å®‰å…¨çº§åˆ«ï¼Œå› ä¸ºä¸€ä¸ªåº”ç”¨ç¨‹åºçš„ä¿¡æ¯ä¸èƒ½è¢«å¦ä¸€åº”ç”¨ç¨‹åºè‡ªç”±åœ°è®¿é—®ã€‚\nå®¹å™¨éƒ¨ç½²æ—¶ä»£ï¼š å®¹å™¨ç±»ä¼¼äº VMï¼Œä½†æ˜¯å®ƒä»¬å…·æœ‰è½»é‡çº§çš„éš”ç¦»å±æ€§ï¼Œå¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¹‹é—´å…±äº«æ“ä½œç³»ç»ŸOSã€‚å› æ­¤ï¼Œå®¹å™¨è¢«è®¤ä¸ºæ˜¯ç›®å‰æœ€è½»é‡çº§çš„ã€‚å®¹å™¨ä¸ VM ç±»ä¼¼ï¼Œå…·æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿã€CPUã€å†…å­˜ã€è¿›ç¨‹ç©ºé—´ç­‰ã€‚ç”±äºå®ƒä»¬ä¸åŸºç¡€æ¶æ„åˆ†ç¦»ï¼Œå› æ­¤å¯ä»¥è·¨äº‘å’Œ OS åˆ†å‘è¿›è¡Œç§»æ¤ã€‚è€Œåœ¨å®¹å™¨æ—¶ä»£ï¼ŒDockerå®¹å™¨å¼•æ“æ˜¯æœ€æµè¡Œçš„ä¸€ä¸ªã€‚\nå®¹å™¨å› å…·æœ‰è®¸å¤šä¼˜åŠ¿è€Œå˜å¾—æµè¡Œèµ·æ¥ã€‚ä¸‹é¢åˆ—å‡ºäº†å®¹å™¨çš„ä¸€äº›å¥½å¤„ï¼š\n åº”ç”¨ç¨‹åºçš„æ„å»ºå’Œéƒ¨ç½²ï¼šä¸ä¼ ç»Ÿéƒ¨ç½²æ—¶ä»£å¯¹æ¯”ï¼Œå®¹å™¨é•œåƒåˆ›å»ºæ˜¾å¾—æ›´ç®€ä¾¿æ€§ã€æ•ˆç‡æ›´é«˜ã€‚ æŒç»­å¼€å‘ã€é›†æˆå’Œéƒ¨ç½²ï¼šé€šè¿‡å¿«é€Ÿç®€å•çš„å›æ»š(ç”±äºé•œåƒä¸å¯å˜æ€§)ï¼Œæä¾›å¯é ä¸”é¢‘ç¹çš„å®¹å™¨é•œåƒæ„å»ºå’Œéƒ¨ç½²ã€‚ å¼€å‘ä¸è¿ç»´åˆ†ç¦»ï¼šåœ¨build/deployè€Œä¸æ˜¯åœ¨deployæ—¶åˆ›å»ºåº”ç”¨ç¨‹åºå®¹å™¨ï¼Œä»è€Œå°†åº”ç”¨ç¨‹åºä¸åŸºç¡€æ¶æ„åˆ†ç¦»ã€‚ å¯è§‚å¯Ÿæ€§ä¸ä»…å¯ä»¥æ˜¾ç¤ºæ“ä½œç³»ç»Ÿçº§åˆ«çš„ä¿¡æ¯å’ŒæŒ‡æ ‡ï¼Œè¿˜å¯ä»¥æ˜¾ç¤ºåº”ç”¨ç¨‹åºå®¹å™¨çš„è¿è¡ŒçŠ¶å†µå’Œå…¶ä»–æŒ‡æ ‡ä¿¡æ¯ã€‚ èƒ½ä¿è¯å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§çš„ç¯å¢ƒä¸€è‡´æ€§ï¼šå³ä½¿åœ¨ä¾¿æºå¼çš„è®¡ç®—æœºä¸Šä¹Ÿèƒ½ä¸äº‘ä¸Šä¿æŒç›¸åŒåœ°è¿è¡Œã€‚ åº”ç”¨æœåŠ¡å¯ä»¥è¿è¡Œåœ¨ä»»ä½•æ”¯æŒå®¹å™¨å¼•æ“çš„å¹³å°ä¸Šã€‚ æ¾æ•£è€¦åˆã€åˆ†å¸ƒå¼ã€å¼¹æ€§ã€è§£æ”¾çš„å¾®æœåŠ¡ï¼šåº”ç”¨ç¨‹åºè¢«åˆ†è§£æˆè¾ƒå°çš„ç‹¬ç«‹éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€éƒ¨ç½²å’Œç®¡ç† - è€Œä¸æ˜¯åœ¨ä¸€å°å¤§å‹å•æœºä¸Šæ•´ä½“è¿è¡Œã€‚ èµ„æºéš”ç¦»ï¼šå¯é¢„æµ‹çš„åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚ èµ„æºåˆ©ç”¨ï¼šé«˜æ•ˆç‡å’Œé«˜å¯†åº¦ã€‚  ä¸ºä»€ä¹ˆéœ€è¦ Kubernetesï¼Œå®ƒèƒ½åšä»€ä¹ˆ? å®¹å™¨æ˜¯æ‰“åŒ…å’Œè¿è¡Œåº”ç”¨ç¨‹åºçš„æœ€å¥½çš„ä¸€ç§æ–¹å¼ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ‚¨éœ€è¦ç®¡ç†è¿è¡Œåº”ç”¨ç¨‹åºçš„å®¹å™¨ï¼Œå¹¶ç¡®ä¿ä¸ä¼šåœæœºã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå®¹å™¨å‘ç”Ÿæ•…éšœï¼Œåˆ™éœ€è¦å¯åŠ¨å¦ä¸€ä¸ªå®¹å™¨ã€‚å¦‚æœç³»ç»Ÿèƒ½å¤Ÿè‡ªåŠ¨çš„å¤„ç†è¿™ç§è¡Œä¸ºï¼Œä½ è§‰å¾—ä¼šä¸ä¼šæ˜¯æ›´æ–¹ä¾¿ã€‚\nè¿™å°±æ˜¯ Kubernetes çš„æ•‘æ´æ–¹æ³•ï¼Kubernetes ä¸ºæ‚¨æä¾›äº†ä¸€ä¸ªå¯å¼¹æ€§è¿è¡Œåˆ†å¸ƒå¼ç³»ç»Ÿçš„æ¡†æ¶ã€‚Kubernetes ä¼šæ»¡è¶³æ‚¨çš„æ‰©å±•è¦æ±‚ã€æ•…éšœè½¬ç§»ã€éƒ¨ç½²æ¨¡å¼ç­‰ã€‚ä¾‹å¦‚ï¼ŒKubernetes å¯ä»¥è½»æ¾åœ°å®ç°é‡‘ä¸é›€canaryå‘å¸ƒã€‚\n åŸºäºå®¹å™¨çš„åº”ç”¨éƒ¨ç½²ã€ç»´æŠ¤ã€æ»šåŠ¨å‡çº§: ä¸æ–­çš„å°†æœåŠ¡è¿è¡Œä¸ºæŒ‰ç…§ç”¨æˆ·å®šä¹‰æœåŠ¡è¿è¡Œçš„æœŸæœ›çŠ¶æ€ é€šè¿‡serviceèµ„æºå¯¹è±¡è‡ªå®ç°è´Ÿè½½å‡è¡¡å’ŒæœåŠ¡å‘ç°: å½“å‡ºç°æµé‡è´Ÿè½½çš„æ—¶å€™ï¼Œserviceä¼šå°†æµé‡æŒ‰ç…§ä¸€å®šçš„å‡è¡¡ç®—æ³•è°ƒåº¦åˆ°å¯¹åº”çš„èµ„æºç»„ å®ç°è·¨æœºå™¨å’Œè·¨åœ°åŸŸçš„é›†ç¾¤è°ƒåº¦: å¯ä»¥æŒ‰ç…§ç”¨æˆ·å®šä¹‰çš„èµ„æºè°ƒåº¦æ–¹å¼è¿›è¡Œè‡ªåŠ¨åŒ–çš„èµ„æºè°ƒåº¦ æ ¹æ®èµ„æºè´Ÿè½½æƒ…å†µå®ç°æœåŠ¡è‡ªåŠ¨ä¼¸ç¼©: è·å–æœåŠ¡è¿è¡Œè´Ÿè½½æŒ‡æ ‡ï¼Œé€šè¿‡HPAå®ç°æœåŠ¡çš„è‡ªåŠ¨æ‰©å®¹ä¸ä¼¸ç¼© å®ç°å¤šç§ç±»å‹æœåŠ¡è´Ÿè½½ï¼Œæ¯”å¦‚æœ‰çŠ¶æ€å’Œæ— çŠ¶æ€ç±»å‹æœåŠ¡: æ”¯æŒä¾‹å¦‚nginxã€filebeatç­‰è¿™ç§æ— çŠ¶æ€ä»¥åŠMYSQL,Mongodb,Elasticsearchç­‰æœ‰çŠ¶æ€çš„é›†ç¾¤æœåŠ¡ æ”¯æŒå¤šç§ç±»å‹çš„å­˜å‚¨æ’ä»¶ï¼Œæ¯”å¦‚s3,ceph,nfs,glusterfs\u0026hellip; æ’ä»¶æœºåˆ¶ä¿è¯æ‰©å±•æ€§ï¼šé€šè¿‡åœ¨ä¸ä¿®æ”¹æºä»£ç çš„æƒ…å†µä¸‹å¢åŠ ç±»ä¼¼å¦‚CNIã€CRIã€CSIã€Device Pluginã€CRDç­‰æ‰©å±•æ¥è§£å†³è¶Šæ¥è¶Šå¤šçš„ä¸ªæ€§åŒ–éœ€æ±‚ è‡ªèº«æœ‰å®‰å…¨é˜²æŠ¤å’Œèµ„æºçš„å‡†å…¥æœºåˆ¶ï¼šk8sçš„ä¸€å¥—å®‰å…¨ç­–ç•¥ï¼Œé€šè¿‡ç”¨æˆ·æˆ–ç»„ä¸k8sä¸Šä¸€äº›èµ„æºè§’è‰²ç»‘å®šä»è€Œå®ç°åœ¨å•ä¸€èŒƒå›´å†…æœ‰æƒé™æ‰§è¡ŒåŠ¨ä½œ å®ç°å¤šç§Ÿæˆ·åº”ç”¨çš„æ”¯æ’‘åŠ›:k8sæœ¬èº«å…·æœ‰å¤šå±‚èµ„æºéš”ç¦»çš„æ¡ä»¶ä¾‹å¦‚é›†ç¾¤æœ¬èº«ã€å‘½ä»¤ç©ºé—´ã€èŠ‚ç‚¹ã€podä¸å®¹å™¨ é€æ˜çš„æœåŠ¡æ³¨å†Œå’ŒæœåŠ¡å‘ç°æœºåˆ¶: é€šè¿‡k8sçš„serviceèµ„æºå¯¹è±¡ä¸labelèµ„æºå¯¹è±¡å®ç°åŸºæœ¬çš„æœåŠ¡æ³¨å†Œä¸å‘ç° è½»æ¾å®ç°æœåŠ¡ç‰ˆæœ¬è¿­ä»£å’Œé‡‘ä¸é›€å‘å¸ƒï¼šå› ä¸ºk8sæœ¬èº«çš„ç‰¹æ€§ï¼Œå®ç°canaryæ˜¾å¾—éå¸¸ç®€å• å®ç°æœåŠ¡åœ¨çº¿æ‰©å®¹èƒ½åŠ›: k8sé€šè¿‡è‡ªèº«çš„resizeåŠŸèƒ½ç»“åˆä¸€äº›å­˜å‚¨å·å®ç°ä¸ä¸¢å¤±åŸæ¥æ•°æ®çš„æƒ…å†µä¸‹è¿›è¡Œåœ¨çº¿æ‰©å®¹ å¤šç²’åº¦ç»†ç²’åº¦çš„å®ç°é…é¢ç®¡ç†èƒ½åŠ› æ”¯æŒè‡ªå®šä¹‰æ‰©å±•ï¼ˆæ ¸å¿ƒ+å¤–å›´æ‰©å±•ï¼‰API \u0026hellip;  Kubernetes ä¸æ˜¯ä»€ä¹ˆ Kubernetes ä¸æ˜¯ä¼ ç»Ÿçš„ã€åŒ…ç½—ä¸‡è±¡çš„ PaaSï¼ˆå¹³å°å³æœåŠ¡ï¼‰ç³»ç»Ÿã€‚ç”±äº Kubernetes åœ¨å®¹å™¨çº§åˆ«è€Œä¸æ˜¯åœ¨ç¡¬ä»¶çº§åˆ«è¿è¡Œï¼Œå› æ­¤å®ƒæä¾›äº† PaaS äº§å“å…±æœ‰çš„ä¸€äº›æ™®éé€‚ç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚éƒ¨ç½²ã€æ‰©å±•ã€è´Ÿè½½å‡è¡¡ã€æ—¥å¿—è®°å½•å’Œç›‘è§†ã€‚ä½†æ˜¯ï¼ŒKubernetes ä¸æ˜¯å•ä¸€çš„ï¼Œé»˜è®¤è§£å†³æ–¹æ¡ˆæ˜¯å¯é€‰å’Œå¯æ’æ‹”çš„ã€‚Kubernetes æä¾›äº†æ„å»ºå¼€å‘äººå‘˜å¹³å°çš„åŸºç¡€ï¼Œä½†æ˜¯åœ¨é‡è¦çš„åœ°æ–¹ä¿ç•™äº†ç”¨æˆ·çš„é€‰æ‹©å’Œçµæ´»æ€§ã€‚\nKubernetesï¼š\n  Kubernetes ä¸é™åˆ¶æ”¯æŒçš„åº”ç”¨ç¨‹åºç±»å‹ã€‚Kubernetes æ—¨åœ¨æ”¯æŒæå…¶å¤šç§å¤šæ ·çš„å·¥ä½œè´Ÿè½½ï¼ŒåŒ…æ‹¬æ— çŠ¶æ€ã€æœ‰çŠ¶æ€å’Œæ•°æ®å¤„ç†å·¥ä½œè´Ÿè½½ã€‚å¦‚æœåº”ç”¨ç¨‹åºå¯ä»¥åœ¨å®¹å™¨ä¸­è¿è¡Œï¼Œé‚£ä¹ˆå®ƒåº”è¯¥å¯ä»¥åœ¨ Kubernetes ä¸Šå¾ˆå¥½åœ°è¿è¡Œã€‚\n  Kubernetes ä¸éƒ¨ç½²æºä»£ç ï¼Œä¹Ÿä¸æ„å»ºæ‚¨çš„åº”ç”¨ç¨‹åºã€‚æŒç»­é›†æˆ(CI)ã€äº¤ä»˜å’Œéƒ¨ç½²ï¼ˆCI/CDï¼‰å·¥ä½œæµå–å†³äºç»„ç»‡çš„æ–‡åŒ–å’Œåå¥½ä»¥åŠæŠ€æœ¯è¦æ±‚ã€‚\n  Kubernetes ä¸æä¾›åº”ç”¨ç¨‹åºçº§åˆ«çš„æœåŠ¡ä½œä¸ºå†…ç½®æœåŠ¡ï¼Œä¾‹å¦‚ä¸­é—´ä»¶æ¶ˆæ¯ä¸­é—´ä»¶ã€æ•°æ®å¤„ç†æ¡†æ¶Sparkã€æ•°æ®åº“mysqlã€ç¼“å­˜ã€é›†ç¾¤å­˜å‚¨ç³»ç»ŸCephã€‚è¿™æ ·çš„ç»„ä»¶å¯ä»¥åœ¨ Kubernetes ä¸Šè¿è¡Œï¼Œå¹¶ä¸”/æˆ–è€…å¯ä»¥ç”±è¿è¡Œåœ¨ Kubernetes ä¸Šçš„åº”ç”¨ç¨‹åºé€šè¿‡å¯ç§»æ¤æœºåˆ¶å¼€æ”¾æœåŠ¡ä»£ç†æ¥è®¿é—®ã€‚\n  Kubernetes ä¸æä¾›æ—¥å¿—è®°å½•ã€ç›‘æ§æˆ–è­¦æŠ¥è§£å†³æ–¹æ¡ˆã€‚å®ƒæä¾›äº†ä¸€äº›é›†æˆä½œä¸ºæ¦‚å¿µè¯æ˜ï¼Œå¹¶æä¾›äº†æ”¶é›†å’Œå¯¼å‡ºæŒ‡æ ‡çš„æœºåˆ¶ã€‚\n  Kubernetes ä¸æä¾›æˆ–ä¸è¦æ±‚é…ç½®è¯­è¨€/ç³»ç»Ÿï¼ˆä¾‹å¦‚ jsonnetï¼‰ï¼Œå®ƒæä¾›äº†å£°æ˜æ€§ APIï¼Œè¯¥å£°æ˜æ€§ API å¯ä»¥ç”±ä»»æ„å½¢å¼çš„å£°æ˜æ€§è§„èŒƒæ‰€æ„æˆã€‚\n  Kubernetes ä¸æä¾›ä¹Ÿä¸é‡‡ç”¨ä»»ä½•å…¨é¢çš„æœºå™¨é…ç½®ã€ç»´æŠ¤ã€ç®¡ç†æˆ–è‡ªæˆ‘ä¿®å¤ç³»ç»Ÿã€‚\n  æ­¤å¤–ï¼ŒKubernetes ä¸ä»…ä»…æ˜¯ä¸€ä¸ªç¼–æ’ç³»ç»Ÿï¼Œå®é™…ä¸Šå®ƒæ¶ˆé™¤äº†ç¼–æ’çš„éœ€è¦ã€‚ç¼–æ’çš„æŠ€æœ¯å®šä¹‰æ˜¯æ‰§è¡Œå·²å®šä¹‰çš„å·¥ä½œæµç¨‹ï¼šé¦–å…ˆæ‰§è¡Œ Aï¼Œç„¶åæ‰§è¡Œ Bï¼Œå†æ‰§è¡Œ Cã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒKubernetes åŒ…å«ä¸€ç»„ç‹¬ç«‹çš„ã€å¯ç»„åˆçš„æ§åˆ¶è¿‡ç¨‹ï¼Œè¿™äº›è¿‡ç¨‹è¿ç»­åœ°å°†å½“å‰çŠ¶æ€é©±åŠ¨åˆ°æ‰€æä¾›çš„æ‰€éœ€çŠ¶æ€ã€‚ä» A åˆ° C çš„æ–¹å¼æ— å…³ç´§è¦ï¼Œä¹Ÿä¸éœ€è¦é›†ä¸­æ§åˆ¶ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿæ›´æ˜“äºä½¿ç”¨ä¸”åŠŸèƒ½æ›´å¼ºå¤§ã€å¥å£®ã€å¼¹æ€§å’Œå¯æ‰©å±•æ€§ã€‚\n  æ”¯æŒçš„äº‘å‚å•†  åä¸ºäº‘CCE é˜¿é‡Œäº‘ACK è…¾è®¯äº‘TKE è°·æ­Œäº‘GCE  ","description":"","id":51,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/kubernetes%E4%B8%93%E8%BE%91-01kubernetes%E6%98%AF%E4%BB%80%E4%B9%88/"},{"content":"kubernetesä¸“è¾‘-02kubernetesç‚¼æ°”æœŸä¹‹å¹³å°æ­å»º ç¯å¢ƒè¯´æ˜    åŠŸèƒ½åç§° IP é…ç½®     k8s-master 192.168.10.231 4c8g   k8s-node1 192.168.10.232 8c16g   K8s-node2 192.168.10.233 8c16g   k8s-node3 192.168.10.234 8c16g   k8s-node4 192.168.10.235 8c16g    ç¯å¢ƒåˆå§‹åŒ–  æ›´æ–°ç¯å¢ƒ  1 2  yum update -y yum install -y wget vim net-tools epel-release   å…³é—­filewalld  1 2  systemctl disable firewalld systemctl stop firewalld   å…³é—­selinux  1 2 3 4 5 6 7  sed -i \u0026#34;s/SELINUX=enforcing/SELINUX=disabled/g\u0026#34; /etc/selinux/config sed -i \u0026#34;s/SELINUX=enforcing/SELINUX=disabled/g\u0026#34; /etc/sysconfig/selinux if [ `getenforce` == \u0026#34;Enforcing\u0026#34; ];then setenforce 0 else echo \u0026#34;current selinux status...\u0026#34; `getenforce` fi   å…³é—­swap  1 2  swapoff -a sed -i \u0026#39;s/.*swap.*/#\u0026amp;/\u0026#39; /etc/fstab   å¢åŠ ä¸»æœºåè§£æ  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  cat \u0026lt;\u0026lt; EOF /etc/host 192.168.10.231 dev-k8s-01.example.com 192.168.10.232 dev-k8s-02.example.com 192.168.10.233 dev-k8s-03.example.com 192.168.10.234 dev-k8s-04.example.com 192.168.10.235 dev-k8s-05.example.com EOF 6. ä¼˜åŒ–å†…æ ¸å‚æ•° â€‹```bash cat \u0026lt;\u0026lt; EOF \u0026gt;\u0026gt; /etc/sysctl.d/k8s.conf net.bridge.bridge-nf-call-ip6tables = 1 net.bridge.bridge-nf-call-iptables = 1 EOF sysctl --system   æ›´æ–°Yumæºé…ç½®  1 2 3 4 5 6 7 8 9 10 11 12 13  mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.`date +%F`.backup wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo yum makecache fast cat \u0026lt;\u0026lt; EOF /etc/yum.repos.d/kubernetes.repo [kubernetes] name=Kubernetes baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64 enabled=1 gpgcheck=0 EOF yum clean all yum makecache fast yum -y update   å®‰è£…docker  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19  yum -y install yum-utils device-mapper-persistent-data lvm2 yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo yum install -y docker-ce-18.09.9-3.el7 mkdir /etc/docker -pv cat \u0026gt; /etc/docker/daemon.json \u0026lt;\u0026lt; EOF { \u0026#34;registry-mirrors\u0026#34;: [\u0026#34;https://********.mirror.aliyuncs.com\u0026#34;], \u0026#34;exec-opts\u0026#34;: [\u0026#34;native.cgroupdriver=systemd\u0026#34;], \u0026#34;log-driver\u0026#34;: \u0026#34;json-file\u0026#34;, \u0026#34;log-opts\u0026#34;: { \u0026#34;max-size\u0026#34;: \u0026#34;100m\u0026#34; }, \u0026#34;storage-driver\u0026#34;: \u0026#34;overlay2\u0026#34;, \u0026#34;storage-opts\u0026#34;: [ \u0026#34;overlay2.override_kernel_check=true\u0026#34; ] } EOF systemctl enable --now docker.service   å®‰è£…åˆå§‹åŒ–å·¥å…·  1  yum install -y kubeadm kubelet   è·å–åŸºç¡€é•œåƒ  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18  KUBE_VERSION=v1.16.0 KUBE_PAUSE_VERSION=3.1 ETCD_VERSION=3.3.15-0 CORE_DNS_VERSION=1.6.2 GCR_URL=k8s.gcr.io ALIYUN_URL=registry.cn-hangzhou.aliyuncs.com/google_containers images=(kube-proxy:${KUBE_VERSION} kube-scheduler:${KUBE_VERSION} kube-controller-manager:${KUBE_VERSION} kube-apiserver:${KUBE_VERSION} pause:${KUBE_PAUSE_VERSION} etcd:${ETCD_VERSION} coredns:${CORE_DNS_VERSION}) for imageName in ${images[@]} ; do docker pull $ALIYUN_URL/$imageName docker tag $ALIYUN_URL/$imageName $GCR_URL/$imageName docker rmi $ALIYUN_URL/$imageName done   ä»¥ä¸Š10éƒ¨å»ºè®®åœ¨æ‰€æœ‰çš„èŠ‚ç‚¹ä¸Šå®‰è£…,åœ¨nodeèŠ‚ç‚¹ä¸Šå¯ä»¥ä¸ç”¨å®‰è£…kubeadm\néƒ¨ç½²é›†ç¾¤ kubeadmåˆå§‹åŒ–é›†ç¾¤ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71  [root@dev-k8s-01 ~]# sudo kubeadm init \\ \u0026gt; --apiserver-advertise-address 192.168.10.231 \\ \u0026gt; --kubernetes-version=v1.16.0 \\ \u0026gt; --pod-network-cidr=10.244.0.0/16 [init] Using Kubernetes version: v1.16.0 [preflight] Running pre-flight checks [WARNING Service-Kubelet]: kubelet service is not enabled, please run \u0026#39;systemctl enable kubelet.service\u0026#39; [preflight] Pulling images required for setting up a Kubernetes cluster [preflight] This might take a minute or two, depending on the speed of your internet connection [preflight] You can also perform this action in beforehand using \u0026#39;kubeadm config images pull\u0026#39; [kubelet-start] Writing kubelet environment file with flags to file \u0026#34;/var/lib/kubelet/kubeadm-flags.env\u0026#34; [kubelet-start] Writing kubelet configuration to file \u0026#34;/var/lib/kubelet/config.yaml\u0026#34; [kubelet-start] Activating the kubelet service [certs] Using certificateDir folder \u0026#34;/etc/kubernetes/pki\u0026#34; [certs] Generating \u0026#34;ca\u0026#34; certificate and key [certs] Generating \u0026#34;apiserver\u0026#34; certificate and key [certs] apiserver serving cert is signed for DNS names [dev-k8s-01.example.com kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local] and IPs [10.96.0.1 192.168.10.231] [certs] Generating \u0026#34;apiserver-kubelet-client\u0026#34; certificate and key [certs] Generating \u0026#34;front-proxy-ca\u0026#34; certificate and key [certs] Generating \u0026#34;front-proxy-client\u0026#34; certificate and key [certs] Generating \u0026#34;etcd/ca\u0026#34; certificate and key [certs] Generating \u0026#34;etcd/server\u0026#34; certificate and key [certs] etcd/server serving cert is signed for DNS names [dev-k8s-01.example.com localhost] and IPs [192.168.10.231 127.0.0.1 ::1] [certs] Generating \u0026#34;etcd/peer\u0026#34; certificate and key [certs] etcd/peer serving cert is signed for DNS names [dev-k8s-01.example.com localhost] and IPs [192.168.10.231 127.0.0.1 ::1] [certs] Generating \u0026#34;etcd/healthcheck-client\u0026#34; certificate and key [certs] Generating \u0026#34;apiserver-etcd-client\u0026#34; certificate and key [certs] Generating \u0026#34;sa\u0026#34; key and public key [kubeconfig] Using kubeconfig folder \u0026#34;/etc/kubernetes\u0026#34; [kubeconfig] Writing \u0026#34;admin.conf\u0026#34; kubeconfig file [kubeconfig] Writing \u0026#34;kubelet.conf\u0026#34; kubeconfig file [kubeconfig] Writing \u0026#34;controller-manager.conf\u0026#34; kubeconfig file [kubeconfig] Writing \u0026#34;scheduler.conf\u0026#34; kubeconfig file [control-plane] Using manifest folder \u0026#34;/etc/kubernetes/manifests\u0026#34; [control-plane] Creating static Pod manifest for \u0026#34;kube-apiserver\u0026#34; [control-plane] Creating static Pod manifest for \u0026#34;kube-controller-manager\u0026#34; [control-plane] Creating static Pod manifest for \u0026#34;kube-scheduler\u0026#34; [etcd] Creating static Pod manifest for local etcd in \u0026#34;/etc/kubernetes/manifests\u0026#34; [wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory \u0026#34;/etc/kubernetes/manifests\u0026#34;. This can take up to 4m0s [apiclient] All control plane components are healthy after 39.003840 seconds [upload-config] Storing the configuration used in ConfigMap \u0026#34;kubeadm-config\u0026#34; in the \u0026#34;kube-system\u0026#34; Namespace [kubelet] Creating a ConfigMap \u0026#34;kubelet-config-1.16\u0026#34; in namespace kube-system with the configuration for the kubelets in the cluster [upload-certs] Skipping phase. Please see --upload-certs [mark-control-plane] Marking the node dev-k8s-01.example.com as control-plane by adding the label \u0026#34;node-role.kubernetes.io/master=\u0026#39;\u0026#39;\u0026#34; [mark-control-plane] Marking the node dev-k8s-01.example.com as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule] [kubelet-check] Initial timeout of 40s passed. [bootstrap-token] Using token: 9nwjok.ykyphybsveka8gev [bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles [bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials [bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token [bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster [bootstrap-token] Creating the \u0026#34;cluster-info\u0026#34; ConfigMap in the \u0026#34;kube-public\u0026#34; namespace [addons] Applied essential addon: CoreDNS [addons] Applied essential addon: kube-proxy Your Kubernetes control-plane has initialized successfully! To start using your cluster, you need to run the following as a regular user: mkdir -p $HOME/.kube sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config sudo chown $(id -u):$(id -g) $HOME/.kube/config You should now deploy a pod network to the cluster. Run \u0026#34;kubectl apply -f [podnetwork].yaml\u0026#34; with one of the options listed at: https://kubernetes.io/docs/concepts/cluster-administration/addons/ Then you can join any number of worker nodes by running the following on each as root: kubeadm join 192.168.10.231:6443 --token 9nwjok.ykyphybsveka8gev \\  --discovery-token-ca-cert-hash sha256:b92d7553a1da683a315ad2f4f5fcc855e2d630da0c7553467cdf2db3bd25a3ff   åˆå§‹åŒ–kubectlé…ç½®æ–‡ä»¶ 1 2 3  [root@dev-k8s-01 ~]# mkdir -p $HOME/.kube [root@dev-k8s-01 ~]# sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config [root@dev-k8s-01 ~]# sudo chown $(id -u):$(id -g) $HOME/.kube/config   æ·»åŠ èŠ‚ç‚¹  æ·»åŠ 192.168.10.232  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21  [root@dev-k8s-05 ~]# kubeadm join 192.168.10.231:6443 --token 9pr3rj.0u8m510fai0op75h \\ --discovery-token-ca-cert-hash sha256:b86bdaaa0bed56e846adb0abc625cf29902dec9e3130d0ff7dae42ffb2e13349 [preflight] Running pre-flight checks [WARNING Service-Kubelet]: kubelet service is not enabled, please run \u0026#39;systemctl enable kubelet.service\u0026#39; [preflight] Reading configuration from the cluster... [preflight] FYI: You can look at this config file with \u0026#39;kubectl -n kube-system get cm kubeadm-config -oyaml\u0026#39; [kubelet-start] Downloading configuration for the kubelet from the \u0026#34;kubelet-config-1.16\u0026#34; ConfigMap in the kube-system namespace [kubelet-start] Writing kubelet configuration to file \u0026#34;/var/lib/kubelet/config.yaml\u0026#34; [kubelet-start] Writing kubelet environment file with flags to file \u0026#34;/var/lib/kubelet/kubeadm-flags.env\u0026#34; [kubelet-start] Activating the kubelet service [kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap... This node has joined the cluster: * Certificate signing request was sent to apiserver and a response was received. * The Kubelet was informed of the new secure connection details. Run \u0026#39;kubectl get nodes\u0026#39; on the control-plane to see this node join the cluster. [root@dev-k8s-05 ~]# systemctl enable kubelet.service Created symlink from /etc/systemd/system/multi-user.target.wants/kubelet.service to /usr/lib/systemd/system/kubelet.service. [root@dev-k8s-05 ~]#   å¦‚ä¸Šæ‰€ç¤ºä¾æ—§æ·»åŠ 192.168.10.233èŠ‚ç‚¹\néªŒè¯é›†ç¾¤çŠ¶æ€ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26  [root@dev-k8s-01 ~]# kubectl cluster-info Kubernetes master is running at https://192.168.10.231:6443 KubeDNS is running at https://192.168.10.231:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy To further debug and diagnose cluster problems, use \u0026#39;kubectl cluster-info dump\u0026#39;. âœ ~ (â˜¸ kubernetes-admin@kubernetes:default) kubectl get nodes -o wide NAME STATUS ROLES AGE VERSION INTERNAL-IP EXTERNAL-IP OS-IMAGE KERNEL-VERSION CONTAINER-RUNTIME dev-k8s-01.example.com Ready master 14h v1.16.3 192.168.10.231 \u0026lt;none\u0026gt; CentOS Linux 7 (Core) 3.10.0-957.21.3.el7.x86_64 docker://18.9.9 dev-k8s-02.example.com Ready \u0026lt;none\u0026gt; 14h v1.16.3 192.168.10.232 \u0026lt;none\u0026gt; CentOS Linux 7 (Core) 3.10.0-957.21.3.el7.x86_64 docker://18.9.9 dev-k8s-03.example.com Ready \u0026lt;none\u0026gt; 14h v1.16.3 192.168.10.233 \u0026lt;none\u0026gt; CentOS Linux 7 (Core) 3.10.0-957.21.3.el7.x86_64 docker://18.9.9 dev-k8s-04.example.com Ready \u0026lt;none\u0026gt; 14h v1.16.3 192.168.10.234 \u0026lt;none\u0026gt; CentOS Linux 7 (Core) 3.10.0-1062.4.1.el7.x86_64 docker://18.9.9 dev-k8s-05.example.com Ready \u0026lt;none\u0026gt; 13h v1.16.3 192.168.10.235 \u0026lt;none\u0026gt; CentOS Linux 7 (Core) 3.10.0-957.el7.x86_64 docker://18.9.9 âœ ~ (â˜¸ kubernetes-admin@kubernetes:default) kubectl get pods --all-namespaces -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES kube-system coredns-5644d7b6d9-96xm6 1/1 Running 0 14h 10.244.3.2 dev-k8s-04.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system coredns-5644d7b6d9-nkb9f 1/1 Running 0 14h 10.244.1.2 dev-k8s-02.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system etcd-dev-k8s-01.example.com 1/1 Running 0 14h 192.168.10.231 dev-k8s-01.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-apiserver-dev-k8s-01.example.com 1/1 Running 0 14h 192.168.10.231 dev-k8s-01.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-controller-manager-dev-k8s-01.example.com 1/1 Running 0 14h 192.168.10.231 dev-k8s-01.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-proxy-bhtjc 1/1 Running 0 14h 192.168.10.232 dev-k8s-02.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-proxy-h2ltx 1/1 Running 0 14h 192.168.10.231 dev-k8s-01.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-proxy-kh9k9 1/1 Running 0 14h 192.168.10.234 dev-k8s-04.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-proxy-lfh46 1/1 Running 0 14h 192.168.10.233 dev-k8s-03.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-proxy-pcm5d 1/1 Running 0 13h 192.168.10.235 dev-k8s-05.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-scheduler-dev-k8s-01.example.com 1/1 Running 0 14h 192.168.10.231 dev-k8s-01.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt;   å®‰è£…æ’ä»¶ å®‰è£…flannelç½‘ç»œæ’ä»¶ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  wget -O /opt/k8sworkspces/kube-flannel.yml https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml FLANNEL_VERSION=v0.11.0 QUAY_URL=quay.io/coreos QINIU_URL=quay-mirror.qiniu.com/coreos images=(flannel:${FLANNEL_VERSION}-amd64 flannel:${FLANNEL_VERSION}-arm64 flannel:${FLANNEL_VERSION}-arm flannel:${FLANNEL_VERSION}-ppc64le flannel:${FLANNEL_VERSION}-s390x) for imageName in ${images[@]} ; do docker pull $QINIU_URL/$imageName docker tag $QINIU_URL/$imageName $QUAY_URL/$imageName docker rmi $QINIU_URL/$imageName done # ä¹Ÿå¯ä»¥åªæ‹‰å»ä½ æœºå™¨é€‚é…çš„æ¶æ„ç‰ˆæœ¬`rpm -q centos-release` kubectl apply -f /opt/k8sworkspces/kube-flannel.yml #å®‰è£…flannel âœ ~ (â˜¸ kubernetes-admin@kubernetes:default) kubectl get pods --all-namespaces -o wide | grep flannel kube-system kube-flannel-ds-amd64-9tnc7 1/1 Running 0 14h 192.168.10.234 dev-k8s-04.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-flannel-ds-amd64-cjh4s 1/1 Running 0 14h 192.168.10.231 dev-k8s-01.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-flannel-ds-amd64-fhlk4 1/1 Running 0 13h 192.168.10.235 dev-k8s-05.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-flannel-ds-amd64-fnfpj 1/1 Running 0 14h 192.168.10.233 dev-k8s-03.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system kube-flannel-ds-amd64-v5qtj 1/1 Running 0 14h 192.168.10.232 dev-k8s-02.example.com \u0026lt;none\u0026gt; \u0026lt;none\u0026gt;   krew krew èƒ½å¤Ÿå¾ˆæ–¹ä¾¿çš„ç®¡ç†kubectlçš„æ’ä»¶åŒ…,åŒ…æ‹¬å®‰è£…å¸è½½ï¼ŒæŸ¥è¯¢å‡çº§\nå®‰è£… 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31  ( set -x; cd /opt/k8sworkspces/krew \u0026amp;\u0026amp; curl -fsSLO \u0026#34;https://github.com/kubernetes-sigs/krew/releases/download/v0.3.2/krew.{tar.gz,yaml}\u0026#34; \u0026amp;\u0026amp; tar zxvf krew.tar.gz \u0026amp;\u0026amp; ./krew-\u0026#34;$(uname | tr \u0026#39;[:upper:]\u0026#39; \u0026#39;[:lower:]\u0026#39;)_amd64\u0026#34; install \\  --manifest=krew.yaml --archive=krew.tar.gz ) export PATH=\u0026#34;${KREW_ROOT:-$HOME/.krew}/bin:$PATH\u0026#34; [root@dev-k8s-01 krew]# kubectl krew install ca-cert # å®‰è£…ä¸€ä¸ªca-caertçš„æ’ä»¶ [root@dev-k8s-01 krew]# kubectl ca-cert -----BEGIN CERTIFICATE----- MIICyDCCAbCgAwIBAgIBADANBgkqhkiG9w0BAQsFADAVMRMwEQYDVQQDEwprdWJl cm5ldGVzMB4XDTE5MTExNTA0MjEzOVoXDTI5MTExMjA0MjEzOVowFTETMBEGA1UE AxMKa3ViZXJuZXRlczCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANEi tPdWINQZfZqM4c/uaOzsBBByn0CLLLmMdiKF4Gpk9proDoR9eOMhQiiVLZ4tFFsb POTwq+MvHe4kEsunl/hBwNbXvGfbvnr+vX9ZsDfU5FT5O55Zryq5jgANDKFChKx9 R91QsbCeQKIWlc9AFdot8ig9LhYTfHJRfMeUBYl5Xzoof8YRMsJ0jOKLWca+oCfd doLKda9VpahU2AEmEFHuD6ctwBGFObadSktoOvr0Gfzo4cXRkjGXp4G1U8O1LLsU HiypNN4m7Romy4tIjPAxDAoDDyjA8OrbPlvJt8Oo0CHcAxFZDJCsKAG1s0nS7PJj vR2ULtIrHAm5QZa8BmMCAwEAAaMjMCEwDgYDVR0PAQH/BAQDAgKkMA8GA1UdEwEB /wQFMAMBAf8wDQYJKoZIhvcNAQELBQADggEBAKAi1Fg/2MlFxPbq9yaNkBhAV2ou /VbbuEJF1c92Tk24cuJV3vuYoTmWIGp1LYTLTW/xcfwFoanLRPBlBONoJRzXLIZD /mmuYMrTaKMwbCz2t4awqQyDb8A3RcgTrSfCWMs0uyvjPVgiJDfMlg0WDJ4kPb3Y SQv7UaaNa57gkEHB1PJy10n1E3gAcb6NVxvly7cHVaJlenZY6mkT40K8zVOXuM/G ausCNXEfEUXED2C8Ippj/sr1TgRlD8Gfi+Xp7XzHTeu5A+ac4YPmnoW8jurzo5z5 Q5TDBFRaOTyRgUxYt+PKv01S9tTiHgkxHoBzPQF7Z2TuRNKXoVQeXiUzW/s= -----END CERTIFICATE----- [root@dev-k8s-01 krew]# kubectl krew --help #æŸ¥çœ‹krewçš„æ”¯æŒé€‰é¡¹   ","description":"","id":52,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/kubernetes%E4%B8%93%E8%BE%91-02kubernetes%E7%82%BC%E6%B0%94%E6%9C%9F%E4%B9%8B%E5%B9%B3%E5%8F%B0%E6%90%AD%E5%BB%BA/"},{"content":"k8sæ‰€æœ‰çš„é…ç½®æ–‡ä»¶ä»¥åŠèµ„æºçš„å®šä¹‰é…ç½®æ–‡ä»¶éƒ½æ˜¯åŸºäºYAMLæ ¼å¼çš„\nYAMLçš„è®¾è®¡ç›®æ ‡ ä½¿ç”¨ YAML æ–‡ä»¶çš„ä¼˜ç‚¹ï¼š\n YAML æ–‡ä»¶å¯è¯»æ€§è¾ƒé«˜ï¼Œæ˜“äºå®ç°å’Œä½¿ç”¨ã€‚ å¯åœ¨ç°æœ‰çš„æ‰€æœ‰ç¼–ç¨‹è¯­è¨€ä¹‹é—´è½»æ¾ç§»æ¤ã€‚ ä¸æ•æ·è¯­è¨€çš„åŸç”Ÿæ•°æ®ç»“æ„ç›¸åŒ¹é…ã€‚ YAML æ–‡ä»¶å…·æœ‰ä¸€è‡´æ¨¡å‹ï¼Œæ”¯æŒé€šç”¨å·¥å…·ã€‚ YAML æ–‡ä»¶æ”¯æŒ One-pass å¤„ç†ã€‚ ä½¿ç”¨æ–¹ä¾¿ï¼Œå› æ­¤æ‚¨æ— éœ€å†å°†æ‰€æœ‰çš„å‚æ•°æ·»åŠ åˆ°å‘½ä»¤è¡Œä¸­ã€‚ æ˜“äºç»´æŠ¤ â€“ å¯ä»¥å°† YAML æ–‡ä»¶æ·»åŠ åˆ°æºæ§ä»¶ä¸­ä»¥è·Ÿè¸ªæ›´æ”¹ã€‚ çµæ´»ä¾¿æ· â€“ å¯ä»¥ä½¿ç”¨ YAML åˆ›å»ºæ›´åŠ å¤æ‚çš„ç»“æ„ï¼ˆç›¸å¯¹äºä½¿ç”¨å‘½ä»¤è¡Œå¯ä»¥åˆ›å»ºçš„ç»“æ„ï¼‰  YAMLå¯ä»¥ç”¨æ¥åšä»€ä¹ˆ  å½“æ•°æ®èƒ½å¤Ÿå®¹æ˜“çš„è¢«è¯»æ‡‚çš„æ—¶å€™ï¼Œä»»ä½•äº‹æƒ…éƒ½ä¼šå˜å¾—ç®€å•ã€‚\n  é…ç½®æ–‡ä»¶configuration files æ—¥å¿—æ–‡ä»¶log files è¿›ç¨‹é—´æ¶ˆæ¯ä¼ é€’interprocess messaging è·¨è¯­è¨€æ•°æ®å…±äº«cross-language data sharing å¯¹è±¡æŒä¹…æ€§object persistence å¤æ‚æ•°æ®ç»“æ„debugging of complex data structures  ä¸ JSON å’Œ XML çš„å…³ç³»   XML æ˜¯è®¸å¤šé¢†åŸŸçš„ä¼˜å…ˆé‡‡ç”¨æ ¼å¼ã€‚XML æœ€åˆè®¾è®¡ä¸ºä¸æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ (SGML) å‘åå…¼å®¹ï¼Œåè€…æ—¨åœ¨æ”¯æŒç»“æ„åŒ–æ–‡æ¡£ã€‚å› æ­¤ï¼ŒXML å­˜åœ¨è®¸å¤šè®¾è®¡ä¸Šçš„çº¦æŸã€‚\n  JSON çš„è®¾è®¡ç†å¿µæ˜¯ç®€å•æ€§å’Œé€šç”¨æ€§ï¼Œå¹¶ä¸”æ˜“äºç”Ÿæˆå’Œè§£æã€‚JSON æ ¼å¼çš„å¯è¯»æ€§ä½ï¼Œä½†æ˜¯è¿™ç§æ ¼å¼çš„æ•°æ®æ¯ä¸€ç§ç°ä»£ç¼–ç¨‹ç¯å¢ƒéƒ½å¯ä»¥è½»æ¾å¤„ç†ã€‚\n  YAML çš„è®¾è®¡ç›®æ ‡æ˜¯æå‡å¯è¯»æ€§ï¼Œæä¾›æ›´åŠ å®Œå–„çš„ä¿¡æ¯æ¨¡å‹ã€‚YAML çš„ç”Ÿæˆå’Œè§£ææ›´åŠ å¤æ‚ï¼Œå› æ­¤å¯ä»¥å°†å…¶è§†ä¸º JSON çš„è‡ªç„¶è¶…é›†ã€‚æ¯ä¸ª JSON æ–‡ä»¶éƒ½æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ YAML æ–‡ä»¶ã€‚\n  åœ¨éœ€è¦é¢å¤–åŠŸèƒ½çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥è½»æ¾åœ°ä» JSON è¿ç§»åˆ° YAMLã€‚YAML æ˜¯ä» XML è¡ç”Ÿè€Œæ¥ã€‚\nyamlå·¥å…·   åœ¨çº¿yamlæ ¼å¼æ ¡éªŒ\n  å‘½ä»¤è¡Œæ ¡éªŒ\n1  python -c \u0026#39;import yaml, sys; yaml.safe_load(sys.stdin)\u0026#39; \u0026lt; cfg.yaml     Yamlé«˜äº®æ˜¾ç¤º\n  åœ¨çº¿è·å–yamlçš„å€¼: shyaml\n  ","description":"","id":53,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/kubernetes%E4%B8%93%E8%BE%91-03kubernetes%E5%AE%9A%E4%B9%89%E6%B8%85%E5%8D%95yaml%E6%96%87%E4%BB%B6/"},{"content":"Nginxç¼–è¯‘å®‰è£…çš„å‰æœŸå‡†å¤‡ Nginxçš„ç¼–è¯‘å®‰è£…ä¸€èˆ¬ç”¨äºéœ€è¦åŠ å…¥ä¸€äº›æ‰©å±•çš„ç¬¬ä¸‰æ–¹æ¨¡å—æˆ–è€…è‡ªç ”å‘çš„æ‰©å±•åŠŸèƒ½åŒ…ï¼Œæ‰€ä»¥åœ¨ç¼–è¯‘ä¹‹å‰éœ€è¦æå‰ä¸‹è½½å‡†å¤‡å¥½è¿™äº›æ‰©å±•çš„åŒ…æ–‡ä»¶ï¼Œæ¯”å¦‚æˆ‘ä»¬ç¼–è¯‘çš„æ—¶å€™å¢åŠ éœ€è¦ä½¿ç”¨jemallocä¼˜åŒ–nginxå†…å­˜ï¼Œä½¿ç”¨opensslå®ç°nginxçš„httpsæ•°æ®åŠ å¯†ï¼Œä½¿ç”¨zlibåº“æ‰©å±•nginxå‹ç¼©çš„åŠŸèƒ½ç­‰ï¼Œä¸‹é¢æˆ‘ä»¬ä¸‹è½½ä¸€äº›æˆ‘ä»¬éœ€è¦çš„åŸºç¡€ä¾èµ–åº“çš„åŒ…æ–‡ä»¶:\n1 2 3 4 5 6 7 8 9 10 11 12 13  cd /usr/local/src wget http://nginx.org/download/nginx-1.14.2.tar.gz wget http://nginx.org/download/nginx-1.10.3.tar.gz wget https://www.zlib.net/fossils/zlib-1.2.8.tar.gz wget https://openssl.org/source/openssl-1.0.2d.tar.gz wget https://github.com/simplresty/ngx_devel_kit/archive/v0.3.0.tar.gz -O ngx_devel_kit.tar.gz wget https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2 wget https://github.com/yaoweibin/nginx_upstream_check_module/archive/v0.3.0.tar.gz -O nginx_upstream_check_module.tar.gz wget https://github.com/openresty/lua-nginx-module/archive/v0.10.10.tar.gz -O lua-nginx-module.tar.gz tar xf jemalloc-4.5.0.tar.bz2 cd jemalloc-4.5.0 \u0026amp;\u0026amp; ./configure \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install apt-get install -y lua5.1-0-dev sudo apt-get install libpcre3 libpcre3-dev # support pcre   jemallocçš„å®‰è£…ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨aptå®‰è£…\n1  apt-get install -y libjemalloc-dev   å¦‚æœåœ¨ç¼–è¯‘çš„è¿‡ç¨‹ä¸­å‡ºç°ä¸€äº›ä¸‹é¢ç±»ä¼¼çš„é”™è¯¯ï¼Œå¯ä»¥é€šè¿‡å®‰è£…å¼€å‘è€…å·¥å…·åŒ…è§£å†³è¿™ä¸ªé—®é¢˜:\n1 2 3 4 5 6 7  checking for xsltproc... false checking for gcc... no checking for cc... no checking for cl.exe... no # ubuntuä¸Šå®‰è£…å¼€å‘è€…å·¥å…·åŒ… sudo apt install build-essential -y   ç¼–è¯‘å®‰è£…Nginx1.18.0 é¦–å…ˆæˆ‘ä»¬å‡†å¤‡ä¸€ä¸ªnginxçš„è¿è¡Œç”¨æˆ·www\n1 2 3  groupadd www \u0026amp;\u0026amp; useradd www -g www # å¼€å§‹ç¼–è¯‘nginx ./configure --prefix=/webserver/nginx18 --user=www --group=www --with-pcre --with-zlib=/root/workspace/packages/nginx/zlib-1.2.8 --with-openssl=/root/workspace/packages/nginx/openssl-1.0.2d --with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --add-module=/root/workspace/packages/nginx/ngx_devel_kit-0.3.0 --with-ld-opt=-ljemalloc --with-stream --with-http_ssl_module --add-module=/root/workspace/packages/nginx/nginx_upstream_check_module-0.3.0 \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install   ç¼–è¯‘å®Œæˆåï¼Œåœ¨å¯åŠ¨nginx\n1 2 3 4 5 6 7 8 9 10  /webserver/nginx18/sbin/nginx # ç„¶åæˆ‘ä»¬å°†nginxçš„workè¿›ç¨‹è®¾ç½®ä¸º2ä¸ªï¼Œä¿®æ”¹ç”¨æˆ·ä¸ºwww root@master:/webserver/nginx18/sbin# ps -fe |grep nginx root 50131 1 0 08:43 ? 00:00:00 nginx: master process ./nginx www 58005 50131 0 08:54 ? 00:00:00 nginx: worker process www 58006 50131 0 08:54 ? 00:00:00 nginx: worker process root@master:/webserver/nginx18/sbin# cp nginx /usr/local/bin/nginx root@master:/webserver/nginx18/sbin# nginx -t root@master:/webserver/nginx18/sbin# nginx -s reload   ç„¶åæˆ‘ä»¬é…ç½®ä¸€ä¸ªweb.devopsman.cnçš„åŸŸååˆ°192.168.99.128ä¸Šï¼Œçœ‹ä¸€ä¸‹æœåŠ¡è¿è¡Œå’ŒDNSè§£æåçš„æ•ˆæœ:\n1 2 3 4 5 6 7 8 9 10  root@master:~/workspace/packages/nginx/nginx-1.18.0/contrib# curl -I web.devopsman.cn HTTP/1.1 200 OK Server: nginx/1.18.0 Date: Sat, 11 Jul 2020 13:03:29 GMT Content-Type: text/html Content-Length: 612 Last-Modified: Sat, 11 Jul 2020 12:38:29 GMT Connection: keep-alive ETag: \u0026#34;5f09b2c5-264\u0026#34; Accept-Ranges: bytes   é«˜äº®Nginxçš„é…ç½® nginxçš„æºç åŒ…é‡Œé¢æœ‰é…ç½®vimç¼–è¾‘çš„nginxé…ç½®æ–‡ä»¶æ—¶å†…å®¹æ ¼å¼é«˜äº®æ˜¾ç¤ºçš„é…ç½®æ–‡ä»¶ï¼Œç›´æ¥å°†å…¶æ‹·è´åˆ°.vimç›®å½•ä¸‹å³å¯\n1 2 3 4 5 6 7 8 9 10  root@master:~# cd /root/workspace/packages/nginx/nginx-1.18.0/contrib/ root@master:~/workspace/packages/nginx/nginx-1.18.0/contrib# ls -al total 24 drwxr-xr-x 4 www www 4096 Jul 11 08:02 . drwxr-xr-x 9 www www 4096 Jul 11 08:21 .. -rw-r--r-- 1 www www 1272 Apr 21 10:09 geo2nginx.pl -rw-r--r-- 1 www www 543 Apr 21 10:09 README drwxr-xr-x 2 www www 4096 Jul 11 08:02 unicode2nginx drwxr-xr-x 6 www www 4096 Apr 21 10:09 vim root@master:~/workspace/packages/nginx/nginx-1.18.0/contrib# cp -r vim/* ~/.vim/   æ‹·è´è¿›å»ä¹‹åï¼Œæˆ‘ä»¬å‘ç°ç¼–è¾‘nginxçš„é…ç½®æ–‡ä»¶å˜å¾—é«˜äº®äº†\n","description":"","id":56,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/nginx%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E4%B8%93%E8%BE%91/02-nginx1.18.0%E7%BC%96%E8%AF%91%E5%AE%89%E8%A3%85/"},{"content":"ç¼–è¯‘å®‰è£… NGINX1.10 ç›¸å…³ä¾èµ–åŒ…çš„ä¸‹è½½é“¾æ¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16  cd /usr/local/src wget http://nginx.org/download/nginx-1.14.2.tar.gz wget http://nginx.org/download/nginx-1.10.3.tar.gz wget https://www.zlib.net/fossils/zlib-1.2.8.tar.gz wget https://openssl.org/source/openssl-1.0.2d.tar.gz wget https://github.com/simplresty/ngx_devel_kit/archive/v0.3.0.tar.gz -O ngx_devel_kit.tar.gz wget https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2 wget https://github.com/yaoweibin/nginx_upstream_check_module/archive/v0.3.0.tar.gz -O nginx_upstream_check_module.tar.gz wget https://github.com/openresty/lua-nginx-module/archive/v0.10.10.tar.gz -O lua-nginx-module.tar.gz tar xf jemalloc-4.5.0.tar.bz2 cd jemalloc-4.5.0 \u0026amp;\u0026amp; ./configure \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install apt-get install -y lua5.1-0-dev # apt-get install -y libjemalloc-dev å¦‚æœä¸Šé¢æ²¡æœ‰è´¬ä¹‰å®‰è£…jemalloc,å¯ä»¥ä½¿ç”¨aptè¿›è¡Œå®‰è£… groupadd www useradd www   ç¼–è¯‘å®‰è£… Nginx ç¼–è¯‘å®‰è£… 1.10.3 1 2  tar xf nginx-1.10.3.tar.gz \u0026amp;\u0026amp; cd nginx-1.10.3 ./configure --prefix=/webserver/nginx --user=www --group=www --with-pcre --with-zlib=/usr/local/src/zlib-1.2.8 --with-openssl=/usr/local/src/openssl-1.0.2d --with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --add-module=/usr/local/src/ngx_devel_kit --add-module=/usr/local/src/lua-nginx-module --with-ld-opt=-ljemalloc --with-stream --with-http_ssl_module --add-module=/usr/local/src/nginx_upstream_check_module \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install   ç¼–è¯‘å®‰è£… 1.14.2 1 2  tar xf nginx-1.14.2.tar.gz \u0026amp;\u0026amp; cd nginx-1.14.2 ./configure --prefix=/webserver/nginx14 --user=www --group=www --with-pcre --with-zlib=/usr/local/src/zlib-1.2.8 --with-openssl=/usr/local/src/openssl-1.0.2d --with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --add-module=/usr/local/src/ngx_devel_kit --add-module=/usr/local/src/lua-nginx-module --with-ld-opt=-ljemalloc --with-stream --with-http_ssl_module --add-module=/usr/local/src/nginx_upstream_check_module \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install   nginx çƒ­å‡çº§  é¦–å…ˆå¯åŠ¨ nginx1.10.3  1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30  \u0026gt; root@cluster-node1:/webserver/nginx/sbin# ls nginx \u0026gt; root@cluster-node1:/webserver/nginx/sbin# pwd /webserver/nginx/sbin \u0026gt; root@cluster-node1:/webserver/nginx/sbin# ./nginx \u0026gt; root@cluster-node1:/webserver/nginx/sbin# ps -ef |grep nginx root 44682 1 0 11:27 ? 00:00:00 nginx: master process ./nginx www 44683 44682 0 11:27 ? 00:00:00 nginx: worker process root 44685 6939 0 11:27 pts/1 00:00:00 grep --color=auto nginx \u0026gt; root@cluster-node1:/webserver/nginx/sbin# netstat -tunlp |grep nginx tcp 0 0 0.0.0.0:80 0.0.0.0:* LISTEN 44682/nginx \u0026gt; root@cluster-node1:/webserver/nginx/sbin# ./nginx -v nginx version: nginx/1.10.3 \u0026gt; root@cluster-node1:/webserver/nginx/sbin# ./nginx -V nginx version: nginx/1.10.3 built by gcc 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.11) built with OpenSSL 1.0.2d 9 Jul 2015 TLS SNI support enabled configure arguments: --prefix=/webserver/nginx --user=www --group=www --with-pcre --with-zlib=/usr/local/src/zlib-1.2.8 --with-openssl=/usr/local/src/openssl-1.0.2d --with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --add-module=/usr/local/src/ngx_devel_kit --add-module=/usr/local/src/lua-nginx-module --with-ld-opt=-ljemalloc --with-stream --with-http_ssl_module --add-module=/usr/local/src/nginx_upstream_check_module \u0026gt; root@cluster-node1:/webserver/nginx/sbin# curl -I http://localhost HTTP/1.1 200 OK Server: nginx/1.10.3 Date: Thu, 01 Aug 2019 15:29:08 GMT Content-Type: text/html Content-Length: 612 Last-Modified: Thu, 01 Aug 2019 15:12:52 GMT Connection: keep-alive ETag: \u0026#34;5d430174-264\u0026#34; Accept-Ranges: bytes   å¤‡ä»½ nginx1.10.3 çš„äºŒè¿›åˆ¶æ–‡ä»¶\n1 2 3 4 5  root@cluster-node1:/webserver/nginx/sbin# cp ./nginx ./nginx_1.10.3 root@cluster-node1:/webserver/nginx/sbin# ls -l total 24840 -rwxr-xr-x 1 root root 12715840 Aug 1 11:12 nginx -rwxr-xr-x 1 root root 12715840 Aug 1 11:30 nginx_1.10.3   å¤åˆ¶ nginx 1.14.2 ç‰ˆæœ¬çš„ nginx äºŒè¿›åˆ¶æ–‡ä»¶åˆ°å½“å‰çš„ç›®å½•ä¸‹è¦†ç›– nginx1.10.3 çš„äºŒè¿›åˆ¶æ–‡ä»¶\n1 2 3 4 5  root@cluster-node1:/webserver/nginx/sbin# cp -f /webserver/nginx14/sbin/nginx ./ root@cluster-node1:/webserver/nginx/sbin# ls -l total 25680 -rwxr-xr-x 1 root root 13574704 Aug 1 11:31 nginx -rwxr-xr-x 1 root root 12715840 Aug 1 11:30 nginx_1.10.3   å‘é€çƒ­æ›´æ–°ä¿¡å·\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22  root@cluster-node1:/webserver/nginx/sbin# ps -ef | grep nginx root 44682 1 0 11:27 ? 00:00:00 nginx: master process ./nginx www 44683 44682 0 11:27 ? 00:00:00 nginx: worker process root 44709 6939 0 11:33 pts/1 00:00:00 grep --color=auto nginx root@cluster-node1:/webserver/nginx/sbin# kill -USR2 44682 # å‘é€ä¸€ä¸ªå¹³æ»‘å‡çº§çš„ä¿¡å·ç»™nginx master root@cluster-node1:/webserver/nginx/sbin# ps -ef | grep nginx root 44682 1 0 11:27 ? 00:00:00 nginx: master process ./nginx # nginx.old www 44683 44682 0 11:27 ? 00:00:00 nginx: worker process root 44710 44682 0 11:34 ? 00:00:00 nginx: master process ./nginx # nginx.new www 44711 44710 0 11:34 ? 00:00:00 nginx: worker process root 44713 6939 0 11:34 pts/1 00:00:00 grep --color=auto nginx root@cluster-node1:/webserver/nginx/sbin# curl -I http://localhost # æ­¤æ—¶è¯·æ±‚éƒ½æ‰“åˆ°nginx.newä¸Šäº†,nginx.oldä¹Ÿä¸ä¼šåœ¨ç›‘å¬80/443æ–­å£äº† HTTP/1.1 200 OK Server: nginx/1.14.2 Date: Thu, 01 Aug 2019 15:34:41 GMT Content-Type: text/html Content-Length: 612 Last-Modified: Thu, 01 Aug 2019 15:25:32 GMT Connection: keep-alive ETag: \u0026#34;5d43046c-264\u0026#34; Accept-Ranges: bytes   ä¸‹çº¿æ—§ç‰ˆæœ¬çš„ nginx çš„ work è¿›ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15  root@cluster-node1:/webserver/nginx/sbin# kill -WINCH 44682 root@cluster-node1:/webserver/nginx/sbin# ps -ef | grep nginx root 44682 1 0 11:27 ? 00:00:00 nginx: master process ./nginx # nginx.oldçš„å¤„ç†æµé‡è¯·æ±‚çš„workè¿›è¡Œå…¨è¢«ä¸‹æ‰äº†ï¼Œä¿ç•™çš„nginx.oldçš„masterè¿›ç¨‹ç”¨äºç‰ˆæœ¬å›é€€,å¦‚æœè¦åˆ‡å›å°±çš„ç‰ˆæœ¬ï¼Œåªéœ€ä½¿ç”¨æ—§çš„nginxäºŒè¿›åˆ¶æ–‡ä»¶æ‰§è¡Œnginx -s reloadå³å¯. root 44710 44682 0 11:34 ? 00:00:00 nginx: master process ./nginx www 44711 44710 0 11:34 ? 00:00:00 nginx: worker process root 44757 6939 0 11:36 pts/1 00:00:00 grep --color=auto nginx root@cluster-node1:/webserver/nginx/sbin# ./nginx -v nginx version: nginx/1.14.2 root@cluster-node1:/webserver/nginx/sbin# ./nginx -V nginx version: nginx/1.14.2 built by gcc 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.11) built with OpenSSL 1.0.2d 9 Jul 2015 TLS SNI support enabled configure arguments: --prefix=/webserver/nginx14 --user=www --group=www --with-pcre --with-zlib=/usr/local/src/zlib-1.2.8 --with-openssl=/usr/local/src/openssl-1.0.2d --with-http_gzip_static_module --with-http_realip_module --with-http_stub_status_module --add-module=/usr/local/src/ngx_devel_kit --add-module=/usr/local/src/lua-nginx-module --with-ld-opt=-ljemalloc --with-stream --with-http_ssl_module --add-module=/usr/local/src/nginx_upstream_check_module   åœ¨é€€å‡º nginx çš„æ—¶å€™ï¼Œnginx æ—§ç‰ˆæœ¬çš„è¿›ç¨‹ä¾æ—§å­˜åœ¨ï¼Œä½†æ˜¯ä¼šåœ¨å ç”¨ 80 ç«¯å£ï¼Œé€ æˆä»æ–°å¯åŠ¨ nginx å¤±è´¥ï¼Œå› æ­¤éœ€è¦å…ˆæ€æ‰ 80 ç«¯å£çš„æ—§ç‰ˆæœ¬çš„è¿›ç¨‹\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32  root@cluster-node1:/webserver/nginx/sbin# ./nginx -s quit root@cluster-node1:/webserver/nginx/sbin# ps -ef |grep nginx root 44682 1 0 11:27 ? 00:00:00 nginx: master process ./nginx www 44783 44682 0 11:38 ? 00:00:00 nginx: worker process root 44785 6939 0 11:38 pts/1 00:00:00 grep --color=auto nginx root@cluster-node1:/webserver/nginx/sbin# ./nginx -v nginx version: nginx/1.14.2 root@cluster-node1:/webserver/nginx/sbin# ps -ef |grep nginx root 44682 1 0 11:27 ? 00:00:00 nginx: master process ./nginx www 44783 44682 0 11:38 ? 00:00:00 nginx: worker process root 44788 6939 0 11:38 pts/1 00:00:00 grep --color=auto nginx root@cluster-node1:/webserver/nginx/sbin# ./nginx -s reload nginx: [error] open() \u0026#34;/webserver/nginx14/logs/nginx.pid\u0026#34; failed (2: No such file or directory) root@cluster-node1:/webserver/nginx/sbin# ./nginx nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use) nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use) nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use) nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use) nginx: [emerg] bind() to 0.0.0.0:80 failed (98: Address already in use) nginx: [emerg] still could not bind() root@cluster-node1:/webserver/nginx/sbin# ./nginx -s stop nginx: [error] open() \u0026#34;/webserver/nginx14/logs/nginx.pid\u0026#34; failed (2: No such file or directory) root@cluster-node1:/webserver/nginx/sbin# ls -l /webserver/nginx14/logs/nginx.pid ls: cannot access \u0026#39;/webserver/nginx14/logs/nginx.pid\u0026#39;: No such file or directory root@cluster-node1:/webserver/nginx/sbin# pkill nginx root@cluster-node1:/webserver/nginx/sbin# ./nginx root@cluster-node1:/webserver/nginx/sbin# ps -ef |grep nginx root 44800 1 0 11:39 ? 00:00:00 nginx: master process ./nginx www 44801 44800 0 11:39 ? 00:00:00 nginx: worker process root 44803 6939 0 11:40 pts/1 00:00:00 grep --color=auto nginx root@cluster-node1:/webserver/nginx/sbin# ./nginx -v nginx version: nginx/1.14.2   nginxæ—¥å¿—åˆ‡å‰² 1 2  kill -USR1 $NGINX_PID # æˆ–è€…ä½¿ç”¨nginxçš„reopené€‰é¡¹ nginx -s reopen   ","description":"","id":57,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/nginx%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E4%B8%93%E8%BE%91/03-nginx%E7%9A%84%E7%83%AD%E5%8D%87%E7%BA%A7%E4%B8%8E%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2/"},{"content":"ç¼“å­˜æœåŠ¡å™¨åœºæ™¯ é…ç½®ä¸€ä¸ªç¼“å­˜æœåŠ¡å™¨ï¼Œå¸¦æ¥çš„ä¼˜ç¼ºç‚¹ï¼Œå¯ä»¥æ ¹æ®ä¸åŒçš„åœºæ™¯é€‚å½“é€‰æ‹©ï¼š\n å½“ä¸Šæ¸¸upstreamç«¯çš„æœåŠ¡å™¨çš„å“åº”å†…å®¹å‘ç”Ÿäº†å˜åŒ–çš„æ—¶å€™ï¼Œç¼“å­˜æœåŠ¡å™¨å“åº”çš„å†…å®¹åœ¨å¤±æ•ˆæ—¶é—´ä¹‹å‰æ˜¯ä¸ä¼šå˜åŒ–çš„ï¼Œå› æ­¤è¦ç¡®è®¤æ˜¯å¦é€‚ç”¨å½“å‰çš„åœºæ™¯ é…ç½®ç¼“å­˜ä»£ç†æœåŠ¡å™¨ï¼Œå¯ä»¥æé«˜ç½‘ç«™çš„è®¿é—®æ€§èƒ½  é…ç½®å®è·µ åœ¨httpæ®µé…ç½®ç¼“å­˜çš„ç›¸å…³å‚æ•°ï¼Œå¦‚ç¼“å­˜çš„å­˜å‚¨ä½ç½®ã€ç¼“å­˜çº§åˆ«ã€ç¼“å­˜ç©ºé—´ã€ç¼“å­˜å­˜å‚¨æœ€å¤§å¤šå°‘ï¼Œç¼“å­˜æœ‰æ•ˆæ—¶å¸¸\n1 2  # http proxy_cache_path /tmp/nginxcache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=60m use_temp_path=off;   é…ç½®ç¼“å­˜æœåŠ¡å™¨\nupstream local { server 127.0.0.1:8089; } server { server_name proxy.devopsman.cn; listen 80; location / { proxy_set_header Host $host; proxy_set_header X-Real_IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;; proxy_cache my_cache; proxy_cache_key $host$uri$is_args$args; proxy_cache_valid 200 304 302 1d; proxy_pass http://local; } } ","description":"","id":58,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/nginx%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E4%B8%93%E8%BE%91/05-nginx%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E7%BC%93%E5%AD%98%E6%9C%8D%E5%8A%A1%E5%99%A8/"},{"content":"nginxé—®é¢˜è®°å½•   ./configure: error: ngx_http_lua_module requires the Lua library.\n1 2 3 4 5  checking for Lua library in /usr/ ... not found checking for LuaJIT library in /usr/local/ ... not found checking for LuaJIT library in /usr/ ... not found checking for LuaJIT library in /usr/ ... not found ./configure: error: ngx_http_lua_module requires the Lua library.   è§£å†³æ–¹æ¡ˆ:\n1  apt-get install lua5.1-0-dev     --with-ld-opt=\u0026quot;-ljemalloc\u0026quot; ... not found\n1 2 3 4 5 6 7 8  checking for OS + Linux 4.4.0-142-generic x86_64 checking for C compiler ... found + using GNU C compiler + gcc version: 5.4.0 20160609 (Ubuntu 5.4.0-6ubuntu1~16.04.11) checking for gcc -pipe switch ... found checking for --with-ld-opt=\u0026#34;-ljemalloc\u0026#34; ... not found ./configure: error: the invalid value in --with-ld-opt=\u0026#34;-ljemalloc\u0026#34;   è§£å†³åŠæ³•:\n1 2 3  wget https://github.com/jemalloc/jemalloc/releases/download/4.5.0/jemalloc-4.5.0.tar.bz2 tar xf jemalloc-4.5.0.tar.bz2 cd jemalloc-4.5.0 \u0026amp;\u0026amp; ./configure \u0026amp;\u0026amp; make \u0026amp;\u0026amp; make install     ","description":"","id":59,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/nginx%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%E4%B8%93%E8%BE%91/100-nginx%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/"},{"content":"ä»è‹¦é€¼åˆ°ç‰›é€¼ï¼Œè¯¦è§£DevOpså·¥ç¨‹å¸ˆçš„æ‰“æ€ªå‡çº§ä¹‹è·¯ ä»è¿›å…¥èŒåœºåšè¿ç»´åˆ°å†™ç‚¹ä»£ç ï¼Œæ…¢æ…¢çš„å¿«å››å¹´äº†ï¼Œå°±åƒç©æ¶ˆæ¶ˆä¹ä¸€æ ·ï¼Œä¸€å…³åˆä¸€å…³çš„èµ°äº†è¿‡æ¥(ä½ çŒœçŒœæˆ‘çš„æ¶ˆæ¶ˆä¹å¤šå°‘å…³äº†ï¼Ÿå“ˆå“ˆ)ï¼Œåœ¨è¿‡äº”å…³æ–©å…­å°†(ä¸æ–­çš„èƒŒé”…æ•‘ç«)ä¹‹åï¼Œæ„Ÿè§‰è‡ªå·±çš„çŸ¥è¯†ä½“ç³»å’Œè¿ç»´ä½“ç³»å˜åŒ–çš„æŒºå¤§çš„ï¼Œå­¦åˆ°äº†å¾ˆå¤šçš„æ–°çŸ¥è¯†ä»Šå¤©å’Œå¤§å®¶åˆ†äº«åˆ†äº«ã€‚\n","description":"","id":60,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/%E4%BB%8E%E8%8B%A6%E9%80%BC%E5%88%B0%E7%89%9B%E9%80%BC%E8%AF%A6%E8%A7%A3devops%E5%B7%A5%E7%A8%8B%E5%B8%88%E7%9A%84%E6%89%93%E6%80%AA%E5%8D%87%E7%BA%A7%E4%B9%8B%E8%B7%AF/"},{"content":"å¾®ä¿¡å…¬ä¼—å·æ–‡ç« é“¾æ¥ è¿ç»´æ¶æ„ä¸“è¾‘  2020-06-20 OpenVPNé«˜çº§è¿›é˜¶: 5ä¸ªä½¿ç”¨åœºæ™¯å’Œé—®é¢˜é›† 2020-06-20 OpenVPNæœ€éš¾å¿˜çš„ä¸€æ¬¡â€ç¾åé‡å»ºâ€œ Prometheusç›‘æ§ç³»åˆ—-éƒ¨ç½²ç¯‡  Pythonä¸“è¾‘  2020-02-25 å½“è¿ç»´é‡ä¸Šäº†\u0026hellip;  Kubernetes  2002-03-22 å†™ç»™å­©å­çœ‹çš„KubernetesåŠ¨ç”»æŒ‡å—  2020-03-07 kubernetesçš„ingressæ§åˆ¶å™¨æ¯”è¾ƒ(traefik2.0.5å®‰è£…æŒ‡å—) 2020-03-04 kubernetesæ·±åº¦æ¢ç©¶Nodeå’ŒPodçš„äº²å’Œæ€§å’Œåäº²å’Œæ€§ 2020-02-26 kuberneteså®‰è£…æ–¹æ¡ˆå¤§å…¨ 2019-12-18 kubernetesæœ€å¸¸ç”¨çš„èµ„æºå¯¹è±¡Deployment 2020-06-12 kubernetesç‚¼æ°”æœŸä¹‹æŒæ¡kuebernetesèƒŒæ™¯ 2020-06-12 kubernetesç‚¼æ°”æœŸä¹‹k8så¹³å°å¿«é€Ÿæ­å»º   DevOpsæŠ€æœ¯æ ˆ  2020-03-05 DevOpså…¨å¼€æºç«¯åˆ°ç«¯éƒ¨ç½²æµæ°´çº¿è§†é¢‘   Travis  2020-06-05 GitHub+Travis+Mkdocsè‡ªåŠ¨åŒ–æ„å»ºæ–‡æ¡£åº“  Jenkins  2020-03-21 Jenkinsæµæ°´çº¿åŠ¨ç”» 2020-06-08 è‡ªå®šä¹‰Build Historyä¸­æ˜¾ç¤ºæ„å»ºä¿¡æ¯ 2020-03-01 è‡ªå®šä¹‰æ„å»ºJenkinsé•œåƒå®æˆ˜ 2020-06-08 Jenkinsåœ¨kubernetesä¸Šçš„åˆä½“éªŒ 2020-06-08 JenkinsåŠ¨æ€Slaveåœ¨k8sä¸Šçš„å®è·µ  Ansible  2020-02-16 Ansibleä¹¦ç±åˆ†äº«(ansible for devops/ansible for kubernetes)   GitLab  2020-02-16 Gitlab Runnerç³»åˆ—-ç¯å¢ƒéƒ¨ç½²ç¯‡ 2020-02-16 Gitlab Runnerç³»åˆ—-æŒç»­é›†æˆç¯‡ 2020-02-16 Gitlab Runnerç³»åˆ—-æŒç»­éƒ¨ç½²ç¯‡ 2020-06-06 ç”¨GitLAB CICD pipeline templateæŒç»­é›†æˆ   Prometheus  2020-03-20 Prometheusç›‘æ§ç³»åˆ—-éƒ¨ç½²ç¯‡ 2020-03-20 Prometheusç›‘æ§ç³»åˆ—-ç›‘æ§ç¯‡(consul) 2020-03-20 Awesome Alertmanager Rule  Develop Go Python  2020-02-21 PythonåŸæ¥å¦‚æ­¤ç¾ä¸½ä¹‹Requeat \u0026amp; Parsel  linux  2020-02-28 ä¼ä¸šçº§è§„èŒƒéƒ¨ç½²ä¸­å¤®è®¤è¯è½¯ä»¶Openldap 2020-02-24 åŸŸåæœ‰æ•ˆæœŸç›‘æ§ 2020-03-14 Awkæƒå¨æŒ‡å—ä¹‹ç»ˆç»“ç¯‡ 2020-03-11 Awkæƒå¨æŒ‡å— 2020-06-13 æ‰“é€ Macä¸‹é«˜é¢œå€¼å¥½ç”¨çš„ç»ˆç«¯ç¯å¢ƒ  NoSQL Mongodb Elasticsearch  2020-03-28 Elasticsearch-5.2.2é›†ç¾¤å‡çº§ ==å¾…å‡†å¤‡==  middleware Message Queue RabbitMQ  2020-04-10 RabbitMQ-3.6.6é›†ç¾¤å‡çº§ ==å¾…å‡†å¤‡==  Kafka  2020-04-20 Kafka-2.11-0.10.1.1é›†ç¾¤å‡çº§ ==å¾…å‡†å¤‡==  Redis  2020-03-30 Redis-3.2.8é›†ç¾¤å‡çº§ ==å¾…å‡†å¤‡==  Service Discovery Consul Zookeeper  2020-04-30 zookeeper-3.4.10é›†ç¾¤å‡çº§ ==å¾…å‡†å¤‡==  Etcd Database MySQL Container Runtime Docker  2020-03-15 Dockeré•œåƒåˆ†æå·¥å…·ä¹‹Diveä»‹ç» 2020-03-15 Dockeré•œåƒåˆ†æå·¥å…·ä¹‹Diveè§†é¢‘æŒ‡å—   2020-06-15 Lazydocker:ä¸“ä¸º\u0026quot;æ‡’äºº\u0026quot;è®¾è®¡å‘½ä»¤è¡Œå¯è§†åŒ–å·¥å…·  tools  2020-03-13 IDEä½ è¦çš„æ°¸è¿œæ¿€æ´»åœ¨è¿™é‡Œ  ","description":"","id":61,"section":"posts","tags":null,"title":"","uri":"https://linuxermaster.github.io/en/posts/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5/"}]